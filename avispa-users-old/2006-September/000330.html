<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Avispa-users] cl-atse ends and ofmc not
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:avispa-users%40avispa-project.org?Subject=%5BAvispa-users%5D%20cl-atse%20ends%20and%20ofmc%20not&In-Reply-To=450BD3AC.1010909%40dist.unige.it">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000328.html">
   <LINK REL="Next"  HREF="000331.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avispa-users] cl-atse ends and ofmc not</H1>
    <B>Juan Carlos L&#243;pez Pimentel</B> 
    <A HREF="mailto:avispa-users%40avispa-project.org?Subject=%5BAvispa-users%5D%20cl-atse%20ends%20and%20ofmc%20not&In-Reply-To=450BD3AC.1010909%40dist.unige.it"
       TITLE="[Avispa-users] cl-atse ends and ofmc not">A00472021 at itesm.mx
       </A><BR>
    <I>Fri Sep 22 04:08:29 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000328.html">[Avispa-users] cl-atse ends and ofmc not
</A></li>
        <LI>Next message: <A HREF="000331.html">[Avispa-users] cl-atse ends and ofmc not
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#330">[ date ]</a>
              <a href="thread.html#330">[ thread ]</a>
              <a href="subject.html#330">[ subject ]</a>
              <a href="author.html#330">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Luca,

Luca Compagna wrote:

&gt;<i> Dear Juan Carlos,
</I>&gt;<i> one of the reason why OFMC might require some time can lay in the 
</I>&gt;<i> complementarity of the AVISPA back-ends. Your HLPSL problem considers 
</I>&gt;<i> 4 parallel sessions of the protocol and in my experience while SATMC 
</I>&gt;<i> is much more insensitive to the number of concurrent sessions 
</I>&gt;<i> analysed, OFMC and CL-ATSE are quite insensitive to the size of 
</I>&gt;<i> messages.  I would suggest you to give a try with SATMC as well. 
</I>&gt;<i> Actually the fact that CL-ATSE is able to solve the problem is a 
</I>&gt;<i> really a good thing.
</I>&gt;<i>
</I>I have also used SATMC and the result is the same with CL-ATSE. Now I'm 
dealing with a new problem. The protocol attachment is an extended 
version of wide mouth frog protocol. When I'm verifying it with SATMC 
and OFMC both backends take out that the protocol is secure (free of 
attacks). However, CL-ATSE takes out that the protocol is faulty (the 
attack is shown below). I have analyzed the counterexample and I think 
that the counterexample has an error or there is a something that I'm 
not understanding because it is unexplicable how the intruder can 
generate message {{n5(Na)}_succ}_n11(Kab) of line 13.  

1   i -&gt; (a,7):  start
2  (a,7) -&gt; i:  a.{a.b.n11(Ta).n11(Kab)}_ka
3  i -&gt; (s,9):  a.{a.b.n11(Ta).n11(Kab)}_ka
4   (s,9) -&gt; i:  {a.{n11(Ta)}_ts.n11(Kab)}_kb
5   i -&gt; (a,3):  start
6   (a,3) -&gt; i:  a.{a.b.n1(Ta).n1(Kab)}_ka
7  i -&gt; (b,8):  {a.{n11(Ta)}_ts.n11(Kab)}_kb
8   (b,8) -&gt; i:  {n15(Na)}_n11(Kab)
9   i -&gt; (a,7):  {n15(Na)}_n11(Kab)
10  (a,7) -&gt; i:  {{n15(Na)}_succ}_n11(Kab)
11  i -&gt; (b,4):  {a.{n11(Ta)}_ts.n11(Kab)}_kb
12  (b,4) -&gt; i:  {n5(Na)}_n11(Kab)
13   i -&gt; (b,4):  {{n5(Na)}_succ}_n11(Kab)
14  (b,4) -&gt; i:  ()
15 i -&gt; (b,8):  {{n15(Na)}_succ}_n11(Kab)
16  (b,8) -&gt; i:  ()

Please, I would like to know if CL-ATSE is OK, then how the intruder can 
generate line 13 and why OFMC and SATMC do not detect such an attack.


&gt;<i> However your question on CL-ATSE vs OFMC still remains :D
</I>
OK.... THANKS

Thanks for your trouble.

Best regards,

Juan Carlos

&gt;<i> Juan Carlos L&#243;pez Pimentel wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hello List,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I was verifying a version of the Andrew Secure RPC protocol (an extended
</I>&gt;&gt;<i> version). However,  I am not sure if my new version is secure, because
</I>&gt;&gt;<i> while cl-atse backend takes out that the protocol is secure, ofmc
</I>&gt;&gt;<i> backend does not end (it seems to be in a cycle).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I would like to know, why while cl-atse backend clearly takes out a
</I>&gt;&gt;<i> result, ofmc does not do the same?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Attachment you can find the security protocol.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks you for your trouble.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Best regards,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Juan Carlos L&#243;pez P.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ----
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ------------------------------------------------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Avispa-users mailing list
</I>&gt;&gt;<i> <A HREF="http://www.avispa-project.org/mailman/listinfo/avispa-users">Avispa-users at avispa-project.org</A>
</I>&gt;&gt;<i> <A HREF="http://www.avispa-project.org/mailman/listinfo/avispa-users">http://www.avispa-project.org/mailman/listinfo/avispa-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>
-------------- next part --------------
%% HLPSL definition on WMF protocol
%% This is a version patched and extended 
%% By Juan Carlos Lopez Pimentel

%%1 A --&gt; S : A, {B, Ta, Kab}_|KA|
%%2 S --&gt; B : {A, Ts, Kab}_|KB|
%%extension
%%3 B --&gt; A : {Na}_Kab
%%4 A --&gt; B : {Succ(Na)}_Kab




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 	
%%1 A --&gt; S : A, {B, Ta, Kab}_|KA|
%%3 B --&gt; A : {Na}_Kab
%%4 A --&gt; B : {Succ(Na)}_Kab

role alice(A,B,S:agent,
	   KA: symmetric_key,
	   Succ: hash_func,
	   Snd, Rcv: channel (dy))
played_by A
def=

  local State: nat,
	Ta, Na: text, 
	Kab: symmetric_key


%  const na, alice_bob_kab,secret_kab: protocol_id
  const kab, alice_bob_kab, bob_alice_kab: protocol_id

  init  State := 0

  transition

%% Start of the protocol
  step1. 	State = 0  /\ Rcv(start)  =|&gt;	
		State':= 2 /\ Ta':= new() /\ Kab':= new() 
			/\ Snd(A.{A.B.Ta'.Kab'}_KA)
	                /\ secret(Kab',kab,{A,B,S})
			/\ witness(A,B,alice_bob_kab,Kab')

%%3 B --&gt; A : {Na}_Kab
  step3and4.    State = 2 /\ Rcv({Na'}_Kab) =|&gt;
%%4 A --&gt; B : {Succ(Na)}_Kab
 		State':= 4 /\ Snd({Succ(Na')}_Kab)
%		/\ request(A,B,bob_alice_kab,Kab)
						
end role

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 	


%%2 S --&gt; B : {A, Ts, Kab}_|KB|
%%3 B --&gt; A : {Na}_Kab
%%4 A --&gt; B : {Succ(Na)}_Kab

role   bob(A,B,S:agent,
	   KB: symmetric_key,
	   Succ: hash_func,
	   Snd,Rcv: channel (dy))
played_by B
def=

  local State: nat,
	Na:text,
	Ts: message, 
	Kab: symmetric_key

  const bob_alice_kab: protocol_id

  init  State := 0

  transition

%%2 S --&gt; B : {A, Ts, Kab}_|KB|
  step2and3. 	State = 0  /\ Rcv({A.Ts'.Kab'}_KB) =|&gt;
%%3 B --&gt; A : {Na}_Kab
		State' := 1 /\ Na':=new() /\ Snd({Na'}_Kab')
%		/\ witness(B,A,bob_alice_kab,Kab')
		
		
%%4 A --&gt; B : {Succ(Na)}_Kab
  step4.    State = 1 /\ Rcv({Succ(Na)}_Kab) =|&gt;
	    State':= 3 /\
	    request(B,A,alice_bob_kab,Kab)

		
		
end role

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 	

%%1 A --&gt; S : A, {B, Ta, Kab}_|KA|
%%2 S --&gt; B : {A, Ts, Kab}_|KB|

role server(A, B, S:agent,
	    KA, KB: symmetric_key,
  	    Timestamp : hash_func,
	    Snd, Rcv: channel (dy))
played_by S
def=

  local State: nat,
	Ta: text, 
	Kab: symmetric_key

  init  State := 0

  transition
  step0. 	State = 0 /\ Rcv(A.{A.B.Ta'.Kab'}_KA) =|&gt;	
		State' := 1 /\ Snd({A.Timestamp(Ta').Kab'}_KB)	


end role

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 	

%%1 A --&gt; S : A, {B, Ta, Kab}_|KA|
%%2 S --&gt; B : {A, Ts, Kab}_|KB|


%% The role representing a partial session between alice and bob
role  wmf(A,B,S: agent,
	  KA, KB: symmetric_key,
	  TS,Succ:hash_func )
		
def=

  local S_AS, R_AS, S_BS, R_BS, R_AB, S_AB: channel (dy)

  composition
	    alice (A,B,S,KA,Succ,S_AS,R_AB) 
	/\  bob   (A,B,S,KB,Succ,S_AB,R_BS)
	/\  server(A,B,S,KA,KB,TS,S_BS,R_AS)

end role

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 	

%% The main role
role environment()
def=
 
  const a, b, s, i : agent,
        ka, kb, ki : symmetric_key,
	ts, succ: hash_func


  intruder_knowledge = {ki, inv(ki), a, b, i,s,ts,succ}

  composition
     	   wmf(a,b,s,ka,kb,ts,succ)
     	/\ wmf(a,b,s,ka,kb,ts,succ)
%     	/\ wmf(b,a,s,kb,ka,ts,succ)
%	/\ wmf(a,i,s,ka,ki,ts,succ)
%     	/\ wmf(i,b,s,ki,kb,ts,succ)

end role

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 	

%% Properties to verify
goal

%  	secrecy_of na
%	secrecy_of secret_kab

  	authentication_on alice_bob_kab
%  	authentication_on bob_alice_kab
  

end goal

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 	

%% Call of the main role
environment()

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000328.html">[Avispa-users] cl-atse ends and ofmc not
</A></li>
	<LI>Next message: <A HREF="000331.html">[Avispa-users] cl-atse ends and ofmc not
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#330">[ date ]</a>
              <a href="thread.html#330">[ thread ]</a>
              <a href="subject.html#330">[ subject ]</a>
              <a href="author.html#330">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.avispa-project.org/mailman/listinfo/avispa-users">More information about the Avispa-users
mailing list</a><br>
</body></html>
