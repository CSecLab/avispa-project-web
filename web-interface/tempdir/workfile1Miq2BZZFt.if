%% IF specification of /home/avispa/web-interface-computation/./tempdir/workfile1Miq2BZZFt

section signature:

state_bob: agent * agent * agent * symmetric_key * symmetric_key * hash_func * hash_func * hash_func * hash_func * public_key * public_key * public_key * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * set(text) * set(agent) * nat -> fact
state_alice: agent * agent * agent * symmetric_key * symmetric_key * hash_func * hash_func * hash_func * hash_func * public_key * public_key * public_key * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * set(text) * set(agent) * nat -> fact
state_kgc: agent * agent * agent * symmetric_key * symmetric_key * hash_func * hash_func * hash_func * hash_func * public_key * public_key * public_key * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * set(text) * set(agent) * set(text) * set(agent) * nat -> fact


section types:

MGoal, start: message
alice_xa, bob_xbsk, alice_va, bob_vb, kgc_msk, subs1, subs2, subs3, subs4: protocol_id
Set_147, Set_104, Set_58, Set_55, Dummy_Set_147, Dummy_Set_104, Dummy_Set_58, Dummy_Set_55: set(text)
puba, mpk, pubb, Puba, Mpk, Pubb, Dummy_Mpk: public_key
add, sub, mul, h, Add, Sub, Mul, H: hash_func
g, ida, idb, da, db, xa, pa, xb, pb, r, k1, k2, ts, k3, c, w, s, d, m, d1, y, G, Msk, IDa, IDb, Da, Db, Xa, Pa, Va, Xb, Pb, Vb, R, K1, K2, Ts, K3, C, W, S, D, M, D1, Y, F, Dummy_D1, Dummy_Vb, Dummy_Pb, Dummy_Xb, Dummy_F, Dummy_D, Dummy_S, Dummy_W, Dummy_C, Dummy_K3, Dummy_Ts, Dummy_K2, Dummy_K1, Dummy_R, Dummy_Va, Dummy_Pa, Dummy_Xa, Dummy_Db, Dummy_Da, Dummy_Msk, dummy_nonce: text
skab, kab, SKab, Kab, Dummy_Kab, Dummy_SKab: symmetric_key
set_276, set_275, set_273, set_272, set_270, set_269, set_268, set_267, set_265, set_264, set_262, set_261, set_259, set_258, set_257, set_256, set_247, set_246, set_226, set_225, set_212, set_211, set_210, set_209: set
State, 13, 12, 11, 9, 8, 7, 1, 0, 5, SID, 4, Dummy_State, 3, SID2, SID1: nat
k, a, b, K, A, B, A2Goal, i, A1Goal: agent
Set_148, Set_105, Set_59, Set_56, Dummy_Set_148, Dummy_Set_105, Dummy_Set_59, Dummy_Set_56, ASGoal: set(agent)


section inits:

initial_state init1 := 
 iknows(start).
 iknows(k).
 iknows(a).
 iknows(b).
 iknows(add).
 iknows(sub).
 iknows(mul).
 iknows(h).
 iknows(puba).
 iknows(mpk).
 iknows(pubb).
 iknows(i).
 state_kgc(k,a,b,skab,kab,add,sub,mul,h,puba,mpk,pubb,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_209,set_210,set_211,set_212,3).
 state_alice(a,k,b,skab,kab,add,sub,mul,h,puba,mpk,pubb,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_225,set_226,4).
 state_bob(b,k,a,skab,kab,add,sub,mul,h,puba,mpk,pubb,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_246,set_247,5).
 state_kgc(k,a,b,skab,kab,add,sub,mul,h,puba,mpk,pubb,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_256,set_257,set_258,set_259,7).
 state_alice(a,k,b,skab,kab,add,sub,mul,h,puba,mpk,pubb,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_261,set_262,8).
 state_bob(b,k,a,skab,kab,add,sub,mul,h,puba,mpk,pubb,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_264,set_265,9).
 state_kgc(k,a,b,skab,kab,add,sub,mul,h,puba,mpk,pubb,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_267,set_268,set_269,set_270,11).
 state_alice(a,k,b,skab,kab,add,sub,mul,h,puba,mpk,pubb,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_272,set_273,12).
 state_bob(b,k,a,skab,kab,add,sub,mul,h,puba,mpk,pubb,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_275,set_276,13)


section rules:

step step_0 (K,A,B,SKab,Kab,Add,Sub,Mul,H,Puba,Dummy_Mpk,Pubb,G,Dummy_Msk,IDa,IDb,Dummy_Da,Dummy_Db,Xa,Pa,Va,Xb,Pb,Vb,R,K1,K2,Ts,K3,C,W,S,D,M,D1,Y,F,Dummy_Set_55,Dummy_Set_56,Dummy_Set_58,Dummy_Set_59,SID,Msk) :=
 state_kgc(K,A,B,SKab,Kab,Add,Sub,Mul,H,Puba,Dummy_Mpk,Pubb,0,G,Dummy_Msk,IDa,IDb,Dummy_Da,Dummy_Db,Xa,Pa,Va,Xb,Pb,Vb,R,K1,K2,Ts,K3,C,W,S,D,M,D1,Y,F,Dummy_Set_55,Dummy_Set_56,Dummy_Set_58,Dummy_Set_59,SID).
 iknows(start)
=[exists Msk]=>
 state_kgc(K,A,B,SKab,Kab,Add,Sub,Mul,H,Puba,apply(H,pair(G,Dummy_Msk)),Pubb,1,G,Msk,IDa,IDb,apply(H,pair(IDa,Dummy_Msk)),apply(H,pair(IDb,Dummy_Msk)),Xa,Pa,Va,Xb,Pb,Vb,R,K1,K2,Ts,K3,C,W,S,D,M,D1,Y,F,Dummy_Set_55,Dummy_Set_56,Dummy_Set_58,Dummy_Set_59,SID).
 iknows(pair(Dummy_Da,Dummy_Db)).
 secret(Dummy_Set_55,subs1,Dummy_Set_56).
 secret(Dummy_Set_58,subs2,Dummy_Set_59).
 witness(K,A,kgc_msk,Msk).
 witness(K,B,kgc_msk,Msk).
 contains(Dummy_Msk,Dummy_Set_55).
 contains(K,Dummy_Set_56).
 contains(A,Dummy_Set_56).
 contains(Dummy_Msk,Dummy_Set_58).
 contains(K,Dummy_Set_59).
 contains(B,Dummy_Set_59)

step step_1 (A,K,B,Dummy_SKab,Dummy_Kab,Add,Sub,Mul,H,Puba,Mpk,Pubb,G,Msk,IDa,IDb,Da,Db,Dummy_Xa,Dummy_Pa,Dummy_Va,Xb,Pb,Vb,Dummy_R,Dummy_K1,Dummy_K2,Dummy_Ts,Dummy_K3,Dummy_C,Dummy_W,Dummy_S,Dummy_D,M,D1,Y,Dummy_F,Dummy_Set_104,Dummy_Set_105,SID,Xa,R,Ts) :=
 state_alice(A,K,B,Dummy_SKab,Dummy_Kab,Add,Sub,Mul,H,Puba,Mpk,Pubb,0,G,Msk,IDa,IDb,Da,Db,Dummy_Xa,Dummy_Pa,Dummy_Va,Xb,Pb,Vb,Dummy_R,Dummy_K1,Dummy_K2,Dummy_Ts,Dummy_K3,Dummy_C,Dummy_W,Dummy_S,Dummy_D,M,D1,Y,Dummy_F,Dummy_Set_104,Dummy_Set_105,SID).
 iknows(Da)
=[exists Ts,R,Xa]=>
 state_alice(A,K,B,exp(Pubb,Dummy_Xa),apply(H,pair(Dummy_SKab,pair(Mpk,IDb))),Add,Sub,Mul,H,Puba,Mpk,Pubb,1,G,Msk,IDa,IDb,Da,Db,Xa,exp(G,Dummy_Va),xor(Da,apply(H,Dummy_Xa)),Xb,Pb,Vb,R,exp(G,Dummy_R),apply(H,pair(IDa,pair(Dummy_K1,Da))),Ts,exp(G,Dummy_D),scrypt(Dummy_K3,M),apply(H,pair(M,pair(IDa,pair(IDb,pair(Dummy_K3,Dummy_Ts))))),apply(Sub,pair(Dummy_D,Dummy_F)),apply(Mul,pair(Dummy_K2,Dummy_R)),M,D1,Y,apply(Mul,pair(apply(Mul,pair(apply(Mul,pair(IDa,Dummy_W)),Dummy_Xa)),Dummy_K1)),Dummy_Set_104,Dummy_Set_105,SID).
 iknows(scrypt(Dummy_Kab,pair(Dummy_C,pair(Dummy_W,pair(Dummy_S,pair(Dummy_K1,Dummy_Ts)))))).
 secret(Dummy_Set_104,subs3,Dummy_Set_105).
 contains(Dummy_Va,Dummy_Set_104).
 contains(A,Dummy_Set_105).
 contains(B,Dummy_Set_105)

step step_2 (B,K,A,SKab,Kab,Add,Sub,Mul,H,Puba,Mpk,Pubb,G,Msk,IDa,IDb,Da,Db,Xa,Pa,Va,Dummy_Xb,Dummy_Pb,Dummy_Vb,R,K1,K2,Ts,Dummy_K3,C,W,S,D,M,Dummy_D1,Y,F,Dummy_Set_147,Dummy_Set_148,SID,Xb) :=
 state_bob(B,K,A,SKab,Kab,Add,Sub,Mul,H,Puba,Mpk,Pubb,0,G,Msk,IDa,IDb,Da,Db,Xa,Pa,Va,Dummy_Xb,Dummy_Pb,Dummy_Vb,R,K1,K2,Ts,Dummy_K3,C,W,S,D,M,Dummy_D1,Y,F,Dummy_Set_147,Dummy_Set_148,SID).
 iknows(scrypt(Kab,pair(C,pair(W,pair(S,pair(K1,Ts))))))
=[exists Xb]=>
 state_bob(B,K,A,SKab,Kab,Add,Sub,Mul,H,Puba,Mpk,Pubb,1,G,Msk,IDa,IDb,Da,Db,Xa,Pa,Va,Xb,exp(G,Dummy_Vb),xor(Db,apply(H,Dummy_Xb)),R,K1,K2,Ts,exp(exp(G,S),Puba,Dummy_D1),C,W,S,D,M,apply(Mul,pair(apply(Mul,pair(IDa,W)),K1)),Y,F,Dummy_Set_147,Dummy_Set_148,SID).
 secret(Dummy_Set_147,subs4,Dummy_Set_148).
 contains(Dummy_Vb,Dummy_Set_147).
 contains(B,Dummy_Set_148).
 contains(A,Dummy_Set_148)


section properties:

property secrecy_of_subs1 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs1,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs2 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs2,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs3 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs3,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs4 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs4,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property authentication_on_alice_va (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,alice_va,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,alice_va,MGoal))
     /\ ((request(A1Goal,A2Goal,alice_va,MGoal,SID1)
           /\ request(A1Goal,A2Goal,alice_va,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_bob_vb (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,bob_vb,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,bob_vb,MGoal))
     /\ ((request(A1Goal,A2Goal,bob_vb,MGoal,SID1)
           /\ request(A1Goal,A2Goal,bob_vb,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_kgc_msk (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,kgc_msk,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,kgc_msk,MGoal))
     /\ ((request(A1Goal,A2Goal,kgc_msk,MGoal,SID1)
           /\ request(A1Goal,A2Goal,kgc_msk,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))


section attack_states:

attack_state secrecy_of_subs1 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs1,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs2 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs2,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs3 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs3,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs4 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs4,ASGoal) &
 not(contains(i,ASGoal))

attack_state authentication_on_alice_va (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,alice_va,MGoal,SID) &
 not(witness(A2Goal,A1Goal,alice_va,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_alice_va (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,alice_va,MGoal,SID1).
 request(A1Goal,A2Goal,alice_va,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_bob_vb (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,bob_vb,MGoal,SID) &
 not(witness(A2Goal,A1Goal,bob_vb,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_bob_vb (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,bob_vb,MGoal,SID1).
 request(A1Goal,A2Goal,bob_vb,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_kgc_msk (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,kgc_msk,MGoal,SID) &
 not(witness(A2Goal,A1Goal,kgc_msk,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_kgc_msk (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,kgc_msk,MGoal,SID1).
 request(A1Goal,A2Goal,kgc_msk,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

