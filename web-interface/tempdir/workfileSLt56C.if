%% IF specification of /home/avispa/web-interface-computation/./tempdir/workfileSLt56C

section signature:

state_user3: agent * agent * agent * agent * public_key * public_key * public_key * public_key * message * message * message * hash_func * hash_func * hash_func * hash_func * hash_func * hash_func * message * nat * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * symmetric_key * set(pair(agent,message)) * set(agent) * nat -> fact
state_user2: agent * agent * agent * agent * public_key * public_key * public_key * public_key * message * message * message * hash_func * hash_func * hash_func * hash_func * hash_func * hash_func * message * nat * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * symmetric_key * set(pair(agent,message)) * set(agent) * nat -> fact
state_user1: agent * agent * agent * agent * public_key * public_key * public_key * public_key * message * message * message * hash_func * hash_func * hash_func * hash_func * hash_func * hash_func * message * nat * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * symmetric_key * set(pair(agent,message)) * set(agent) * nat -> fact
state_kgc: agent * agent * agent * agent * message * message * message * message * message * public_key * public_key * public_key * public_key * hash_func * hash_func * hash_func * hash_func * hash_func * hash_func * nat * message * message * message * message * message * message * message * message * message * message * nat -> fact


section types:

set_357, set_355, set_352, set_349, set_346, set_343, set_339, set_336, set_334, set_322, set_310, set_286: set
dummy_set: set(message)
u2_u3_w, u3_u2_w, sk, u1_u3_w, u1_u2_w, u3_u1_w, u2_u1_w, u3_kgc_ppub, u3_kgc_s3, u3_kgc_r3, u2_kgc_ppub, u2_kgc_s2, u2_kgc_r2, u1_kgc_ppub, u1_kgc_s1, u1_kgc_r1: protocol_id
State, 21, 19, 18, 15, 14, 13, 11, 10, 8, 6, SID, 5, 3, 2, 4, Dummy_State, SID2, SID1, 1, 0: nat
H, H1, M, M1, A, A1, h, h1, m, m1, a, a1: hash_func
K1, K2, K3, K, k1, k2, k3, k, ki: public_key
Set_160, Dummy_Set_211, Dummy_Set_160, Set_107, Dummy_Set_107, ASGoal, Set_211: set(agent)
IDRing, set_356, set_354, set_351, set_348, set_345, set_342, set_338, set_335, set_333, set_321, set_309, set_285: set(pair(agent,message))
SK, Dummy_SK, dummy_sk: symmetric_key
U1, U2, U3, Kc, A2Goal, A1Goal, u1, u2, u3, kc, i: agent
R1, R2, R3, S3, X3, K32, K31, K1r, K2r, K3r, EX1, EX2, EX3, K3R, K3L, Q1, Q2, Q3, Ww3, Ppub, P, ID1, ID2, ID3, W3, W2, W1, S2, X2, K23, K21, K2R, K2L, Ww2, Dummy_K3L, Dummy_K3R, Dummy_K31, Dummy_K32, Dummy_Ww3, Dummy_X3, Dummy_K1r, Dummy_K2L, Dummy_K2R, Dummy_K21, Dummy_K23, Dummy_Ww2, Dummy_X2, Dummy_EX3, Dummy_EX2, Dummy_K3r, Dummy_K2r, Dummy_Q3, Dummy_Q2, Dummy_K1L, Dummy_K1R, Dummy_EX1, Dummy_K13, Dummy_K12, Dummy_W2, S1, Dummy_W3, Dummy_Ww1, Dummy_Q1, Dummy_X1, X1, Dummy_W1, K12, K13, Dummy_Rr3, Dummy_Rr2, Dummy_Rr1, K1R, Dummy_R3, K1L, Dummy_R2, Dummy_R1, Dummy_S3, Dummy_S2, Dummy_S1, Ww1, Dummy_Ppub, dummy_msg, MGoal, p, id1, id2, id3, idi, s, start, Rr1, Rr2, Rr3, S: message


section inits:

initial_state init1 := 
 iknows(start).
 iknows(u1).
 iknows(u2).
 iknows(u3).
 iknows(kc).
 iknows(k1).
 iknows(k2).
 iknows(k3).
 iknows(k).
 iknows(p).
 iknows(h).
 iknows(h1).
 iknows(m).
 iknows(m1).
 iknows(a).
 iknows(a1).
 iknows(ki).
 iknows(idi).
 iknows(i).
 state_kgc(kc,u1,u2,u3,p,s,id1,id2,id3,k1,k2,k3,k,h,h1,m,m1,a,a1,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,3).
 state_user1(u1,u2,u3,kc,k1,k2,k3,k,id1,id2,id3,h,h1,m,m1,a,a1,p,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,set_285,set_286,4).
 state_user2(u2,u1,u3,kc,k1,k2,k3,k,id1,id2,id3,h,h1,m,m1,a,a1,p,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,set_309,set_310,5).
 state_user3(u3,u1,u2,kc,k1,k2,k3,k,id1,id2,id3,h,h1,m,m1,a,a1,p,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,set_321,set_322,6).
 state_kgc(kc,i,u2,u3,p,s,idi,id2,id3,ki,k2,k3,k,h,h1,m,m1,a,a1,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,8).
 state_user2(u2,i,u3,kc,ki,k2,k3,k,idi,id2,id3,h,h1,m,m1,a,a1,p,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,set_335,set_336,10).
 state_user3(u3,i,u2,kc,ki,k2,k3,k,idi,id2,id3,h,h1,m,m1,a,a1,p,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,set_338,set_339,11).
 state_kgc(kc,u1,u2,i,p,s,id1,id2,idi,k1,k2,ki,k,h,h1,m,m1,a,a1,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,13).
 state_user1(u1,u2,i,kc,k1,k2,ki,k,id1,id2,idi,h,h1,m,m1,a,a1,p,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,set_342,set_343,14).
 state_user2(u2,u1,i,kc,k1,k2,ki,k,id1,id2,idi,h,h1,m,m1,a,a1,p,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,set_345,set_346,15).
 state_kgc(kc,u1,i,u3,p,s,id1,idi,id3,k1,ki,k3,k,h,h1,m,m1,a,a1,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,18).
 state_user1(u1,i,u3,kc,k1,ki,k3,k,id1,idi,id3,h,h1,m,m1,a,a1,p,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,set_351,set_352,19).
 state_user3(u3,u1,i,kc,k1,ki,k3,k,id1,idi,id3,h,h1,m,m1,a,a1,p,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,set_356,set_357,21).
 contains(pair(u1,id1),set_285).
 contains(pair(u2,id2),set_285).
 contains(pair(u3,id3),set_285).
 contains(pair(u1,id1),set_309).
 contains(pair(u2,id2),set_309).
 contains(pair(u3,id3),set_309).
 contains(pair(u1,id1),set_321).
 contains(pair(u2,id2),set_321).
 contains(pair(u3,id3),set_321).
 contains(pair(i,idi),set_335).
 contains(pair(u2,id2),set_335).
 contains(pair(u3,id3),set_335).
 contains(pair(i,idi),set_338).
 contains(pair(u2,id2),set_338).
 contains(pair(u3,id3),set_338).
 contains(pair(u1,id1),set_342).
 contains(pair(u2,id2),set_342).
 contains(pair(i,idi),set_342).
 contains(pair(u1,id1),set_345).
 contains(pair(u2,id2),set_345).
 contains(pair(i,idi),set_345).
 contains(pair(u1,id1),set_351).
 contains(pair(i,idi),set_351).
 contains(pair(u3,id3),set_351).
 contains(pair(u1,id1),set_356).
 contains(pair(i,idi),set_356).
 contains(pair(u3,id3),set_356)


section rules:

step step_0 (Kc,U1,U2,U3,P,S,ID1,ID2,ID3,K1,K2,K3,K,H,H1,M,M1,A,A1,Dummy_Ppub,Dummy_S1,Dummy_S2,Dummy_S3,Dummy_R1,Dummy_R2,Dummy_R3,Dummy_Rr1,Dummy_Rr2,Dummy_Rr3,SID,Rr1,Rr2,Rr3) :=
 state_kgc(Kc,U1,U2,U3,P,S,ID1,ID2,ID3,K1,K2,K3,K,H,H1,M,M1,A,A1,0,Dummy_Ppub,Dummy_S1,Dummy_S2,Dummy_S3,Dummy_R1,Dummy_R2,Dummy_R3,Dummy_Rr1,Dummy_Rr2,Dummy_Rr3,SID).
 iknows(start)
=[exists Rr3,Rr2,Rr1]=>
 state_kgc(Kc,U1,U2,U3,P,S,ID1,ID2,ID3,K1,K2,K3,K,H,H1,M,M1,A,A1,1,apply(M,pair(P,S)),apply(A1,pair(Rr1,apply(M1,pair(S,apply(H,ID1))))),apply(A1,pair(Rr2,apply(M1,pair(S,apply(H,ID2))))),apply(A1,pair(Rr3,apply(M1,pair(S,apply(H,ID3))))),apply(M,pair(P,Rr1)),apply(M,pair(P,Rr2)),apply(M,pair(P,Rr3)),Rr1,Rr2,Rr3,SID).
 iknows(crypt(K1,crypt(inv(K),pair(apply(M,pair(P,Rr1)),pair(apply(A1,pair(Rr1,apply(M1,pair(S,apply(H,ID1))))),apply(M,pair(P,S))))))).
 iknows(crypt(K2,crypt(inv(K),pair(apply(M,pair(P,Rr2)),pair(apply(A1,pair(Rr2,apply(M1,pair(S,apply(H,ID2))))),apply(M,pair(P,S))))))).
 iknows(crypt(K3,crypt(inv(K),pair(apply(M,pair(P,Rr3)),pair(apply(A1,pair(Rr3,apply(M1,pair(S,apply(H,ID3))))),apply(M,pair(P,S))))))).
 witness(Kc,U1,u1_kgc_r1,apply(M,pair(P,Rr1))).
 witness(Kc,U1,u1_kgc_s1,apply(A1,pair(Rr1,apply(M1,pair(S,apply(H,ID1)))))).
 witness(Kc,U1,u1_kgc_ppub,apply(M,pair(P,S))).
 witness(Kc,U2,u2_kgc_r2,apply(M,pair(P,Rr2))).
 witness(Kc,U2,u2_kgc_s2,apply(A1,pair(Rr2,apply(M1,pair(S,apply(H,ID2)))))).
 witness(Kc,U2,u2_kgc_ppub,apply(M,pair(P,S))).
 witness(Kc,U3,u3_kgc_r3,apply(M,pair(P,Rr3))).
 witness(Kc,U3,u3_kgc_s3,apply(A1,pair(Rr3,apply(M1,pair(S,apply(H,ID3)))))).
 witness(Kc,U3,u3_kgc_ppub,apply(M,pair(P,S)))

step step_1 (U1,U2,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,W3,W2,Dummy_W1,Dummy_S1,Dummy_R1,R2,R3,Dummy_X1,K12,K13,K1r,K2r,K3r,EX1,EX2,EX3,K1R,K1L,Dummy_Ppub,Dummy_Q1,Q2,Q3,Dummy_Ww1,SK,IDRing,Set_107,SID,S1,R1,X1,Ppub,Ww1) :=
 state_user1(U1,U2,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,0,W3,W2,Dummy_W1,Dummy_S1,Dummy_R1,R2,R3,Dummy_X1,K12,K13,K1r,K2r,K3r,EX1,EX2,EX3,K1R,K1L,Dummy_Ppub,Dummy_Q1,Q2,Q3,Dummy_Ww1,SK,IDRing,Set_107,SID).
 iknows(crypt(K1,crypt(inv(K),pair(R1,pair(S1,Ppub))))) &
 equal(apply(A,pair(R1,apply(M,pair(Ppub,apply(H,ID1))))),apply(M,pair(P,S1)))
=[exists Ww1,X1]=>
 state_user1(U1,U2,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,1,W3,W2,apply(M,pair(P,Ww1)),S1,R1,R2,R3,X1,K12,K13,K1r,K2r,K3r,EX1,EX2,EX3,K1R,K1L,Ppub,apply(M,pair(P,X1)),Q2,Q3,Ww1,SK,IDRing,Set_107,SID).
 request(U1,Kc,u1_kgc_r1,R1,SID).
 request(U1,Kc,u1_kgc_s1,S1,SID).
 iknows(crypt(inv(K1),pair(U1,pair(ID1,pair(apply(M,pair(P,Ww1)),pair(R1,apply(M,pair(P,X1)))))))).
 witness(U1,U2,u2_u1_w,pair(apply(M,pair(P,Ww1)),R1)).
 witness(U1,U3,u3_u1_w,pair(apply(M,pair(P,Ww1)),R1))

step step_2 (U1,U2,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,Dummy_W3,Dummy_W2,W1,S1,R1,Dummy_R2,Dummy_R3,X1,Dummy_K12,Dummy_K13,K1r,K2r,K3r,Dummy_EX1,EX2,EX3,Dummy_K1R,Dummy_K1L,Ppub,Q1,Dummy_Q2,Dummy_Q3,Ww1,SK,IDRing,Set_107,SID,W3,W2,R2,R3,Q2,Q3) :=
 state_user1(U1,U2,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,1,Dummy_W3,Dummy_W2,W1,S1,R1,Dummy_R2,Dummy_R3,X1,Dummy_K12,Dummy_K13,K1r,K2r,K3r,Dummy_EX1,EX2,EX3,Dummy_K1R,Dummy_K1L,Ppub,Q1,Dummy_Q2,Dummy_Q3,Ww1,SK,IDRing,Set_107,SID).
 iknows(crypt(inv(K2),pair(U2,pair(ID2,pair(W2,pair(R2,Q2)))))).
 iknows(crypt(inv(K3),pair(U3,pair(ID3,pair(W3,pair(R3,Q3)))))).
 contains(pair(U2,ID2),IDRing).
 contains(pair(U3,ID3),IDRing)
 =>
 state_user1(U1,U2,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,2,W3,W2,W1,S1,R1,R2,R3,X1,apply(A,pair(apply(M,pair(W2,apply(A1,pair(S1,X1)))),apply(M,pair(apply(A,pair(R2,pair(Q2,apply(M,pair(Ppub,apply(H,ID2)))))),Ww1)))),apply(A,pair(apply(M,pair(W3,apply(A1,pair(S1,X1)))),apply(M,pair(apply(A,pair(R3,pair(Q3,apply(M,pair(Ppub,apply(H,ID3)))))),Ww1)))),K1r,K2r,K3r,xor(apply(H1,apply(A,pair(apply(M,pair(W3,apply(A1,pair(S1,X1)))),apply(M,pair(apply(A,pair(R3,pair(Q3,apply(M,pair(Ppub,apply(H,ID3)))))),Ww1))))),apply(H1,apply(A,pair(apply(M,pair(W2,apply(A1,pair(S1,X1)))),apply(M,pair(apply(A,pair(R2,pair(Q2,apply(M,pair(Ppub,apply(H,ID2)))))),Ww1)))))),EX2,EX3,apply(H1,apply(A,pair(apply(M,pair(W2,apply(A1,pair(S1,X1)))),apply(M,pair(apply(A,pair(R2,pair(Q2,apply(M,pair(Ppub,apply(H,ID2)))))),Ww1))))),apply(H1,apply(A,pair(apply(M,pair(W3,apply(A1,pair(S1,X1)))),apply(M,pair(apply(A,pair(R3,pair(Q3,apply(M,pair(Ppub,apply(H,ID3)))))),Ww1))))),Ppub,Q1,Q2,Q3,Ww1,SK,IDRing,Set_107,SID).
 request(U1,U2,u1_u2_w,pair(W2,R2),SID).
 request(U1,U3,u1_u3_w,pair(W3,R3),SID).
 iknows(xor(apply(H1,apply(A,pair(apply(M,pair(W3,apply(A1,pair(S1,X1)))),apply(M,pair(apply(A,pair(R3,pair(Q3,apply(M,pair(Ppub,apply(H,ID3)))))),Ww1))))),apply(H1,apply(A,pair(apply(M,pair(W2,apply(A1,pair(S1,X1)))),apply(M,pair(apply(A,pair(R2,pair(Q2,apply(M,pair(Ppub,apply(H,ID2)))))),Ww1))))))).
 contains(pair(U2,ID2),IDRing).
 contains(pair(U3,ID3),IDRing)

step step_3 (U1,U2,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,W3,W2,W1,S1,R1,R2,R3,X1,K12,K13,K1r,Dummy_K2r,Dummy_K3r,EX1,Dummy_EX2,Dummy_EX3,K1R,K1L,Ppub,Q1,Q2,Q3,Ww1,Dummy_SK,IDRing,Dummy_Set_107,SID,EX2,EX3) :=
 state_user1(U1,U2,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,2,W3,W2,W1,S1,R1,R2,R3,X1,K12,K13,K1r,Dummy_K2r,Dummy_K3r,EX1,Dummy_EX2,Dummy_EX3,K1R,K1L,Ppub,Q1,Q2,Q3,Ww1,Dummy_SK,IDRing,Dummy_Set_107,SID).
 iknows(EX2).
 iknows(EX3)
 =>
 state_user1(U1,U2,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,3,W3,W2,W1,S1,R1,R2,R3,X1,K12,K13,K1r,xor(EX2,K1R),xor(EX3,xor(EX2,K1R)),EX1,EX2,EX3,K1R,K1L,Ppub,Q1,Q2,Q3,Ww1,apply(H,pair(K1R,pair(xor(EX2,K1R),xor(EX3,xor(EX2,K1R))))),IDRing,Dummy_Set_107,SID).
 secret(apply(H,pair(K1R,pair(xor(EX2,K1R),xor(EX3,xor(EX2,K1R))))),sk,Dummy_Set_107).
 contains(U1,Dummy_Set_107).
 contains(U2,Dummy_Set_107).
 contains(U3,Dummy_Set_107)

step step_4 (U2,U1,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,W3,Dummy_W2,W1,R1,Dummy_R2,Dummy_S2,R3,Dummy_X2,K23,K21,K1r,K2r,K3r,EX1,EX2,EX3,K2R,K2L,Dummy_Ppub,Q1,Dummy_Q2,Q3,Dummy_Ww2,SK,IDRing,Set_160,SID,R2,S2,X2,Ppub,Ww2) :=
 state_user2(U2,U1,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,0,W3,Dummy_W2,W1,R1,Dummy_R2,Dummy_S2,R3,Dummy_X2,K23,K21,K1r,K2r,K3r,EX1,EX2,EX3,K2R,K2L,Dummy_Ppub,Q1,Dummy_Q2,Q3,Dummy_Ww2,SK,IDRing,Set_160,SID).
 iknows(crypt(K2,crypt(inv(K),pair(R2,pair(S2,Ppub))))) &
 equal(apply(A,pair(R2,apply(M,pair(Ppub,apply(H,ID2))))),apply(M,pair(P,S2)))
=[exists Ww2,X2]=>
 state_user2(U2,U1,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,1,W3,apply(M,pair(P,Ww2)),W1,R1,R2,S2,R3,X2,K23,K21,K1r,K2r,K3r,EX1,EX2,EX3,K2R,K2L,Ppub,Q1,apply(M,pair(P,X2)),Q3,Ww2,SK,IDRing,Set_160,SID).
 request(U2,Kc,u2_kgc_r2,R2,SID).
 request(U2,Kc,u2_kgc_s2,S2,SID).
 iknows(crypt(inv(K2),pair(U2,pair(ID2,pair(apply(M,pair(P,Ww2)),pair(R2,apply(M,pair(P,X2)))))))).
 witness(U2,U3,u3_u2_w,pair(apply(M,pair(P,Ww2)),R2)).
 witness(U2,U1,u1_u2_w,pair(apply(M,pair(P,Ww2)),R2))

step step_5 (U2,U1,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,Dummy_W3,W2,Dummy_W1,Dummy_R1,R2,S2,Dummy_R3,X2,Dummy_K23,Dummy_K21,K1r,K2r,K3r,EX1,Dummy_EX2,EX3,Dummy_K2R,Dummy_K2L,Ppub,Dummy_Q1,Q2,Dummy_Q3,Ww2,SK,IDRing,Set_160,SID,W3,W1,R1,R3,Q1,Q3) :=
 state_user2(U2,U1,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,1,Dummy_W3,W2,Dummy_W1,Dummy_R1,R2,S2,Dummy_R3,X2,Dummy_K23,Dummy_K21,K1r,K2r,K3r,EX1,Dummy_EX2,EX3,Dummy_K2R,Dummy_K2L,Ppub,Dummy_Q1,Q2,Dummy_Q3,Ww2,SK,IDRing,Set_160,SID).
 iknows(crypt(inv(K1),pair(U1,pair(ID1,pair(W1,pair(R1,Q1)))))).
 iknows(crypt(inv(K3),pair(U3,pair(ID3,pair(W3,pair(R3,Q3)))))).
 contains(pair(U1,ID1),IDRing).
 contains(pair(U3,ID3),IDRing)
 =>
 state_user2(U2,U1,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,2,W3,W2,W1,R1,R2,S2,R3,X2,apply(A,pair(apply(M,pair(W3,apply(A1,pair(S2,X2)))),apply(M,pair(apply(A,pair(R3,pair(Q3,apply(M,pair(Ppub,apply(H,ID3)))))),Ww2)))),apply(A,pair(apply(M,pair(W1,apply(A1,pair(S2,X2)))),apply(M,pair(apply(A,pair(R1,pair(Q1,apply(M,pair(Ppub,apply(H,ID1)))))),Ww2)))),K1r,K2r,K3r,EX1,xor(apply(H1,apply(A,pair(apply(M,pair(W1,apply(A1,pair(S2,X2)))),apply(M,pair(apply(A,pair(R1,pair(Q1,apply(M,pair(Ppub,apply(H,ID1)))))),Ww2))))),apply(H1,apply(A,pair(apply(M,pair(W3,apply(A1,pair(S2,X2)))),apply(M,pair(apply(A,pair(R3,pair(Q3,apply(M,pair(Ppub,apply(H,ID3)))))),Ww2)))))),EX3,apply(H1,apply(A,pair(apply(M,pair(W3,apply(A1,pair(S2,X2)))),apply(M,pair(apply(A,pair(R3,pair(Q3,apply(M,pair(Ppub,apply(H,ID3)))))),Ww2))))),apply(H1,apply(A,pair(apply(M,pair(W1,apply(A1,pair(S2,X2)))),apply(M,pair(apply(A,pair(R1,pair(Q1,apply(M,pair(Ppub,apply(H,ID1)))))),Ww2))))),Ppub,Q1,Q2,Q3,Ww2,SK,IDRing,Set_160,SID).
 request(U2,U1,u2_u1_w,pair(W1,R1),SID).
 request(U2,U3,u2_u3_w,pair(W3,R3),SID).
 iknows(xor(apply(H1,apply(A,pair(apply(M,pair(W1,apply(A1,pair(S2,X2)))),apply(M,pair(apply(A,pair(R1,pair(Q1,apply(M,pair(Ppub,apply(H,ID1)))))),Ww2))))),apply(H1,apply(A,pair(apply(M,pair(W3,apply(A1,pair(S2,X2)))),apply(M,pair(apply(A,pair(R3,pair(Q3,apply(M,pair(Ppub,apply(H,ID3)))))),Ww2))))))).
 contains(pair(U1,ID1),IDRing).
 contains(pair(U3,ID3),IDRing)

step step_6 (U2,U1,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,W3,W2,W1,R1,R2,S2,R3,X2,K23,K21,Dummy_K1r,K2r,Dummy_K3r,Dummy_EX1,EX2,Dummy_EX3,K2R,K2L,Ppub,Q1,Q2,Q3,Ww2,Dummy_SK,IDRing,Dummy_Set_160,SID,EX1) :=
 state_user2(U2,U1,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,2,W3,W2,W1,R1,R2,S2,R3,X2,K23,K21,Dummy_K1r,K2r,Dummy_K3r,Dummy_EX1,EX2,Dummy_EX3,K2R,K2L,Ppub,Q1,Q2,Q3,Ww2,Dummy_SK,IDRing,Dummy_Set_160,SID).
 iknows(EX1)
 =>
 state_user2(U2,U1,U3,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,3,W3,W2,W1,R1,R2,S2,R3,X2,K23,K21,xor(EX1,xor(EX3,K2R)),K2r,xor(EX3,K2R),EX1,EX2,Dummy_EX3,K2R,K2L,Ppub,Q1,Q2,Q3,Ww2,apply(H,pair(xor(EX1,xor(EX3,K2R)),pair(K2R,xor(EX3,K2R)))),IDRing,Dummy_Set_160,SID).
 secret(apply(H,pair(xor(EX1,xor(EX3,K2R)),pair(K2R,xor(EX3,K2R)))),sk,Dummy_Set_160).
 contains(U1,Dummy_Set_160).
 contains(U2,Dummy_Set_160).
 contains(U3,Dummy_Set_160)

step step_7 (U3,U1,U2,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,Dummy_W3,W2,W1,R1,R2,Dummy_R3,Dummy_S3,Dummy_X3,K32,K31,K1r,K2r,K3r,EX1,EX2,EX3,K3R,K3L,Q1,Q2,Dummy_Q3,Dummy_Ww3,Dummy_Ppub,SK,IDRing,Set_211,SID,R3,S3,X3,Ww3,Ppub) :=
 state_user3(U3,U1,U2,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,0,Dummy_W3,W2,W1,R1,R2,Dummy_R3,Dummy_S3,Dummy_X3,K32,K31,K1r,K2r,K3r,EX1,EX2,EX3,K3R,K3L,Q1,Q2,Dummy_Q3,Dummy_Ww3,Dummy_Ppub,SK,IDRing,Set_211,SID).
 iknows(crypt(K3,crypt(inv(K),pair(R3,pair(S3,Ppub))))) &
 equal(apply(A,pair(R3,apply(M,pair(Ppub,apply(H,ID3))))),apply(iM,pair(P,S3)))
=[exists Ww3,X3]=>
 state_user3(U3,U1,U2,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,1,apply(M,pair(P,Ww3)),W2,W1,R1,R2,R3,S3,X3,K32,K31,K1r,K2r,K3r,EX1,EX2,EX3,K3R,K3L,Q1,Q2,apply(M,pair(P,X3)),Ww3,Ppub,SK,IDRing,Set_211,SID).
 request(U3,Kc,u3_kgc_r3,R3,SID).
 request(U3,Kc,u3_kgc_s3,S3,SID).
 iknows(crypt(inv(K3),pair(U3,pair(ID3,pair(apply(M,pair(P,Ww3)),pair(R3,apply(M,pair(P,X3)))))))).
 witness(U3,U2,u2_u3_w,pair(apply(M,pair(P,Ww3)),R3)).
 witness(U3,U1,u3_u1_w,pair(apply(M,pair(P,Ww3)),R3))

step step_8 (U3,U1,U2,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,W3,Dummy_W2,Dummy_W1,Dummy_R1,Dummy_R2,R3,S3,X3,Dummy_K32,Dummy_K31,K1r,K2r,K3r,EX1,EX2,Dummy_EX3,Dummy_K3R,Dummy_K3L,Dummy_Q1,Dummy_Q2,Q3,Ww3,Ppub,SK,IDRing,Set_211,SID,W2,W1,R1,R2,Q1,Q2) :=
 state_user3(U3,U1,U2,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,1,W3,Dummy_W2,Dummy_W1,Dummy_R1,Dummy_R2,R3,S3,X3,Dummy_K32,Dummy_K31,K1r,K2r,K3r,EX1,EX2,Dummy_EX3,Dummy_K3R,Dummy_K3L,Dummy_Q1,Dummy_Q2,Q3,Ww3,Ppub,SK,IDRing,Set_211,SID).
 iknows(crypt(inv(K1),pair(U1,pair(ID1,pair(W1,pair(R1,Q1)))))).
 iknows(crypt(inv(K2),pair(U2,pair(ID2,pair(W2,pair(R2,Q2)))))).
 contains(pair(U1,ID1),IDRing).
 contains(pair(U2,ID2),IDRing)
 =>
 state_user3(U3,U1,U2,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,2,W3,W2,W1,R1,R2,R3,S3,X3,apply(A,pair(apply(M,pair(W1,apply(A1,pair(S3,X3)))),apply(M,pair(apply(A,pair(R2,pair(Q2,apply(M,pair(Ppub,apply(H,ID2)))))),Ww3)))),apply(A,pair(apply(M,pair(W1,apply(A1,pair(S3,X3)))),apply(M,pair(apply(A,pair(R1,pair(Q1,apply(M,pair(Ppub,apply(H,ID1)))))),Ww3)))),K1r,K2r,K3r,EX1,EX2,xor(apply(H1,apply(A,pair(apply(M,pair(W1,apply(A1,pair(S3,X3)))),apply(M,pair(apply(A,pair(R2,pair(Q2,apply(M,pair(Ppub,apply(H,ID2)))))),Ww3))))),apply(H1,apply(A,pair(apply(M,pair(W1,apply(A1,pair(S3,X3)))),apply(M,pair(apply(A,pair(R1,pair(Q1,apply(M,pair(Ppub,apply(H,ID1)))))),Ww3)))))),apply(H1,apply(A,pair(apply(M,pair(W1,apply(A1,pair(S3,X3)))),apply(M,pair(apply(A,pair(R1,pair(Q1,apply(M,pair(Ppub,apply(H,ID1)))))),Ww3))))),apply(H1,apply(A,pair(apply(M,pair(W1,apply(A1,pair(S3,X3)))),apply(M,pair(apply(A,pair(R2,pair(Q2,apply(M,pair(Ppub,apply(H,ID2)))))),Ww3))))),Q1,Q2,Q3,Ww3,Ppub,SK,IDRing,Set_211,SID).
 request(U3,U1,u3_u1_w,pair(W1,R1),SID).
 request(U3,U2,u3_u2_w,pair(W2,R2),SID).
 iknows(xor(apply(H1,apply(A,pair(apply(M,pair(W1,apply(A1,pair(S3,X3)))),apply(M,pair(apply(A,pair(R2,pair(Q2,apply(M,pair(Ppub,apply(H,ID2)))))),Ww3))))),apply(H1,apply(A,pair(apply(M,pair(W1,apply(A1,pair(S3,X3)))),apply(M,pair(apply(A,pair(R1,pair(Q1,apply(M,pair(Ppub,apply(H,ID1)))))),Ww3))))))).
 contains(pair(U1,ID1),IDRing).
 contains(pair(U2,ID2),IDRing)

step step_9 (U3,U1,U2,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,W3,W2,W1,R1,R2,R3,S3,X3,K32,K31,Dummy_K1r,Dummy_K2r,K3r,Dummy_EX1,Dummy_EX2,EX3,K3R,K3L,Q1,Q2,Q3,Ww3,Ppub,Dummy_SK,IDRing,Dummy_Set_211,SID,EX1) :=
 state_user3(U3,U1,U2,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,2,W3,W2,W1,R1,R2,R3,S3,X3,K32,K31,Dummy_K1r,Dummy_K2r,K3r,Dummy_EX1,Dummy_EX2,EX3,K3R,K3L,Q1,Q2,Q3,Ww3,Ppub,Dummy_SK,IDRing,Dummy_Set_211,SID).
 iknows(EX1)
 =>
 state_user3(U3,U1,U2,Kc,K1,K2,K3,K,ID1,ID2,ID3,H,H1,M,M1,A,A1,P,3,W3,W2,W1,R1,R2,R3,S3,X3,K32,K31,xor(EX1,K3R),xor(EX2,xor(EX1,K3R)),K3r,EX1,Dummy_EX2,EX3,K3R,K3L,Q1,Q2,Q3,Ww3,Ppub,apply(H,pair(xor(EX1,K3R),pair(xor(EX2,xor(EX1,K3R)),K3R))),IDRing,Dummy_Set_211,SID).
 secret(apply(H,pair(xor(EX1,K3R),pair(xor(EX2,xor(EX1,K3R)),K3R))),sk,Dummy_Set_211).
 contains(U1,Dummy_Set_211).
 contains(U2,Dummy_Set_211).
 contains(U3,Dummy_Set_211)


section properties:

property secrecy_of_sk (MGoal,ASGoal) :=
 [] ((secret(MGoal,sk,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property authentication_on_u2_u1_w (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u2_u1_w,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u2_u1_w,MGoal))
     /\ ((request(A1Goal,A2Goal,u2_u1_w,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u2_u1_w,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u3_u1_w (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u3_u1_w,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u3_u1_w,MGoal))
     /\ ((request(A1Goal,A2Goal,u3_u1_w,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u3_u1_w,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u1_u2_w (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u1_u2_w,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u1_u2_w,MGoal))
     /\ ((request(A1Goal,A2Goal,u1_u2_w,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u1_u2_w,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u3_u2_w (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u3_u2_w,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u3_u2_w,MGoal))
     /\ ((request(A1Goal,A2Goal,u3_u2_w,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u3_u2_w,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u2_u3_w (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u2_u3_w,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u2_u3_w,MGoal))
     /\ ((request(A1Goal,A2Goal,u2_u3_w,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u2_u3_w,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u1_u3_w (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u1_u3_w,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u1_u3_w,MGoal))
     /\ ((request(A1Goal,A2Goal,u1_u3_w,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u1_u3_w,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u1_kgc_r1 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u1_kgc_r1,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u1_kgc_r1,MGoal))
     /\ ((request(A1Goal,A2Goal,u1_kgc_r1,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u1_kgc_r1,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u2_kgc_r2 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u2_kgc_r2,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u2_kgc_r2,MGoal))
     /\ ((request(A1Goal,A2Goal,u2_kgc_r2,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u2_kgc_r2,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u3_kgc_r3 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u3_kgc_r3,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u3_kgc_r3,MGoal))
     /\ ((request(A1Goal,A2Goal,u3_kgc_r3,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u3_kgc_r3,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u1_kgc_s1 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u1_kgc_s1,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u1_kgc_s1,MGoal))
     /\ ((request(A1Goal,A2Goal,u1_kgc_s1,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u1_kgc_s1,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u2_kgc_s2 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u2_kgc_s2,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u2_kgc_s2,MGoal))
     /\ ((request(A1Goal,A2Goal,u2_kgc_s2,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u2_kgc_s2,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u3_kgc_s3 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u3_kgc_s3,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u3_kgc_s3,MGoal))
     /\ ((request(A1Goal,A2Goal,u3_kgc_s3,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u3_kgc_s3,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u1_kgc_ppub (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u1_kgc_ppub,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u1_kgc_ppub,MGoal))
     /\ ((request(A1Goal,A2Goal,u1_kgc_ppub,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u1_kgc_ppub,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u2_kgc_ppub (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u2_kgc_ppub,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u2_kgc_ppub,MGoal))
     /\ ((request(A1Goal,A2Goal,u2_kgc_ppub,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u2_kgc_ppub,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_u3_kgc_ppub (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,u3_kgc_ppub,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,u3_kgc_ppub,MGoal))
     /\ ((request(A1Goal,A2Goal,u3_kgc_ppub,MGoal,SID1)
           /\ request(A1Goal,A2Goal,u3_kgc_ppub,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))


section attack_states:

attack_state secrecy_of_sk (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,sk,ASGoal) &
 not(contains(i,ASGoal))

attack_state authentication_on_u2_u1_w (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u2_u1_w,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u2_u1_w,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u2_u1_w (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u2_u1_w,MGoal,SID1).
 request(A1Goal,A2Goal,u2_u1_w,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u3_u1_w (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u3_u1_w,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u3_u1_w,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u3_u1_w (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u3_u1_w,MGoal,SID1).
 request(A1Goal,A2Goal,u3_u1_w,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u1_u2_w (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u1_u2_w,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u1_u2_w,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u1_u2_w (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u1_u2_w,MGoal,SID1).
 request(A1Goal,A2Goal,u1_u2_w,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u3_u2_w (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u3_u2_w,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u3_u2_w,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u3_u2_w (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u3_u2_w,MGoal,SID1).
 request(A1Goal,A2Goal,u3_u2_w,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u2_u3_w (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u2_u3_w,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u2_u3_w,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u2_u3_w (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u2_u3_w,MGoal,SID1).
 request(A1Goal,A2Goal,u2_u3_w,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u1_u3_w (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u1_u3_w,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u1_u3_w,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u1_u3_w (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u1_u3_w,MGoal,SID1).
 request(A1Goal,A2Goal,u1_u3_w,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u1_kgc_r1 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u1_kgc_r1,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u1_kgc_r1,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u1_kgc_r1 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u1_kgc_r1,MGoal,SID1).
 request(A1Goal,A2Goal,u1_kgc_r1,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u2_kgc_r2 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u2_kgc_r2,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u2_kgc_r2,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u2_kgc_r2 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u2_kgc_r2,MGoal,SID1).
 request(A1Goal,A2Goal,u2_kgc_r2,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u3_kgc_r3 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u3_kgc_r3,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u3_kgc_r3,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u3_kgc_r3 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u3_kgc_r3,MGoal,SID1).
 request(A1Goal,A2Goal,u3_kgc_r3,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u1_kgc_s1 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u1_kgc_s1,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u1_kgc_s1,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u1_kgc_s1 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u1_kgc_s1,MGoal,SID1).
 request(A1Goal,A2Goal,u1_kgc_s1,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u2_kgc_s2 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u2_kgc_s2,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u2_kgc_s2,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u2_kgc_s2 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u2_kgc_s2,MGoal,SID1).
 request(A1Goal,A2Goal,u2_kgc_s2,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u3_kgc_s3 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u3_kgc_s3,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u3_kgc_s3,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u3_kgc_s3 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u3_kgc_s3,MGoal,SID1).
 request(A1Goal,A2Goal,u3_kgc_s3,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u1_kgc_ppub (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u1_kgc_ppub,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u1_kgc_ppub,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u1_kgc_ppub (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u1_kgc_ppub,MGoal,SID1).
 request(A1Goal,A2Goal,u1_kgc_ppub,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u2_kgc_ppub (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u2_kgc_ppub,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u2_kgc_ppub,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u2_kgc_ppub (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u2_kgc_ppub,MGoal,SID1).
 request(A1Goal,A2Goal,u2_kgc_ppub,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_u3_kgc_ppub (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,u3_kgc_ppub,MGoal,SID) &
 not(witness(A2Goal,A1Goal,u3_kgc_ppub,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_u3_kgc_ppub (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,u3_kgc_ppub,MGoal,SID1).
 request(A1Goal,A2Goal,u3_kgc_ppub,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

