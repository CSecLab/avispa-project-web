%% IF specification of /home/avispa/web-interface-computation/./tempdir/workfilensl2Ll

section signature:

state_supplier_visitor: agent * agent * agent * agent * agent * agent * public_key * public_key * public_key * public_key * symmetric_key * nat * text * text * text * text * text * text * text * text * text * text * pair(agent,pair(text,pair(text,text))) * scrypt(symmetric_key,crypt(inv(public_key),pair(agent,pair(public_key,pair(crypt(inv(public_key),pair(agent,public_key)),pair(agent,pair(text,pair(text,text)))))))) * crypt(inv(public_key),pair(agent,pair(public_key,pair(crypt(inv(public_key),pair(agent,public_key)),pair(agent,pair(text,pair(text,text))))))) * pair(agent,pair(text,pair(text,pair(text,scrypt(symmetric_key,crypt(inv(public_key),pair(agent,pair(public_key,pair(crypt(inv(public_key),pair(agent,public_key)),pair(agent,pair(text,pair(text,text)))))))))))) * hash_func * set(text) * set(text) * set(agent) * nat -> fact
state_supplier_host: agent * agent * agent * agent * public_key * public_key * public_key * public_key * nat * text * text * text * text * text * text * text * text * text * pair(agent,pair(text,pair(text,pair(text,scrypt(symmetric_key,crypt(inv(public_key),pair(agent,pair(public_key,pair(crypt(inv(public_key),pair(agent,public_key)),pair(agent,pair(text,pair(text,text)))))))))))) * set(text) * nat -> fact
state_smart_meter: agent * agent * agent * agent * agent * public_key * public_key * public_key * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * pair(agent,pair(text,pair(text,pair(text,scrypt(symmetric_key,crypt(inv(public_key),pair(agent,pair(public_key,pair(crypt(inv(public_key),pair(agent,public_key)),pair(agent,pair(text,pair(text,text)))))))))))) * set(text) * nat -> fact
state_smart_card: agent * agent * agent * agent * agent * symmetric_key * hash_func * public_key * public_key * nat * text * pair(agent,pair(text,pair(text,text))) * crypt(inv(public_key),pair(agent,pair(public_key,pair(crypt(inv(public_key),pair(agent,public_key)),pair(agent,pair(text,pair(text,text))))))) * scrypt(symmetric_key,crypt(inv(public_key),pair(agent,pair(public_key,pair(crypt(inv(public_key),pair(agent,public_key)),pair(agent,pair(text,pair(text,text)))))))) * pair(agent,pair(text,pair(text,pair(text,scrypt(symmetric_key,crypt(inv(public_key),pair(agent,pair(public_key,pair(crypt(inv(public_key),pair(agent,public_key)),pair(agent,pair(text,pair(text,text)))))))))))) * set(agent) * nat -> fact
state_electric_vehicle_supply_equipment: agent * agent * agent * symmetric_key * hash_func * nat * text * text * text * text * text * pair(agent,pair(text,pair(text,pair(text,scrypt(symmetric_key,crypt(inv(public_key),pair(agent,pair(public_key,pair(crypt(inv(public_key),pair(agent,public_key)),pair(agent,pair(text,pair(text,text)))))))))))) * set(text) * nat -> fact
state_electric_vehicle: agent * agent * nat * set(text) * nat -> fact


section types:

C_SCv, Dummy_C_SCv: scrypt(symmetric_key,crypt(inv(public_key),pair(agent,pair(public_key,pair(crypt(inv(public_key),pair(agent,public_key)),pair(agent,pair(text,pair(text,text))))))))
Sig_SCv, Dummy_Sig_SCv: crypt(inv(public_key),pair(agent,pair(public_key,pair(crypt(inv(public_key),pair(agent,public_key)),pair(agent,pair(text,pair(text,text)))))))
M_SCv, Dummy_M_SCv: pair(agent,pair(text,pair(text,text)))
decsv, sh_auth_sv, sv_auth_sh, smh_auth_sh, sh_auth_smh, sv_auth_scv, sigscv, evseh_auth_smh, smh_auth_evseh: protocol_id
pk_uv, pk_smh, pk_sh, pk_sv, pk_ta, pk_i, PK_Sh, PK_Sv, PK_TA, PK_SCv, PK_SMh, dummy_pk: public_key
REQ_SCv, Dummy_REQ_SCv: pair(agent,pair(text,pair(text,pair(text,scrypt(symmetric_key,crypt(inv(public_key),pair(agent,pair(public_key,pair(crypt(inv(public_key),pair(agent,public_key)),pair(agent,pair(text,pair(text,text))))))))))))
dummy_set: set(message)
set_318, set_314, set_311, set_307, set_303, set_300, set_296, set_293, set_290, set_287, set_283, set_279, set_276, set_272, set_265, set_246, set_225, set_224, set_223, set_222: set
Set_149, Dummy_Set_149, Set_59, Dummy_Set_59, ASGoal: set(agent)
MGoal, start: message
C1_SMh, C1_Sh, C2_Sh, C_Sv, T1_SMh, T1_Sh, T2_Sh, T_Sv, T_EVSEh, DEC_Sv, C2_SMh, C_EVSEh, T2_SMh, Dummy_C_Sv, Dummy_T_Sv, Dummy_C1_Sh, Dummy_T1_Sh, Dummy_C2_Sh, Dummy_T2_Sh, Dummy_C1_SMh, Dummy_T1_SMh, Dummy_C2_SMh, Dummy_T2_SMh, Dummy_DEC_Sv, Dummy_C_EVSEh, Dummy_T_EVSEh, p_Sh, dummy_nonce, psid1_EVv, psid2_EVv, psid3_EVv: text
L, PSD, Dummy_L, Dummy_PSD, set_227, set_226: set(text)
State, 57, 56, 55, 54, 53, 52, 49, 48, 47, 46, 45, 43, 41, 40, 39, 38, 36, 35, 33, 31, 29, 28, 27, 25, 24, 22, 21, 20, 19, 18, 15, 14, 13, 12, 11, 10, 8, SID, 7, 6, 5, 3, 4, 2, Dummy_State, SID2, 1, SID1, 0: nat
H, dummy_hash, h: hash_func
scv, evv, evseh, smh, sh, sv, ta, SCv, EVSEh, SMh, Sh, Sv, TA, dummy_agent, A2Goal, A1Goal, EVv, i: agent
k_scvi, K_SCvSv, K_EVSEhSMh, dummy_sk, k_evsehsmh, k_evsehi, k_ismh, k_scvsv, k_isv: symmetric_key


section inits:

initial_state init1 := 
 iknows(start).
 iknows(evv).
 iknows(evseh).
 iknows(smh).
 iknows(sh).
 iknows(sv).
 iknows(k_ismh).
 iknows(k_evsehi).
 iknows(k_isv).
 iknows(k_scvi).
 iknows(pk_smh).
 iknows(pk_sh).
 iknows(pk_sv).
 iknows(pk_ta).
 iknows(pk_i).
 iknows(inv(pk_i)).
 iknows(h).
 iknows(i).
 state_electric_vehicle(evv,evseh,0,dummy_set,3).
 state_electric_vehicle_supply_equipment(evseh,scv,smh,k_evsehsmh,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,4).
 state_smart_card(scv,evseh,smh,sh,sv,k_scvsv,h,pk_uv,pk_ta,0,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),set_246,5).
 state_smart_meter(evseh,smh,sh,sv,ta,pk_smh,pk_sh,pk_ta,k_evsehsmh,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,6).
 state_supplier_host(smh,sh,sv,ta,pk_sh,pk_smh,pk_sv,pk_ta,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,7).
 state_supplier_visitor(sh,sv,evseh,scv,smh,ta,pk_sh,pk_sv,pk_ta,pk_uv,k_scvsv,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_hash,dummy_set,dummy_set,set_265,8).
 state_electric_vehicle(evv,evseh,0,dummy_set,10).
 state_electric_vehicle_supply_equipment(evseh,scv,smh,k_evsehsmh,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,11).
 state_smart_card(scv,evseh,smh,sh,sv,k_scvsv,h,pk_uv,pk_ta,0,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),set_272,12).
 state_smart_meter(evseh,smh,sh,sv,ta,pk_smh,pk_sh,pk_ta,k_evsehsmh,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,13).
 state_supplier_host(smh,sh,sv,ta,pk_sh,pk_smh,pk_sv,pk_ta,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,14).
 state_supplier_visitor(sh,sv,evseh,scv,smh,ta,pk_sh,pk_sv,pk_ta,pk_uv,k_scvsv,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_hash,dummy_set,dummy_set,set_276,15).
 state_electric_vehicle_supply_equipment(evseh,scv,smh,k_evsehsmh,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,18).
 state_smart_card(scv,evseh,smh,sh,sv,k_scvsv,h,pk_uv,pk_ta,0,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),set_279,19).
 state_smart_meter(evseh,smh,sh,sv,ta,pk_smh,pk_sh,pk_ta,k_evsehsmh,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,20).
 state_supplier_host(smh,sh,sv,ta,pk_sh,pk_smh,pk_sv,pk_ta,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,21).
 state_supplier_visitor(sh,sv,evseh,scv,smh,ta,pk_sh,pk_sv,pk_ta,pk_uv,k_scvsv,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_hash,dummy_set,dummy_set,set_283,22).
 state_electric_vehicle(evv,evseh,0,dummy_set,24).
 state_electric_vehicle_supply_equipment(evseh,i,smh,k_evsehsmh,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,25).
 state_smart_meter(evseh,smh,sh,sv,ta,pk_smh,pk_sh,pk_ta,k_evsehsmh,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,27).
 state_supplier_host(smh,sh,sv,ta,pk_sh,pk_smh,pk_sv,pk_ta,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,28).
 state_supplier_visitor(sh,sv,evseh,i,smh,ta,pk_sh,pk_sv,pk_ta,pk_i,k_isv,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_hash,dummy_set,dummy_set,set_290,29).
 state_electric_vehicle(evv,i,0,dummy_set,31).
 state_smart_card(scv,i,smh,sh,sv,k_scvsv,h,pk_uv,pk_ta,0,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),set_293,33).
 state_supplier_host(smh,sh,sv,ta,pk_sh,pk_smh,pk_sv,pk_ta,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,35).
 state_supplier_visitor(sh,sv,i,scv,smh,ta,pk_sh,pk_sv,pk_ta,pk_uv,k_scvsv,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_hash,dummy_set,dummy_set,set_296,36).
 state_electric_vehicle(evv,evseh,0,dummy_set,38).
 state_electric_vehicle_supply_equipment(evseh,scv,i,k_evsehi,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,39).
 state_smart_card(scv,evseh,i,sh,sv,k_scvsv,h,pk_uv,pk_ta,0,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),set_300,40).
 state_smart_meter(evseh,i,sh,sv,ta,pk_i,pk_sh,pk_ta,k_evsehi,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,41).
 state_supplier_visitor(sh,sv,evseh,scv,i,ta,pk_sh,pk_sv,pk_ta,pk_uv,k_scvsv,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_hash,dummy_set,dummy_set,set_303,43).
 state_electric_vehicle(evv,evseh,0,dummy_set,45).
 state_electric_vehicle_supply_equipment(evseh,scv,smh,k_evsehsmh,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,46).
 state_smart_card(scv,evseh,smh,i,sv,k_scvsv,h,pk_uv,pk_ta,0,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),set_307,47).
 state_smart_meter(evseh,smh,i,sv,ta,pk_smh,pk_i,pk_ta,k_evsehsmh,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,48).
 state_supplier_host(smh,i,sv,ta,pk_i,pk_smh,pk_sv,pk_ta,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,49).
 state_electric_vehicle(evv,evseh,0,dummy_set,52).
 state_electric_vehicle_supply_equipment(evseh,scv,smh,k_evsehsmh,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,53).
 state_smart_card(scv,evseh,smh,sh,i,k_scvsv,h,pk_uv,pk_ta,0,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),set_314,54).
 state_smart_meter(evseh,smh,sh,i,ta,pk_smh,pk_sh,pk_ta,k_evsehsmh,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,55).
 state_supplier_host(smh,sh,i,ta,pk_sh,pk_smh,pk_i,pk_ta,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_set,56).
 state_supplier_visitor(sh,i,evseh,scv,smh,ta,pk_sh,pk_i,pk_ta,pk_uv,k_scvsv,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))),scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))),crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce))))))),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,pair(dummy_nonce,scrypt(dummy_sk,crypt(inv(dummy_pk),pair(dummy_agent,pair(dummy_pk,pair(crypt(inv(dummy_pk),pair(dummy_agent,dummy_pk)),pair(dummy_agent,pair(dummy_nonce,pair(dummy_nonce,dummy_nonce)))))))))))),dummy_hash,dummy_set,dummy_set,set_318,57)


section rules:

step step_0 (EVv,EVSEh,Dummy_PSD,SID) :=
 state_electric_vehicle(EVv,EVSEh,0,Dummy_PSD,SID).
 iknows(start).
 contains(psid1_EVv,Dummy_PSD)
 =>
 state_electric_vehicle(EVv,EVSEh,1,Dummy_PSD,SID).
 iknows(psid1_EVv)

step step_1 (EVv,EVSEh,Dummy_PSD,SID) :=
 state_electric_vehicle(EVv,EVSEh,0,Dummy_PSD,SID).
 iknows(start) &
 not(contains(psid1_EVv,Dummy_PSD))
 =>
 state_electric_vehicle(EVv,EVSEh,1,Dummy_PSD,SID).
 iknows(psid1_EVv)

step step_2 (EVSEh,SCv,SMh,K_EVSEhSMh,H,DEC_Sv,Dummy_T_EVSEh,T2_SMh,C_EVSEh,C2_SMh,REQ_SCv,L,SID,T_EVSEh) :=
 state_electric_vehicle_supply_equipment(EVSEh,SCv,SMh,K_EVSEhSMh,H,0,DEC_Sv,Dummy_T_EVSEh,T2_SMh,C_EVSEh,C2_SMh,REQ_SCv,L,SID).
 iknows(psid1_EVv)
=[exists T_EVSEh]=>
 state_electric_vehicle_supply_equipment(EVSEh,SCv,SMh,K_EVSEhSMh,H,1,DEC_Sv,T_EVSEh,T2_SMh,C_EVSEh,C2_SMh,REQ_SCv,L,SID).
 iknows(pair(psid1_EVv,pair(p_Sh,T_EVSEh)))

step step_3 (EVSEh,SCv,SMh,K_EVSEhSMh,H,DEC_Sv,Dummy_T_EVSEh,T2_SMh,Dummy_C_EVSEh,C2_SMh,Dummy_REQ_SCv,L,SID,T_EVSEh,REQ_SCv) :=
 state_electric_vehicle_supply_equipment(EVSEh,SCv,SMh,K_EVSEhSMh,H,1,DEC_Sv,Dummy_T_EVSEh,T2_SMh,Dummy_C_EVSEh,C2_SMh,Dummy_REQ_SCv,L,SID).
 iknows(REQ_SCv)
=[exists T_EVSEh]=>
 state_electric_vehicle_supply_equipment(EVSEh,SCv,SMh,K_EVSEhSMh,H,2,DEC_Sv,T_EVSEh,T2_SMh,scrypt(K_EVSEhSMh,REQ_SCv),C2_SMh,REQ_SCv,L,SID).
 iknows(pair(EVSEh,pair(SMh,pair(scrypt(K_EVSEhSMh,REQ_SCv),pair(T_EVSEh,apply(H,pair(EVSEh,pair(SMh,pair(scrypt(K_EVSEhSMh,REQ_SCv),pair(T_EVSEh,K_EVSEhSMh)))))))))).
 witness(EVSEh,SMh,smh_auth_evseh,T_EVSEh)

step step_4 (EVSEh,SCv,SMh,K_EVSEhSMh,H,Dummy_DEC_Sv,T_EVSEh,Dummy_T2_SMh,C_EVSEh,Dummy_C2_SMh,REQ_SCv,Dummy_L,SID,DEC_Sv,T2_SMh) :=
 state_electric_vehicle_supply_equipment(EVSEh,SCv,SMh,K_EVSEhSMh,H,2,Dummy_DEC_Sv,T_EVSEh,Dummy_T2_SMh,C_EVSEh,Dummy_C2_SMh,REQ_SCv,Dummy_L,SID).
 iknows(pair(SMh,pair(EVSEh,pair(scrypt(K_EVSEhSMh,DEC_Sv),pair(T2_SMh,apply(H,pair(SMh,pair(EVSEh,pair(scrypt(K_EVSEhSMh,DEC_Sv),pair(T2_SMh,K_EVSEhSMh)))))))))) &
 not(contains(T2_SMh,Dummy_L))
 =>
 state_electric_vehicle_supply_equipment(EVSEh,SCv,SMh,K_EVSEhSMh,H,3,DEC_Sv,T_EVSEh,T2_SMh,C_EVSEh,scrypt(K_EVSEhSMh,DEC_Sv),REQ_SCv,Dummy_L,SID).
 request(EVSEh,SMh,evseh_auth_smh,T2_SMh,SID).
 contains(T2_SMh,Dummy_L)

step step_5 (SCv,EVSEh,Sv,Sh,SMh,K_SCvSv,H,PK_SCv,PK_TA,Dummy_T_EVSEh,Dummy_M_SCv,Dummy_Sig_SCv,Dummy_C_SCv,Dummy_REQ_SCv,Dummy_Set_59,SID,T_EVSEh) :=
 state_smart_card(SCv,EVSEh,Sv,Sh,SMh,K_SCvSv,H,PK_SCv,PK_TA,0,Dummy_T_EVSEh,Dummy_M_SCv,Dummy_Sig_SCv,Dummy_C_SCv,Dummy_REQ_SCv,Dummy_Set_59,SID).
 iknows(pair(psid1_EVv,pair(p_Sh,T_EVSEh)))
 =>
 state_smart_card(SCv,EVSEh,Sv,Sh,SMh,K_SCvSv,H,PK_SCv,PK_TA,1,T_EVSEh,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))),crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))))),scrypt(K_SCvSv,pair(SCv,pair(PK_SCv,pair(crypt(inv(PK_TA),pair(SCv,PK_SCv)),crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))))))))),pair(pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))),scrypt(K_SCvSv,pair(SCv,pair(PK_SCv,pair(crypt(inv(PK_TA),pair(SCv,PK_SCv)),crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh)))))))))),Dummy_Set_59,SID).
 iknows(pair(pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))),scrypt(K_SCvSv,pair(SCv,pair(PK_SCv,pair(crypt(inv(PK_TA),pair(SCv,PK_SCv)),crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))))))))))).
 secret(crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))))),sigscv,Dummy_Set_59).
 witness(SCv,Sv,sv_auth_scv,crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh)))))).
 contains(SCv,Dummy_Set_59).
 contains(Sv,Dummy_Set_59)

step step_6 (SMh,EVSEh,Sh,Sv,TA,PK_SMh,PK_Sh,PK_TA,K_EVSEhSMh,H,DEC_Sv,Dummy_T1_SMh,T2_SMh,T1_Sh,T2_Sh,Dummy_T_EVSEh,Dummy_C1_SMh,C2_SMh,C1_Sh,C2_Sh,Dummy_C_EVSEh,Dummy_REQ_SCv,Dummy_L,SID,T1_SMh,T_EVSEh,REQ_SCv) :=
 state_smart_meter(SMh,EVSEh,Sh,Sv,TA,PK_SMh,PK_Sh,PK_TA,K_EVSEhSMh,H,0,DEC_Sv,Dummy_T1_SMh,T2_SMh,T1_Sh,T2_Sh,Dummy_T_EVSEh,Dummy_C1_SMh,C2_SMh,C1_Sh,C2_Sh,Dummy_C_EVSEh,Dummy_REQ_SCv,Dummy_L,SID).
 iknows(pair(EVSEh,pair(SMh,pair(scrypt(K_EVSEhSMh,REQ_SCv),pair(T_EVSEh,apply(H,pair(EVSEh,pair(SMh,pair(scrypt(K_EVSEhSMh,REQ_SCv),pair(T_EVSEh,K_EVSEhSMh)))))))))) &
 not(contains(T_EVSEh,Dummy_L))
=[exists T1_SMh]=>
 state_smart_meter(SMh,EVSEh,Sh,Sv,TA,PK_SMh,PK_Sh,PK_TA,K_EVSEhSMh,H,1,DEC_Sv,T1_SMh,T2_SMh,T1_Sh,T2_Sh,T_EVSEh,crypt(PK_Sh,REQ_SCv),C2_SMh,C1_Sh,C2_Sh,scrypt(K_EVSEhSMh,REQ_SCv),REQ_SCv,Dummy_L,SID).
 iknows(pair(PK_SMh,pair(SMh,pair(crypt(inv(PK_TA),pair(PK_SMh,SMh)),pair(Sh,pair(crypt(PK_Sh,REQ_SCv),pair(T1_SMh,crypt(inv(PK_SMh),pair(Sh,pair(crypt(PK_Sh,REQ_SCv),T1_SMh)))))))))).
 witness(SMh,Sh,sh_auth_smh,T1_SMh).
 request(SMh,EVSEh,smh_auth_evseh,T_EVSEh,SID).
 contains(T_EVSEh,Dummy_L)

step step_7 (SMh,EVSEh,Sh,Sv,TA,PK_SMh,PK_Sh,PK_TA,K_EVSEhSMh,H,Dummy_DEC_Sv,T1_SMh,Dummy_T2_SMh,T1_Sh,Dummy_T2_Sh,T_EVSEh,C1_SMh,Dummy_C2_SMh,C1_Sh,Dummy_C2_Sh,C_EVSEh,REQ_SCv,Dummy_L,SID,DEC_Sv,T2_SMh,T2_Sh) :=
 state_smart_meter(SMh,EVSEh,Sh,Sv,TA,PK_SMh,PK_Sh,PK_TA,K_EVSEhSMh,H,1,Dummy_DEC_Sv,T1_SMh,Dummy_T2_SMh,T1_Sh,Dummy_T2_Sh,T_EVSEh,C1_SMh,Dummy_C2_SMh,C1_Sh,Dummy_C2_Sh,C_EVSEh,REQ_SCv,Dummy_L,SID).
 iknows(pair(PK_Sh,pair(Sh,pair(crypt(inv(PK_TA),pair(PK_Sh,Sh)),pair(SMh,pair(crypt(PK_SMh,DEC_Sv),pair(T2_Sh,crypt(inv(PK_Sh),pair(SMh,pair(crypt(PK_SMh,DEC_Sv),T2_Sh)))))))))) &
 not(contains(T2_Sh,Dummy_L))
=[exists T2_SMh]=>
 state_smart_meter(SMh,EVSEh,Sh,Sv,TA,PK_SMh,PK_Sh,PK_TA,K_EVSEhSMh,H,2,DEC_Sv,T1_SMh,T2_SMh,T1_Sh,T2_Sh,T_EVSEh,C1_SMh,scrypt(K_EVSEhSMh,DEC_Sv),C1_Sh,crypt(PK_SMh,DEC_Sv),C_EVSEh,REQ_SCv,Dummy_L,SID).
 iknows(pair(SMh,pair(EVSEh,pair(scrypt(K_EVSEhSMh,DEC_Sv),pair(T2_SMh,apply(H,pair(SMh,pair(EVSEh,pair(scrypt(K_EVSEhSMh,DEC_Sv),pair(T2_SMh,K_EVSEhSMh)))))))))).
 witness(SMh,EVSEh,evseh_auth_smh,T2_SMh).
 request(SMh,Sh,smh_auth_sh,T2_Sh,SID).
 contains(T2_Sh,Dummy_L)

step step_8 (Sh,SMh,Sv,TA,PK_SMh,PK_Sh,PK_Sv,PK_TA,DEC_Sv,Dummy_T1_SMh,Dummy_T1_Sh,T2_Sh,T_Sv,Dummy_C1_SMh,Dummy_C1_Sh,C2_Sh,C_Sv,Dummy_REQ_SCv,Dummy_L,SID,T1_SMh,T1_Sh,REQ_SCv) :=
 state_supplier_host(Sh,SMh,Sv,TA,PK_SMh,PK_Sh,PK_Sv,PK_TA,0,DEC_Sv,Dummy_T1_SMh,Dummy_T1_Sh,T2_Sh,T_Sv,Dummy_C1_SMh,Dummy_C1_Sh,C2_Sh,C_Sv,Dummy_REQ_SCv,Dummy_L,SID).
 iknows(pair(PK_SMh,pair(SMh,pair(crypt(inv(PK_TA),pair(PK_SMh,SMh)),pair(Sh,pair(crypt(PK_Sh,REQ_SCv),pair(T1_SMh,crypt(inv(PK_SMh),pair(Sh,pair(crypt(PK_Sh,REQ_SCv),T1_SMh)))))))))) &
 not(contains(T1_SMh,Dummy_L))
=[exists T1_Sh]=>
 state_supplier_host(Sh,SMh,Sv,TA,PK_SMh,PK_Sh,PK_Sv,PK_TA,1,DEC_Sv,T1_SMh,T1_Sh,T2_Sh,T_Sv,crypt(PK_Sh,REQ_SCv),crypt(PK_Sv,REQ_SCv),C2_Sh,C_Sv,REQ_SCv,Dummy_L,SID).
 iknows(pair(PK_Sh,pair(Sh,pair(crypt(inv(PK_TA),pair(PK_Sh,Sh)),pair(Sv,pair(crypt(PK_Sv,REQ_SCv),pair(T1_Sh,crypt(inv(PK_Sh),pair(Sv,pair(crypt(PK_Sv,REQ_SCv),T1_Sh)))))))))).
 witness(Sh,Sv,sv_auth_sh,T1_Sh).
 request(Sh,SMh,sh_auth_smh,T1_SMh,SID).
 contains(T1_SMh,Dummy_L)

step step_9 (Sh,SMh,Sv,TA,PK_SMh,PK_Sh,PK_Sv,PK_TA,Dummy_DEC_Sv,T1_SMh,T1_Sh,Dummy_T2_Sh,Dummy_T_Sv,C1_SMh,C1_Sh,Dummy_C2_Sh,Dummy_C_Sv,REQ_SCv,Dummy_L,SID,DEC_Sv,T2_Sh,T_Sv) :=
 state_supplier_host(Sh,SMh,Sv,TA,PK_SMh,PK_Sh,PK_Sv,PK_TA,1,Dummy_DEC_Sv,T1_SMh,T1_Sh,Dummy_T2_Sh,Dummy_T_Sv,C1_SMh,C1_Sh,Dummy_C2_Sh,Dummy_C_Sv,REQ_SCv,Dummy_L,SID).
 iknows(pair(PK_Sv,pair(Sv,pair(crypt(inv(PK_TA),pair(PK_Sv,Sv)),pair(Sh,pair(crypt(PK_Sh,DEC_Sv),pair(T_Sv,crypt(inv(PK_Sv),pair(Sh,pair(crypt(PK_Sh,DEC_Sv),T_Sv)))))))))) &
 not(contains(T_Sv,Dummy_L))
=[exists T2_Sh]=>
 state_supplier_host(Sh,SMh,Sv,TA,PK_SMh,PK_Sh,PK_Sv,PK_TA,2,DEC_Sv,T1_SMh,T1_Sh,T2_Sh,T_Sv,C1_SMh,C1_Sh,crypt(PK_SMh,DEC_Sv),crypt(PK_Sh,DEC_Sv),REQ_SCv,Dummy_L,SID).
 iknows(pair(PK_Sh,pair(Sh,pair(crypt(inv(PK_TA),pair(PK_Sh,Sh)),pair(SMh,pair(crypt(PK_SMh,DEC_Sv),pair(T2_Sh,crypt(inv(PK_Sh),pair(SMh,pair(crypt(PK_SMh,DEC_Sv),T2_Sh)))))))))).
 witness(SMh,Sh,smh_auth_sh,T2_Sh).
 request(Sh,Sv,sh_auth_sv,T_Sv,SID).
 contains(T_Sv,Dummy_L)

step step_10 (Sv,SCv,EVSEh,SMh,Sh,TA,PK_Sh,PK_Sv,PK_TA,PK_SCv,K_SCvSv,Dummy_DEC_Sv,T1_SMh,Dummy_T1_Sh,T2_Sh,Dummy_T_Sv,Dummy_T_EVSEh,C1_SMh,Dummy_C1_Sh,C2_Sh,Dummy_C_Sv,Dummy_M_SCv,Dummy_C_SCv,Dummy_Sig_SCv,Dummy_REQ_SCv,H,Dummy_L,Dummy_PSD,Dummy_Set_149,SID,DEC_Sv,T1_Sh,T_Sv,T_EVSEh) :=
 state_supplier_visitor(Sv,SCv,EVSEh,SMh,Sh,TA,PK_Sh,PK_Sv,PK_TA,PK_SCv,K_SCvSv,0,Dummy_DEC_Sv,T1_SMh,Dummy_T1_Sh,T2_Sh,Dummy_T_Sv,Dummy_T_EVSEh,C1_SMh,Dummy_C1_Sh,C2_Sh,Dummy_C_Sv,Dummy_M_SCv,Dummy_C_SCv,Dummy_Sig_SCv,Dummy_REQ_SCv,H,Dummy_L,Dummy_PSD,Dummy_Set_149,SID).
 iknows(pair(PK_Sh,pair(Sh,pair(crypt(inv(PK_TA),pair(PK_Sh,Sh)),pair(Sv,pair(crypt(PK_Sv,pair(pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))),scrypt(K_SCvSv,pair(SCv,pair(PK_SCv,pair(crypt(inv(PK_TA),pair(SCv,PK_SCv)),crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))))))))))),pair(T1_Sh,crypt(inv(PK_Sh),pair(Sv,pair(crypt(PK_Sv,pair(pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))),scrypt(K_SCvSv,pair(SCv,pair(PK_SCv,pair(crypt(inv(PK_TA),pair(SCv,PK_SCv)),crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))))))))))),T1_Sh)))))))))).
 contains(psid1_EVv,Dummy_PSD) &
 not(contains(T1_Sh,Dummy_L))
=[exists T_Sv,DEC_Sv]=>
 state_supplier_visitor(Sv,SCv,EVSEh,SMh,Sh,TA,PK_Sh,PK_Sv,PK_TA,PK_SCv,K_SCvSv,1,DEC_Sv,T1_SMh,T1_Sh,T2_Sh,T_Sv,T_EVSEh,C1_SMh,crypt(PK_Sv,pair(pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))),scrypt(K_SCvSv,pair(SCv,pair(PK_SCv,pair(crypt(inv(PK_TA),pair(SCv,PK_SCv)),crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))))))))))),C2_Sh,crypt(PK_Sh,DEC_Sv),pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))),scrypt(K_SCvSv,pair(SCv,pair(PK_SCv,pair(crypt(inv(PK_TA),pair(SCv,PK_SCv)),crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))))))))),crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))))),pair(pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))),scrypt(K_SCvSv,pair(SCv,pair(PK_SCv,pair(crypt(inv(PK_TA),pair(SCv,PK_SCv)),crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh)))))))))),H,Dummy_L,Dummy_PSD,Dummy_Set_149,SID).
 iknows(pair(PK_Sv,pair(Sv,pair(crypt(inv(PK_TA),pair(PK_Sv,Sv)),pair(Sh,pair(crypt(PK_Sh,DEC_Sv),pair(T_Sv,crypt(inv(PK_Sv),pair(Sh,pair(crypt(PK_Sh,DEC_Sv),T_Sv)))))))))).
 secret(DEC_Sv,decsv,Dummy_Set_149).
 witness(Sv,Sh,sh_auth_sv,T_Sv).
 request(Sv,Sh,sv_auth_sh,T1_Sh,SID).
 request(Sv,SCv,sv_auth_scv,crypt(inv(PK_SCv),apply(H,pair(Sv,pair(psid1_EVv,pair(p_Sh,T_EVSEh))))),SID).
 contains(T1_Sh,Dummy_L).
 contains(EVSEh,Dummy_Set_149).
 contains(SMh,Dummy_Set_149).
 contains(Sh,Dummy_Set_149).
 contains(Sv,Dummy_Set_149)


section properties:

property authentication_on_sv_auth_scv (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,sv_auth_scv,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,sv_auth_scv,MGoal))
     /\ ((request(A1Goal,A2Goal,sv_auth_scv,MGoal,SID1)
           /\ request(A1Goal,A2Goal,sv_auth_scv,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_evseh_auth_smh (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,evseh_auth_smh,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,evseh_auth_smh,MGoal))
     /\ ((request(A1Goal,A2Goal,evseh_auth_smh,MGoal,SID1)
           /\ request(A1Goal,A2Goal,evseh_auth_smh,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_smh_auth_evseh (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,smh_auth_evseh,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,smh_auth_evseh,MGoal))
     /\ ((request(A1Goal,A2Goal,smh_auth_evseh,MGoal,SID1)
           /\ request(A1Goal,A2Goal,smh_auth_evseh,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_sh_auth_smh (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,sh_auth_smh,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,sh_auth_smh,MGoal))
     /\ ((request(A1Goal,A2Goal,sh_auth_smh,MGoal,SID1)
           /\ request(A1Goal,A2Goal,sh_auth_smh,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_smh_auth_sh (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,smh_auth_sh,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,smh_auth_sh,MGoal))
     /\ ((request(A1Goal,A2Goal,smh_auth_sh,MGoal,SID1)
           /\ request(A1Goal,A2Goal,smh_auth_sh,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_sv_auth_sh (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,sv_auth_sh,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,sv_auth_sh,MGoal))
     /\ ((request(A1Goal,A2Goal,sv_auth_sh,MGoal,SID1)
           /\ request(A1Goal,A2Goal,sv_auth_sh,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_sh_auth_sv (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,sh_auth_sv,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,sh_auth_sv,MGoal))
     /\ ((request(A1Goal,A2Goal,sh_auth_sv,MGoal,SID1)
           /\ request(A1Goal,A2Goal,sh_auth_sv,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property secrecy_of_decsv (MGoal,ASGoal) :=
 [] ((secret(MGoal,decsv,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_sigscv (MGoal,ASGoal) :=
 [] ((secret(MGoal,sigscv,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))


section attack_states:

attack_state authentication_on_sv_auth_scv (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,sv_auth_scv,MGoal,SID) &
 not(witness(A2Goal,A1Goal,sv_auth_scv,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_sv_auth_scv (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,sv_auth_scv,MGoal,SID1).
 request(A1Goal,A2Goal,sv_auth_scv,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_evseh_auth_smh (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,evseh_auth_smh,MGoal,SID) &
 not(witness(A2Goal,A1Goal,evseh_auth_smh,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_evseh_auth_smh (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,evseh_auth_smh,MGoal,SID1).
 request(A1Goal,A2Goal,evseh_auth_smh,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_smh_auth_evseh (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,smh_auth_evseh,MGoal,SID) &
 not(witness(A2Goal,A1Goal,smh_auth_evseh,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_smh_auth_evseh (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,smh_auth_evseh,MGoal,SID1).
 request(A1Goal,A2Goal,smh_auth_evseh,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_sh_auth_smh (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,sh_auth_smh,MGoal,SID) &
 not(witness(A2Goal,A1Goal,sh_auth_smh,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_sh_auth_smh (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,sh_auth_smh,MGoal,SID1).
 request(A1Goal,A2Goal,sh_auth_smh,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_smh_auth_sh (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,smh_auth_sh,MGoal,SID) &
 not(witness(A2Goal,A1Goal,smh_auth_sh,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_smh_auth_sh (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,smh_auth_sh,MGoal,SID1).
 request(A1Goal,A2Goal,smh_auth_sh,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_sv_auth_sh (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,sv_auth_sh,MGoal,SID) &
 not(witness(A2Goal,A1Goal,sv_auth_sh,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_sv_auth_sh (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,sv_auth_sh,MGoal,SID1).
 request(A1Goal,A2Goal,sv_auth_sh,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_sh_auth_sv (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,sh_auth_sv,MGoal,SID) &
 not(witness(A2Goal,A1Goal,sh_auth_sv,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_sh_auth_sv (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,sh_auth_sv,MGoal,SID1).
 request(A1Goal,A2Goal,sh_auth_sv,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state secrecy_of_decsv (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,decsv,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_sigscv (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,sigscv,ASGoal) &
 not(contains(i,ASGoal))

