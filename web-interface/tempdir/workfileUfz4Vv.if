%% IF specification of /home/avispa/web-interface-computation/./tempdir/workfileUfz4Vv

section signature:

state_user: agent * agent * agent * symmetric_key * symmetric_key * hash_func * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * hash_func * set(text) * set(text) * set(text) * set(text) * nat -> fact
state_scpc: agent * agent * agent * symmetric_key * symmetric_key * hash_func * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * hash_func * set(text) * set(text) * set(text) * nat -> fact
state_provider: agent * agent * agent * symmetric_key * symmetric_key * hash_func * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * hash_func * set(text) * set(text) * nat -> fact


section types:

MGoal, start: message
alice_bob_n1, bob_alice_n2, alice_bob_tj, subs1, subs2, subs3, subs4, subs5: protocol_id
Set_149, Set_148, Set_147, Set_146, Set_105, Set_104, Set_103, Set_60, Set_56, Dummy_Set_149, Dummy_Set_148, Dummy_Set_147, Dummy_Set_146, Dummy_Set_105, Dummy_Set_104, Dummy_Set_103, Dummy_Set_60, Dummy_Set_56: set(text)
f, bh, h, F, BH, H, dummy_hash: hash_func
sksui, skspj, SKsui, SKspj: symmetric_key
tj, qj, g, idj, k1, p, c1, ks, ids, idi, ri, req, n1, yj, xi, n2, k3, c2, rep, si, conf, k4, pwi, pwri, rbi, auth, zi, bi, Tj, Qj, G, IDj, K1, P, C1, Ks, IDs, IDi, Ri, Req, N1, Yj, Xi, N2, K3, C2, Rep, Si, Conf, K4, PWi, PWRi, RBi, Auth, Zi, Bi, Dummy_Auth, Dummy_K4, Dummy_K1, Dummy_RBi, Dummy_PWRi, Dummy_Conf, Dummy_Si, K2, Dummy_Zi, Dummy_Rep, Dummy_C2, Dummy_K3, Dummy_K2, Dummy_N2, Dummy_Xi, Dummy_Yj, Dummy_N1, Dummy_Ri, Dummy_C1, Dummy_Qj, Dummy_Tj, dummy_nonce: text
set_278, set_277, set_276, set_275, set_273, set_272, set_271, set_269, set_268, set_266, set_265, set_264, set_263, set_261, set_260, set_259, set_257, set_256, set_244, set_243, set_242, set_241, set_235, set_234, set_233, set_210, set_209: set
4, State, 13, 12, 11, 9, 3, 2, 8, 7, 1, 0, 5, SID, Dummy_State, SID2, SID1: nat
s, pj, ui, S, Pj, Ui, A2Goal, i, A1Goal: agent
ASGoal: set(agent)


section inits:

initial_state init1 := 
 iknows(start).
 iknows(s).
 iknows(pj).
 iknows(ui).
 iknows(h).
 iknows(bh).
 iknows(f).
 iknows(g).
 iknows(p).
 iknows(i).
 state_provider(pj,s,ui,skspj,sksui,h,bh,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,set_209,set_210,3).
 state_scpc(s,pj,ui,skspj,sksui,h,bh,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,set_233,set_234,set_235,4).
 state_user(ui,s,pj,skspj,sksui,h,bh,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,set_241,set_242,set_243,set_244,5).
 state_provider(pj,s,ui,skspj,sksui,h,bh,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,set_256,set_257,7).
 state_scpc(s,pj,ui,skspj,sksui,h,bh,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,set_259,set_260,set_261,8).
 state_user(ui,s,pj,skspj,sksui,h,bh,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,set_263,set_264,set_265,set_266,9).
 state_provider(pj,s,ui,skspj,sksui,h,bh,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,set_268,set_269,11).
 state_scpc(s,pj,ui,skspj,sksui,h,bh,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,set_271,set_272,set_273,12).
 state_user(ui,s,pj,skspj,sksui,h,bh,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,set_275,set_276,set_277,set_278,13)


section rules:

step step_0 (Pj,S,Ui,SKspj,SKsui,H,BH,Dummy_Tj,Dummy_Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Bi,Ri,Req,N1,Yj,Xi,N2,K2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Zi,F,Dummy_Set_56,Set_60,SID,Tj) :=
 state_provider(Pj,S,Ui,SKspj,SKsui,H,BH,0,Dummy_Tj,Dummy_Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Bi,Ri,Req,N1,Yj,Xi,N2,K2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Zi,F,Dummy_Set_56,Set_60,SID).
 iknows(start)
=[exists Tj]=>
 state_provider(Pj,S,Ui,SKspj,SKsui,H,BH,1,Tj,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))),G,IDj,K1,P,C1,Ks,IDs,IDi,Bi,Ri,Req,N1,Yj,Xi,N2,K2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Zi,F,Dummy_Set_56,Set_60,SID).
 iknows(scrypt(SKspj,pair(IDj,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G))))))).
 secret(Dummy_Set_56,subs5,Pj).
 witness(Pj,S,alice_bob_tj,Tj).
 contains(Tj,Dummy_Set_56)

step step_1 (Pj,S,Ui,SKspj,SKsui,H,BH,Tj,Qj,G,IDj,K1,P,Dummy_C1,Ks,IDs,IDi,Bi,Dummy_Ri,Req,Dummy_N1,Dummy_Yj,Dummy_Xi,Dummy_N2,Dummy_K2,Dummy_K3,Dummy_C2,Dummy_Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Dummy_Zi,F,Set_56,Dummy_Set_60,SID,Ri,N1,Yj,Xi,N2) :=
 state_provider(Pj,S,Ui,SKspj,SKsui,H,BH,1,Tj,Qj,G,IDj,K1,P,Dummy_C1,Ks,IDs,IDi,Bi,Dummy_Ri,Req,Dummy_N1,Dummy_Yj,Dummy_Xi,Dummy_N2,Dummy_K2,Dummy_K3,Dummy_C2,Dummy_Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Dummy_Zi,F,Set_56,Dummy_Set_60,SID).
 iknows(pair(scrypt(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(IDi,pair(apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)),pair(apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),N1)))),apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G))))))
=[exists N2,Yj]=>
 state_provider(Pj,S,Ui,SKspj,SKsui,H,BH,2,Tj,Qj,G,IDj,K1,P,scrypt(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(IDi,pair(apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)),pair(apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),N1)))),Ks,IDs,IDi,Bi,Ri,Req,N1,Yj,Xi,N2,apply(F,pair(Tj,pair(Xi,pair(Ks,pair(IDs,G))))),apply(F,pair(Yj,apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),scrypt(apply(F,pair(Yj,apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(N1,N2)),apply(H,pair(IDi,pair(IDj,pair(apply(F,pair(Yj,pair(Tj,pair(apply(F,pair(Tj,pair(Xi,pair(Ks,pair(IDs,G))))),pair(apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)))))),apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))))))))),pair(scrypt(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(IDi,pair(apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)),pair(apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),N1)))),pair(scrypt(apply(F,pair(Yj,apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(N1,N2)),pair(N1,pair(N2,pair(apply(F,pair(Tj,pair(Xi,pair(Ks,pair(IDs,G))))),apply(F,pair(Yj,apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G))))))))))))))),Si,Conf,K4,PWi,PWRi,RBi,Auth,apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),F,Set_56,Dummy_Set_60,SID).
 secret(Dummy_Set_60,subs3,S).
 iknows(pair(apply(H,pair(IDi,pair(IDj,pair(apply(F,pair(Yj,pair(Tj,pair(apply(F,pair(Tj,pair(Xi,pair(Ks,pair(IDs,G))))),pair(apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)))))),apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))))))))),pair(scrypt(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(IDi,pair(apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)),pair(apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),N1)))),pair(scrypt(apply(F,pair(Yj,apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(N1,N2)),pair(N1,pair(N2,pair(apply(F,pair(Tj,pair(Xi,pair(Ks,pair(IDs,G))))),apply(F,pair(Yj,apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G))))))))))))))),pair(scrypt(apply(F,pair(Yj,apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(N1,N2)),apply(F,pair(Yj,pair(Tj,pair(apply(F,pair(Tj,pair(Xi,pair(Ks,pair(IDs,G))))),pair(apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)))))),apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G))))))))))))))).
 witness(Pj,Ui,bob_alice_n2,N2).
 contains(Ks,Dummy_Set_60)

step step_2 (Pj,S,Ui,SKspj,SKsui,H,BH,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Bi,Dummy_Ri,Req,Dummy_N1,Dummy_Yj,Dummy_Xi,Dummy_N2,Dummy_K2,K3,C2,Rep,Dummy_Si,Dummy_Conf,K4,PWi,PWRi,RBi,Auth,Zi,F,Set_56,Set_60,SID,Ri,N1,Yj,Xi,N2,K2,Si) :=
 state_provider(Pj,S,Ui,SKspj,SKsui,H,BH,2,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Bi,Dummy_Ri,Req,Dummy_N1,Dummy_Yj,Dummy_Xi,Dummy_N2,Dummy_K2,K3,C2,Rep,Dummy_Si,Dummy_Conf,K4,PWi,PWRi,RBi,Auth,Zi,F,Set_56,Set_60,SID).
 iknows(apply(H,pair(IDi,pair(IDj,pair(N1,pair(N2,apply(F,pair(Si,pair(apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)))))),pair(Xi,apply(F,pair(Yj,pair(Tj,pair(K2,apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G))))))))))))))))))))
 =>
 state_provider(Pj,S,Ui,SKspj,SKsui,H,BH,3,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Bi,Ri,Req,N1,Yj,Xi,N2,K2,K3,C2,Rep,Si,apply(H,pair(IDi,pair(IDj,pair(apply(F,pair(Tj,pair(Xi,pair(Ks,pair(IDs,G))))),apply(F,pair(Yj,apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))))))),K4,PWi,PWRi,RBi,Auth,Zi,F,Set_56,Set_60,SID).
 iknows(apply(H,pair(IDi,pair(IDj,pair(apply(F,pair(Tj,pair(Xi,pair(Ks,pair(IDs,G))))),apply(F,pair(Yj,apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G))))))))))).
 request(Ui,Pj,alice_bob_n1,N1,SID)

step step_3 (S,Pj,Ui,SKspj,SKsui,H,BH,Dummy_Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Ri,Req,N1,Yj,Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Zi,Bi,F,Dummy_Set_103,Set_104,Set_105,SID,Tj) :=
 state_scpc(S,Pj,Ui,SKspj,SKsui,H,BH,0,Dummy_Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Ri,Req,N1,Yj,Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Zi,Bi,F,Dummy_Set_103,Set_104,Set_105,SID).
 iknows(scrypt(SKspj,pair(IDj,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))))
 =>
 state_scpc(S,Pj,Ui,SKspj,SKsui,H,BH,1,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Ri,Req,N1,Yj,Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Zi,Bi,F,Dummy_Set_103,Set_104,Set_105,SID).
 secret(Dummy_Set_103,subs1,Ui).
 contains(PWi,Dummy_Set_103).
 contains(Bi,Dummy_Set_103)

step step_4 (S,Pj,Ui,SKspj,SKsui,H,BH,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Dummy_Ri,Req,N1,Yj,Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Zi,Bi,F,Set_103,Dummy_Set_104,Dummy_Set_105,SID,Ri) :=
 state_scpc(S,Pj,Ui,SKspj,SKsui,H,BH,1,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Dummy_Ri,Req,N1,Yj,Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Zi,Bi,F,Set_103,Dummy_Set_104,Dummy_Set_105,SID).
 iknows(scrypt(SKsui,pair(IDi,pair(apply(H,pair(IDi,pair(apply(BH,Bi),Ri))),apply(H,pair(IDi,pair(PWi,Ri)))))))
 =>
 state_scpc(S,Pj,Ui,SKspj,SKsui,H,BH,2,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Ri,Req,N1,Yj,Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Zi,Bi,F,Set_103,Dummy_Set_104,Dummy_Set_105,SID).
 secret(Dummy_Set_104,subs2,Ui).
 secret(Dummy_Set_105,subs4,S).
 iknows(scrypt(SKsui,pair(xor(Si,apply(H,pair(IDi,pair(apply(H,pair(IDi,pair(apply(BH,Bi),Ri))),apply(H,pair(IDi,pair(PWi,Ri))))))),pair(apply(H,pair(Si,pair(apply(H,pair(IDi,pair(apply(BH,Bi),Ri))),apply(H,pair(IDi,pair(PWi,Ri)))))),pair(apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)),pair(apply(H,pair(IDi,pair(apply(BH,Bi),Ri))),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(H,pair(BH,P))))))))).
 request(Pj,S,alice_bob_tj,Tj,SID).
 contains(Ri,Dummy_Set_104).
 contains(Si,Dummy_Set_105)

step step_5 (Ui,S,Pj,SKspj,SKsui,H,BH,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Dummy_Ri,Req,N1,Yj,Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,Dummy_PWRi,Dummy_RBi,Auth,Zi,Bi,F,Dummy_Set_146,Set_147,Set_148,Set_149,SID,Ri) :=
 state_user(Ui,S,Pj,SKspj,SKsui,H,BH,0,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Dummy_Ri,Req,N1,Yj,Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,Dummy_PWRi,Dummy_RBi,Auth,Zi,Bi,F,Dummy_Set_146,Set_147,Set_148,Set_149,SID).
 iknows(start)
=[exists Ri]=>
 state_user(Ui,S,Pj,SKspj,SKsui,H,BH,1,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Ri,Req,N1,Yj,Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,apply(H,pair(IDi,pair(PWi,Ri))),apply(BH,pair(IDi,pair(Bi,Ri))),Auth,Zi,Bi,F,Dummy_Set_146,Set_147,Set_148,Set_149,SID).
 secret(Dummy_Set_146,subs1,Ui).
 iknows(scrypt(SKsui,pair(IDi,pair(apply(BH,pair(IDi,pair(Bi,Ri))),apply(H,pair(IDi,pair(PWi,Ri))))))).
 contains(PWi,Dummy_Set_146).
 contains(Bi,Dummy_Set_146)

step step_6 (Ui,S,Pj,SKspj,SKsui,H,BH,Tj,Qj,G,IDj,Dummy_K1,P,Dummy_C1,Ks,IDs,IDi,Dummy_Ri,Req,Dummy_N1,Yj,Dummy_Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Dummy_Zi,Bi,F,Set_146,Dummy_Set_147,Dummy_Set_148,Dummy_Set_149,SID,Ri,N1,Xi) :=
 state_user(Ui,S,Pj,SKspj,SKsui,H,BH,1,Tj,Qj,G,IDj,Dummy_K1,P,Dummy_C1,Ks,IDs,IDi,Dummy_Ri,Req,Dummy_N1,Yj,Dummy_Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Dummy_Zi,Bi,F,Set_146,Dummy_Set_147,Dummy_Set_148,Dummy_Set_149,SID).
 iknows(scrypt(SKsui,pair(xor(Si,apply(H,pair(IDi,pair(apply(H,pair(IDi,pair(apply(BH,Bi),Ri))),apply(H,pair(IDi,pair(PWi,Ri))))))),pair(apply(H,pair(Si,pair(apply(H,pair(IDi,pair(apply(BH,Bi),Ri))),apply(H,pair(IDi,pair(PWi,Ri)))))),pair(apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)),pair(apply(H,pair(IDi,pair(apply(BH,Bi),Ri))),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(H,pair(BH,P)))))))))
=[exists Xi,N1]=>
 state_user(Ui,S,Pj,SKspj,SKsui,H,BH,2,Tj,Qj,G,IDj,apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),P,scrypt(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(IDi,pair(apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)),pair(apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),N1)))),Ks,IDs,IDi,Ri,Req,N1,Yj,Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),Bi,F,Set_146,Dummy_Set_147,Dummy_Set_148,Dummy_Set_149,SID).
 secret(Dummy_Set_147,subs2,Ui).
 secret(Dummy_Set_148,subs4,S).
 iknows(pair(scrypt(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(IDi,pair(apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)),pair(apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),N1)))),apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))).
 secret(Dummy_Set_149,subs3,S).
 witness(Ui,Pj,alice_bob_n1,N1).
 contains(Ri,Dummy_Set_147).
 contains(Si,Dummy_Set_148).
 contains(Ks,Dummy_Set_149)

step step_7 (Ui,S,Pj,SKspj,SKsui,H,BH,Dummy_Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Dummy_Ri,Req,Dummy_N1,Dummy_Yj,Dummy_Xi,Dummy_N2,Dummy_K3,C2,Rep,Dummy_Si,Conf,Dummy_K4,PWi,PWRi,RBi,Dummy_Auth,Zi,Bi,F,Set_146,Set_147,Set_148,Set_149,SID,Tj,Ri,N1,Yj,Xi,N2,K3,Si) :=
 state_user(Ui,S,Pj,SKspj,SKsui,H,BH,2,Dummy_Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Dummy_Ri,Req,Dummy_N1,Dummy_Yj,Dummy_Xi,Dummy_N2,Dummy_K3,C2,Rep,Dummy_Si,Conf,Dummy_K4,PWi,PWRi,RBi,Dummy_Auth,Zi,Bi,F,Set_146,Set_147,Set_148,Set_149,SID).
 iknows(pair(apply(H,pair(IDi,pair(IDj,pair(apply(F,pair(Yj,pair(Dummy_Tj,pair(apply(F,pair(Tj,pair(Xi,pair(Ks,pair(IDs,G))))),pair(apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)))))),apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Dummy_Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),apply(F,pair(Dummy_Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))))))))),pair(scrypt(apply(F,pair(Xi,apply(F,pair(Dummy_Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(IDi,pair(apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)),pair(apply(F,pair(Dummy_Si,pair(apply(F,pair(Xi,apply(F,pair(Dummy_Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(Dummy_Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),N1)))),pair(scrypt(apply(F,pair(Yj,apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),N2),pair(N1,pair(N2,pair(apply(F,pair(Tj,pair(Xi,pair(Ks,pair(IDs,G))))),K3))))))))),pair(scrypt(apply(F,pair(Yj,apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),pair(N1,N2)),apply(F,pair(Yj,pair(Dummy_Tj,pair(apply(F,pair(Tj,pair(Xi,pair(Ks,pair(IDs,G))))),pair(apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)))))),apply(F,pair(Si,pair(apply(F,pair(Xi,apply(F,pair(Dummy_Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))),apply(F,pair(Dummy_Tj,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))))))))))))
 =>
 state_user(Ui,S,Pj,SKspj,SKsui,H,BH,3,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Ri,Req,N1,Yj,Xi,N2,K3,C2,Rep,Si,Conf,apply(F,pair(Si,pair(apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)))))),pair(Xi,apply(F,pair(Yj,pair(Dummy_Tj,pair(apply(F,pair(Dummy_Tj,pair(Xi,pair(Ks,pair(IDs,G))))),apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)))))))))))))),PWi,PWRi,RBi,apply(H,pair(IDi,pair(IDj,pair(N1,pair(N2,apply(F,pair(Si,pair(apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)))))),pair(Xi,apply(F,pair(Yj,pair(Dummy_Tj,pair(apply(F,pair(Dummy_Tj,pair(Xi,pair(Ks,pair(IDs,G))))),apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G))))))))))))))))))),Zi,Bi,F,Set_146,Set_147,Set_148,Set_149,SID).
 iknows(apply(H,pair(IDi,pair(IDj,pair(N1,pair(N2,apply(F,pair(Si,pair(apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G)))))),pair(Xi,apply(F,pair(Yj,pair(Dummy_Tj,pair(apply(F,pair(Dummy_Tj,pair(Xi,pair(Ks,pair(IDs,G))))),apply(H,pair(apply(F,pair(apply(H,Ks),G)),pair(apply(F,pair(apply(H,pair(Ks,IDs)),G)),pair(IDi,apply(F,pair(apply(H,pair(Ks,pair(IDs,pair(IDi,apply(H,pair(IDi,pair(apply(BH,Bi),Ri))))))),G))))))))))))))))))))

step step_8 (Ui,S,Pj,SKspj,SKsui,H,BH,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Ri,Req,N1,Dummy_Yj,Dummy_Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Zi,Bi,F,Set_146,Set_147,Set_148,Set_149,SID,Yj,Xi) :=
 state_user(Ui,S,Pj,SKspj,SKsui,H,BH,3,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Ri,Req,N1,Dummy_Yj,Dummy_Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Zi,Bi,F,Set_146,Set_147,Set_148,Set_149,SID).
 iknows(apply(H,pair(IDi,pair(IDj,pair(apply(F,pair(Tj,pair(Xi,pair(Ks,pair(IDs,G))))),apply(F,pair(Yj,apply(F,pair(Xi,apply(F,pair(apply(H,pair(Ks,IDs)),G)))))))))))
 =>
 state_user(Ui,S,Pj,SKspj,SKsui,H,BH,4,Tj,Qj,G,IDj,K1,P,C1,Ks,IDs,IDi,Ri,Req,N1,Yj,Xi,N2,K3,C2,Rep,Si,Conf,K4,PWi,PWRi,RBi,Auth,Zi,Bi,F,Set_146,Set_147,Set_148,Set_149,SID).
 request(Pj,Ui,bob_alice_n2,N2,SID)


section properties:

property secrecy_of_subs1 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs1,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs2 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs2,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs3 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs3,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs4 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs4,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs5 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs5,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property authentication_on_alice_bob_tj (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,alice_bob_tj,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,alice_bob_tj,MGoal))
     /\ ((request(A1Goal,A2Goal,alice_bob_tj,MGoal,SID1)
           /\ request(A1Goal,A2Goal,alice_bob_tj,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_alice_bob_n1 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,alice_bob_n1,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,alice_bob_n1,MGoal))
     /\ ((request(A1Goal,A2Goal,alice_bob_n1,MGoal,SID1)
           /\ request(A1Goal,A2Goal,alice_bob_n1,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_bob_alice_n2 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,bob_alice_n2,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,bob_alice_n2,MGoal))
     /\ ((request(A1Goal,A2Goal,bob_alice_n2,MGoal,SID1)
           /\ request(A1Goal,A2Goal,bob_alice_n2,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))


section attack_states:

attack_state secrecy_of_subs1 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs1,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs2 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs2,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs3 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs3,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs4 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs4,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs5 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs5,ASGoal) &
 not(contains(i,ASGoal))

attack_state authentication_on_alice_bob_tj (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,alice_bob_tj,MGoal,SID) &
 not(witness(A2Goal,A1Goal,alice_bob_tj,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_alice_bob_tj (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,alice_bob_tj,MGoal,SID1).
 request(A1Goal,A2Goal,alice_bob_tj,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_alice_bob_n1 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,alice_bob_n1,MGoal,SID) &
 not(witness(A2Goal,A1Goal,alice_bob_n1,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_alice_bob_n1 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,alice_bob_n1,MGoal,SID1).
 request(A1Goal,A2Goal,alice_bob_n1,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_bob_alice_n2 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,bob_alice_n2,MGoal,SID) &
 not(witness(A2Goal,A1Goal,bob_alice_n2,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_bob_alice_n2 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,bob_alice_n2,MGoal,SID1).
 request(A1Goal,A2Goal,bob_alice_n2,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

