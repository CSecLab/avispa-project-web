%% IF specification of /home/avispa/web-interface-computation/./tempdir/workfileLJDt8N

section signature:

state_bob: agent * agent * agent * symmetric_key * symmetric_key * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * set(text) * set(agent) * set(symmetric_key) * set(agent) * set(symmetric_key) * set(agent) * nat -> fact
state_bs: agent * agent * agent * symmetric_key * symmetric_key * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * set(text) * set(symmetric_key) * set(agent) * set(symmetric_key) * set(agent) * set(text) * set(agent) * nat -> fact
state_alice: agent * agent * agent * symmetric_key * symmetric_key * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * set(text) * set(symmetric_key) * set(agent) * set(symmetric_key) * set(agent) * set(text) * set(agent) * nat -> fact


section types:

alice_server, bs_bob, bob_alice, subs, sub3, sub1, sub2, sub4: protocol_id
Set_158, Set_156, Set_110, Set_108, Dummy_Set_158, Dummy_Set_156, Set_59, Dummy_Set_110, Set_57, Dummy_Set_108, Dummy_Set_59, Dummy_Set_57: set(symmetric_key)
Set_154, Set_112, Set_107, Dummy_Set_154, Set_65, Dummy_Set_112, Dummy_Set_107, Set_55, Dummy_Set_65, Dummy_Set_55: set(text)
set_306, set_305, set_304, set_303, set_302, set_301, set_299, set_298, set_297, set_296, set_295, set_294, set_293, set_291, set_290, set_289, set_288, set_287, set_286, set_285, set_273, set_272, set_271, set_270, set_269, set_268, set_253, set_252, set_251, set_250, set_249, set_248, set_247, set_226, set_225, set_224, set_223, set_222, set_221, set_220: set
State, 9, 8, 7, 5, SID, 3, 2, 1, 0, 4, Dummy_State, SID2, SID1: nat
h, H: hash_func
Set_159, Set_157, Set_155, Set_113, Set_111, Set_109, Dummy_Set_159, Dummy_Set_157, Dummy_Set_155, Set_66, Dummy_Set_113, Set_60, Dummy_Set_111, Set_58, Dummy_Set_109, Dummy_Set_66, Dummy_Set_60, Dummy_Set_58, ASGoal: set(agent)
start, MGoal: message
mkchi, skj, skubs, MKchi, SKj, SKubs: symmetric_key
uj, chi, Uj, CHi, BS, bs, A2Goal, A1Goal, i: agent
tbs, wchi, rpwj, pwj, ruj, sij, xj, pj, kiuj, nnj, g, njx, m, mj, aj, t1, bi, y, ks, k3, kij, ksj, IDj, IDsi, TSuj, Tuj, Tij, Tchi, TSchi, Tbs, Wchi, RPWj, PWj, Xj, Pj, Kiuj, Nnj, G, Njx, Mj, M, Aj, T1, Bi, Y, Ks, K3, Kij, Ksj, Sij, Ruj, Dummy_Ksj, Dummy_Kij, Dummy_K3, Dummy_T1, Dummy_Tbs, Dummy_Ruj, Dummy_Sij, Dummy_Aj, Dummy_TSchi, Dummy_Mj, Dummy_Njx, Dummy_Wchi, Dummy_Tchi, Dummy_Tuj, Dummy_TSuj, Dummy_Tij, Dummy_RPWj, dummy_nonce, idj, idsi, tsuj, tuj, tchi, tschi, tij: text


section inits:

initial_state init1 := 
 iknows(start).
 iknows(uj).
 iknows(chi).
 iknows(idsi).
 iknows(h).
 iknows(i).
 state_alice(uj,chi,bs,skubs,skj,mkchi,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_220,set_221,set_222,set_223,set_224,set_225,set_226,3).
 state_bs(bs,uj,chi,skubs,skj,mkchi,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_247,set_248,set_249,set_250,set_251,set_252,set_253,4).
 state_bob(chi,uj,bs,skubs,skj,mkchi,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_268,set_269,set_270,set_271,set_272,set_273,5).
 state_alice(uj,chi,bs,skubs,skj,mkchi,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_285,set_286,set_287,set_288,set_289,set_290,set_291,7).
 state_bs(bs,uj,chi,skubs,skj,mkchi,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_293,set_294,set_295,set_296,set_297,set_298,set_299,8).
 state_bob(chi,uj,bs,skubs,skj,mkchi,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_301,set_302,set_303,set_304,set_305,set_306,9)


section rules:

step step_0 (Uj,CHi,BS,SKubs,SKj,MKchi,H,IDj,IDsi,Tij,TSuj,Tuj,Tchi,TSchi,Tbs,Wchi,Dummy_RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,Aj,T1,Bi,Y,Ks,K3,Kij,Ksj,Sij,Ruj,Dummy_Set_55,Dummy_Set_57,Dummy_Set_58,Dummy_Set_59,Dummy_Set_60,Set_65,Set_66,SID) :=
 state_alice(Uj,CHi,BS,SKubs,SKj,MKchi,H,0,IDj,IDsi,Tij,TSuj,Tuj,Tchi,TSchi,Tbs,Wchi,Dummy_RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,Aj,T1,Bi,Y,Ks,K3,Kij,Ksj,Sij,Ruj,Dummy_Set_55,Dummy_Set_57,Dummy_Set_58,Dummy_Set_59,Dummy_Set_60,Set_65,Set_66,SID).
 iknows(start)
 =>
 state_alice(Uj,CHi,BS,SKubs,SKj,MKchi,H,1,IDj,IDsi,Tij,TSuj,Tuj,Tchi,TSchi,Tbs,Wchi,apply(H,pair(IDj,pair(Xj,PWj))),PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,Aj,T1,Bi,Y,Ks,K3,Kij,Ksj,Sij,Ruj,Dummy_Set_55,Dummy_Set_57,Dummy_Set_58,Dummy_Set_59,Dummy_Set_60,Set_65,Set_66,SID).
 iknows(pair(Uj,pair(BS,scrypt(SKubs,pair(IDj,pair(apply(H,pair(IDj,pair(Xj,PWj))),Xj)))))).
 secret(Dummy_Set_55,sub1,Uj).
 secret(Dummy_Set_59,subs,Dummy_Set_60).
 contains(PWj,Dummy_Set_55).
 contains(SKubs,Dummy_Set_57).
 contains(BS,Dummy_Set_58).
 contains(Uj,Dummy_Set_58).
 contains(SKj,Dummy_Set_59).
 contains(BS,Dummy_Set_60).
 contains(Uj,Dummy_Set_60)

step step_1 (Uj,CHi,BS,SKubs,SKj,MKchi,H,IDj,IDsi,Dummy_Tij,Dummy_TSuj,Dummy_Tuj,Dummy_Tchi,TSchi,Tbs,Dummy_Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Dummy_Njx,Dummy_Mj,M,Aj,T1,Bi,Y,Ks,K3,Kij,Ksj,Sij,Ruj,Set_55,Set_57,Set_58,Set_59,Set_60,Set_65,Set_66,SID,TSuj,Tuj,Tchi,Wchi) :=
 state_alice(Uj,CHi,BS,SKubs,SKj,MKchi,H,1,IDj,IDsi,Dummy_Tij,Dummy_TSuj,Dummy_Tuj,Dummy_Tchi,TSchi,Tbs,Dummy_Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Dummy_Njx,Dummy_Mj,M,Aj,T1,Bi,Y,Ks,K3,Kij,Ksj,Sij,Ruj,Set_55,Set_57,Set_58,Set_59,Set_60,Set_65,Set_66,SID).
 iknows(scrypt(SKubs,pair(IDj,pair(Dummy_TSuj,pair(Pj,pair(apply(H,pair(apply(H,pair(Xj,PWj)),apply(H,pair(IDj,TSuj)))),pair(Kiuj,pair(apply(H,pair(TSuj,xor(Tchi,Wchi))),IDsi))))))))
=[exists Tuj]=>
 state_alice(Uj,CHi,BS,SKubs,SKj,MKchi,H,2,IDj,IDsi,xor(Tuj,apply(H,pair(TSuj,xor(Tchi,Wchi)))),TSuj,Tuj,Tchi,TSchi,Tbs,Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,apply(H,pair(Nnj,G)),apply(H,pair(apply(H,pair(apply(H,pair(IDj,pair(Xj,PWj))),apply(H,pair(IDj,TSuj)))),pair(Tuj,apply(H,pair(Nnj,G))))),M,Aj,T1,Bi,Y,Ks,K3,Kij,Ksj,Sij,Ruj,Set_55,Set_57,Set_58,Set_59,Set_60,Set_65,Set_66,SID).
 iknows(pair(apply(H,pair(Nnj,G)),scrypt(SKj,pair(IDj,pair(IDsi,pair(xor(Tuj,apply(H,pair(TSuj,xor(Tchi,Wchi)))),apply(H,pair(apply(H,pair(apply(H,pair(IDj,pair(Xj,PWj))),apply(H,pair(IDj,TSuj)))),pair(Tuj,apply(H,pair(Nnj,G))))))))))).
 witness(Uj,BS,alice_server,Tuj)

step step_2 (Uj,CHi,BS,SKubs,SKj,MKchi,H,IDj,IDsi,Tij,TSuj,Tuj,Dummy_Tchi,Dummy_TSchi,Tbs,Dummy_Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,Aj,T1,Bi,Y,Ks,K3,Kij,Ksj,Sij,Ruj,Set_55,Set_57,Set_58,Set_59,Set_60,Dummy_Set_65,Dummy_Set_66,SID,Tchi,TSchi,Wchi) :=
 state_alice(Uj,CHi,BS,SKubs,SKj,MKchi,H,2,IDj,IDsi,Tij,TSuj,Tuj,Dummy_Tchi,Dummy_TSchi,Tbs,Dummy_Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,Aj,T1,Bi,Y,Ks,K3,Kij,Ksj,Sij,Ruj,Set_55,Set_57,Set_58,Set_59,Set_60,Dummy_Set_65,Dummy_Set_66,SID).
 iknows(pair(IDsi,pair(scrypt(apply(H,pair(Ks,pair(apply(H,pair(IDj,pair(IDsi,pair(Tuj,pair(apply(H,pair(Nnj,G)),Dummy_Tchi))))),apply(H,pair(Bi,Y))))),M),pair(TSchi,pair(xor(Tchi,Wchi),pair(Dummy_Tchi,apply(H,pair(IDj,pair(IDsi,pair(TSchi,scrypt(apply(H,pair(Ks,pair(apply(H,pair(IDj,pair(IDsi,pair(Tuj,pair(apply(H,pair(Nnj,G)),Dummy_Tchi))))),apply(H,pair(Bi,Y))))),M)))))))))))
 =>
 state_alice(Uj,CHi,BS,SKubs,SKj,MKchi,H,3,IDj,IDsi,Tij,TSuj,Tuj,Tchi,TSchi,Tbs,Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,Aj,T1,Bi,Y,Ks,K3,Kij,Ksj,Sij,Ruj,Set_55,Set_57,Set_58,Set_59,Set_60,Dummy_Set_65,Dummy_Set_66,SID).
 request(CHi,Uj,bob_alice,TSchi,SID).
 contains(Bi,Dummy_Set_65).
 contains(Y,Dummy_Set_65).
 contains(BS,Dummy_Set_66).
 contains(CHi,Dummy_Set_66)

step step_3 (BS,Uj,CHi,SKubs,SKj,MKchi,H,IDj,IDsi,Dummy_TSuj,Dummy_Tchi,Tij,Tuj,TSchi,Tbs,Dummy_Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,Dummy_Aj,T1,Bi,Y,Ks,K3,Kij,Ksj,Dummy_Sij,Dummy_Ruj,Dummy_Set_107,Dummy_Set_108,Dummy_Set_109,Dummy_Set_110,Dummy_Set_111,Dummy_Set_112,Dummy_Set_113,SID,TSuj,Tchi,Wchi) :=
 state_bs(BS,Uj,CHi,SKubs,SKj,MKchi,H,0,IDj,IDsi,Dummy_TSuj,Dummy_Tchi,Tij,Tuj,TSchi,Tbs,Dummy_Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,Dummy_Aj,T1,Bi,Y,Ks,K3,Kij,Ksj,Dummy_Sij,Dummy_Ruj,Dummy_Set_107,Dummy_Set_108,Dummy_Set_109,Dummy_Set_110,Dummy_Set_111,Dummy_Set_112,Dummy_Set_113,SID).
 iknows(pair(Uj,pair(BS,scrypt(SKubs,pair(IDj,pair(apply(H,pair(IDj,pair(Xj,PWj))),Xj))))))
=[exists Wchi,Tchi,TSuj]=>
 state_bs(BS,Uj,CHi,SKubs,SKj,MKchi,H,1,IDj,IDsi,TSuj,Tchi,Tij,Tuj,TSchi,Tbs,Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,apply(H,pair(IDj,TSuj)),T1,Bi,Y,Ks,K3,Kij,Ksj,apply(H,pair(TSuj,xor(Tchi,Wchi))),apply(H,pair(apply(H,pair(IDj,pair(Xj,PWj))),apply(H,pair(IDj,TSuj)))),Dummy_Set_107,Dummy_Set_108,Dummy_Set_109,Dummy_Set_110,Dummy_Set_111,Dummy_Set_112,Dummy_Set_113,SID).
 secret(Dummy_Set_107,sub1,Uj).
 secret(Dummy_Set_110,subs,Dummy_Set_111).
 iknows(scrypt(SKubs,pair(IDj,pair(TSuj,pair(Pj,pair(apply(H,pair(apply(H,pair(IDj,pair(Xj,PWj))),apply(H,pair(IDj,TSuj)))),pair(Kiuj,pair(apply(H,pair(TSuj,xor(Tchi,Wchi))),IDsi)))))))).
 contains(PWj,Dummy_Set_107).
 contains(SKubs,Dummy_Set_108).
 contains(BS,Dummy_Set_109).
 contains(Uj,Dummy_Set_109).
 contains(SKj,Dummy_Set_110).
 contains(BS,Dummy_Set_111).
 contains(Uj,Dummy_Set_111).
 contains(Bi,Dummy_Set_112).
 contains(Y,Dummy_Set_112).
 contains(BS,Dummy_Set_113).
 contains(CHi,Dummy_Set_113)

step step_4 (BS,Uj,CHi,SKubs,SKj,MKchi,H,IDj,IDsi,Dummy_TSuj,Dummy_Tchi,Tij,Dummy_Tuj,TSchi,Dummy_Tbs,Dummy_Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Dummy_Njx,Mj,M,Aj,Dummy_T1,Bi,Y,Ks,K3,Kij,Ksj,Sij,Ruj,Set_107,Set_108,Set_109,Set_110,Set_111,Set_112,Set_113,SID,TSuj,Tchi,Tuj,Tbs,Wchi,Njx) :=
 state_bs(BS,Uj,CHi,SKubs,SKj,MKchi,H,1,IDj,IDsi,Dummy_TSuj,Dummy_Tchi,Tij,Dummy_Tuj,TSchi,Dummy_Tbs,Dummy_Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Dummy_Njx,Mj,M,Aj,Dummy_T1,Bi,Y,Ks,K3,Kij,Ksj,Sij,Ruj,Set_107,Set_108,Set_109,Set_110,Set_111,Set_112,Set_113,SID).
 iknows(pair(apply(H,pair(Nnj,G)),scrypt(SKj,pair(IDsi,pair(xor(Tuj,apply(H,pair(TSuj,xor(Tchi,Wchi)))),apply(H,pair(apply(H,pair(apply(H,pair(IDj,pair(Xj,PWj))),apply(H,pair(IDj,TSuj)))),pair(Tuj,Njx))))))))
=[exists Tbs]=>
 state_bs(BS,Uj,CHi,SKubs,SKj,MKchi,H,2,IDj,IDsi,TSuj,Tchi,Tij,Tuj,TSchi,Tbs,Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,Aj,apply(H,pair(Tuj,Tbs)),Bi,Y,Ks,K3,Kij,Ksj,Sij,Ruj,Set_107,Set_108,Set_109,Set_110,Set_111,Set_112,Set_113,SID).
 iknows(scrypt(MKchi,pair(IDj,pair(IDsi,pair(xor(Tuj,apply(H,pair(TSuj,xor(Tchi,Wchi)))),pair(Tbs,pair(apply(H,pair(Nnj,G)),pair(apply(H,pair(Tuj,Tbs)),Tchi)))))))).
 witness(BS,CHi,bs_bob,Tbs).
 request(Uj,BS,alice_server,Tuj,SID)

step step_5 (CHi,Uj,BS,SKubs,SKj,MKchi,H,IDj,IDsi,Dummy_TSuj,Dummy_Tuj,Tij,Dummy_Tchi,Dummy_TSchi,Dummy_Tbs,Dummy_Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,Aj,T1,Bi,Y,Ks,Dummy_K3,Dummy_Kij,Dummy_Ksj,Sij,Ruj,Dummy_Set_154,Dummy_Set_155,Dummy_Set_156,Dummy_Set_157,Dummy_Set_158,Dummy_Set_159,SID,TSuj,Tuj,Tchi,TSchi,Tbs,Wchi) :=
 state_bob(CHi,Uj,BS,SKubs,SKj,MKchi,H,0,IDj,IDsi,Dummy_TSuj,Dummy_Tuj,Tij,Dummy_Tchi,Dummy_TSchi,Dummy_Tbs,Dummy_Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,Aj,T1,Bi,Y,Ks,Dummy_K3,Dummy_Kij,Dummy_Ksj,Sij,Ruj,Dummy_Set_154,Dummy_Set_155,Dummy_Set_156,Dummy_Set_157,Dummy_Set_158,Dummy_Set_159,SID).
 iknows(scrypt(MKchi,pair(IDj,pair(IDsi,pair(xor(Tuj,apply(H,pair(TSuj,xor(Tchi,Wchi)))),pair(Tbs,pair(apply(H,pair(Nnj,G)),pair(apply(H,pair(Tuj,Tbs)),Tchi))))))))
=[exists TSchi]=>
 state_bob(CHi,Uj,BS,SKubs,SKj,MKchi,H,1,IDj,IDsi,TSuj,Tuj,Tij,Tchi,TSchi,Tbs,Wchi,RPWj,PWj,Xj,Pj,Kiuj,Nnj,G,Njx,Mj,M,Aj,T1,Bi,Y,Ks,apply(H,pair(Bi,Y)),apply(H,pair(IDj,pair(IDsi,pair(Tuj,pair(apply(H,pair(Nnj,G)),Tchi))))),apply(H,pair(Ks,pair(apply(H,pair(IDj,pair(IDsi,pair(Tuj,pair(apply(H,pair(Nnj,G)),Tchi))))),apply(H,pair(Bi,Y))))),Sij,Ruj,Dummy_Set_154,Dummy_Set_155,Dummy_Set_156,Dummy_Set_157,Dummy_Set_158,Dummy_Set_159,SID).
 secret(PWj,sub1,Uj).
 secret(Dummy_Set_158,subs,Dummy_Set_159).
 request(BS,CHi,bs_bob,Tbs,SID).
 iknows(pair(IDsi,pair(scrypt(apply(H,pair(Ks,pair(apply(H,pair(IDj,pair(IDsi,pair(Tuj,pair(apply(H,pair(Nnj,G)),Tchi))))),apply(H,pair(Bi,Y))))),M),pair(TSchi,pair(xor(Tchi,Wchi),pair(Dummy_Tchi,apply(H,pair(IDj,pair(IDsi,pair(TSchi,scrypt(apply(H,pair(Ks,pair(apply(H,pair(IDj,pair(IDsi,pair(Tuj,pair(apply(H,pair(Nnj,G)),Tchi))))),apply(H,pair(Bi,Y))))),M))))))))))).
 witness(CHi,Uj,bob_alice,TSchi).
 contains(Bi,Dummy_Set_154).
 contains(Y,Dummy_Set_154).
 contains(BS,Dummy_Set_155).
 contains(CHi,Dummy_Set_155).
 contains(SKubs,Dummy_Set_156).
 contains(BS,Dummy_Set_157).
 contains(Uj,Dummy_Set_157).
 contains(SKj,Dummy_Set_158).
 contains(BS,Dummy_Set_159).
 contains(Uj,Dummy_Set_159)


section properties:

property secrecy_of_subs (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_sub1 (MGoal,ASGoal) :=
 [] ((secret(MGoal,sub1,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs2 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs2,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs3 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs3,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs4 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs4,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property authentication_on_alice_server (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,alice_server,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,alice_server,MGoal))
     /\ ((request(A1Goal,A2Goal,alice_server,MGoal,SID1)
           /\ request(A1Goal,A2Goal,alice_server,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_bs_bob (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,bs_bob,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,bs_bob,MGoal))
     /\ ((request(A1Goal,A2Goal,bs_bob,MGoal,SID1)
           /\ request(A1Goal,A2Goal,bs_bob,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_bob_alice (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,bob_alice,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,bob_alice,MGoal))
     /\ ((request(A1Goal,A2Goal,bob_alice,MGoal,SID1)
           /\ request(A1Goal,A2Goal,bob_alice,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))


section attack_states:

attack_state secrecy_of_subs (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_sub1 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,sub1,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs2 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs2,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs3 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs3,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs4 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs4,ASGoal) &
 not(contains(i,ASGoal))

attack_state authentication_on_alice_server (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,alice_server,MGoal,SID) &
 not(witness(A2Goal,A1Goal,alice_server,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_alice_server (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,alice_server,MGoal,SID1).
 request(A1Goal,A2Goal,alice_server,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_bs_bob (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,bs_bob,MGoal,SID) &
 not(witness(A2Goal,A1Goal,bs_bob,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_bs_bob (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,bs_bob,MGoal,SID1).
 request(A1Goal,A2Goal,bs_bob,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_bob_alice (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,bob_alice,MGoal,SID) &
 not(witness(A2Goal,A1Goal,bob_alice,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_bob_alice (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,bob_alice,MGoal,SID1).
 request(A1Goal,A2Goal,bob_alice,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

