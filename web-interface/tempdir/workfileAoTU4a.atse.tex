\documentclass[landscape]{article}
\usepackage{msc}
\usepackage{pslatex}

\begin{document}
\pagestyle{empty}

\sffamily
\footnotesize

\definecolor{darkgreen}{rgb}{0.30,0.60,0.00}
\definecolor{darkgray}{rgb}{0.30,0.30,0.30}
\definecolor{darkyellow}{rgb}{0.80,0.80,0.00}
\definecolor{darkcyan}{rgb}{0.00,0.50,0.50}

\enlargethispage{100cm}

\begin{msc}{ATTACK TRACE}

\setlength{\levelheight}{0.65cm}
\setlength{\instdist}{3.2cm}

\declinst{a0}{\textcolor{red}{Agent}}{\textcolor{red}{i}}
\declinst{a1}{\textcolor{blue}{Agent}}{\textcolor{blue}{(p,11)}}
\declinst{a2}{\textcolor{darkgreen}{Agent}}{\textcolor{darkgreen}{(c,3)}}
\declinst{a3}{\textcolor{darkgray}{Agent}}{\textcolor{darkgray}{(m,10)}}
\declinst{a4}{\textcolor{magenta}{Agent}}{\textcolor{magenta}{(b,14)}}
\declinst{a5}{\textcolor{darkcyan}{Agent}}{\textcolor{darkcyan}{(c,13)}}
\declinst{a6}{\textcolor{darkyellow}{Agent}}{\textcolor{darkyellow}{(b,4)}}
\declinst{a7}{\textcolor{}{Agent}}{\textcolor{}{(p,16)}}
\declinst{a8}{\textcolor{}{Agent}}{\textcolor{}{(m,5)}}
\declinst{a9}{\textcolor{}{Agent}}{\textcolor{}{(p,6)}}
\declinst{a10}{\textcolor{}{Agent}}{\textcolor{}{(c,8)}}
\mess{\textcolor{red}{\{TICKETID(49).\{DigMoney(32)\}\_(inv(sign\_i)).SessionKeyCP(49)\}\_sign\_p}}{a0}{a1}
\nextlevel
\mess{\textcolor{blue}{\{TICKETID(49).\{\{\{DigMoney(32)\}\_(inv(sign\_i))\}\_n49(PIN)\}\_n49(OTP).\{\{n49(PIN)\}\_(inv(sign\_p))\}\_sign\_c\}\_SessionKeyCP(49)}}{a1}{a0}
\nextlevel
\mess{\textcolor{red}{start}}{a0}{a2}
\nextlevel
\mess{\textcolor{darkgreen}{\{n1(TransID).n1(ServID).n1(ItemID).n1(N1).n1(SessionKeyCM)\}\_sign\_m}}{a2}{a0}
\nextlevel
\mess{\textcolor{red}{\{TransID(30).ServID(39).ItemID(39).N1(39).SessionKeyCM(39)\}\_sign\_m}}{a0}{a3}
\nextlevel
\mess{\textcolor{darkgray}{\{TransID(30).n39(TOKENID).dummy\_nonce.\{dummy\_nonce\}\_sign\_i.\{\{TransID(30).dummy\_nonce.dummy\_nonce\}\_h\}\_(inv(sign\_m))\}\_SessionKeyCM(39)}}{a3}{a0}
\nextlevel
\mess{\textcolor{red}{\{TransID(30).TOKENID(2).dummy\_nonce.\{dummy\_nonce\}\_sign\_b.\{\{TransID(30).dummy\_nonce.dummy\_nonce\}\_h\}\_(inv(sign\_m))\}\_SessionKeyCM(2)}}{a0}{a2}
\nextlevel
\mess{\textcolor{darkgreen}{\{dummy\_nonce.dummy\_nonce.\{dummy\_nonce\}\_sign\_b.n2(SessionKeyCB)\}\_masterkeycb}}{a2}{a0}
\nextlevel
\mess{\textcolor{red}{\{dummy\_nonce.dummy\_nonce.\{dummy\_nonce\}\_sign\_b.n2(SessionKeyCB)\}\_masterkeycb}}{a0}{a4}
\nextlevel
\mess{\textcolor{magenta}{\{n63(TICKETID).\{n63(DigMoney)\}\_(inv(sign\_b))\}\_n2(SessionKeyCB)}}{a4}{a0}
\nextlevel
\mess{\textcolor{red}{start}}{a0}{a5}
\nextlevel
\mess{\textcolor{darkcyan}{\{n53(TransID).n53(ServID).n53(ItemID).n53(N1).n53(SessionKeyCM)\}\_sign\_i}}{a5}{a0}
\nextlevel
\mess{\textcolor{red}{\{TransID(30).TOKENID(54).dummy\_nonce.\{dummy\_nonce\}\_sign\_b.\{\{TransID(30).dummy\_nonce.dummy\_nonce\}\_h\}\_(inv(sign\_i))\}\_SessionKeyCM(54)}}{a0}{a5}
\nextlevel
\mess{\textcolor{darkcyan}{\{dummy\_nonce.dummy\_nonce.\{dummy\_nonce\}\_sign\_b.n54(SessionKeyCB)\}\_masterkeycb}}{a5}{a0}
\nextlevel
\mess{\textcolor{red}{\{dummy\_nonce.dummy\_nonce.\{dummy\_nonce\}\_sign\_b.n54(SessionKeyCB)\}\_masterkeycb}}{a0}{a6}
\nextlevel
\mess{\textcolor{darkyellow}{\{n11(TICKETID).\{n11(DigMoney)\}\_(inv(sign\_b))\}\_n54(SessionKeyCB)}}{a6}{a0}
\nextlevel
\mess{\textcolor{red}{\{n63(TICKETID).\{n63(DigMoney)\}\_(inv(sign\_b))\}\_n2(SessionKeyCB)}}{a0}{a2}
\nextlevel
\mess{\textcolor{darkgreen}{\{n63(TICKETID).\{n63(DigMoney)\}\_(inv(sign\_b)).n3(SessionKeyCP)\}\_sign\_p}}{a2}{a0}
\nextlevel
\mess{\textcolor{red}{\{n63(TICKETID).\{n63(DigMoney)\}\_(inv(sign\_b)).n3(SessionKeyCP)\}\_sign\_p}}{a0}{a7}
\nextlevel
\mess{\textcolor{}{\{n63(TICKETID).\{\{\{n63(DigMoney)\}\_(inv(sign\_b))\}\_n67(PIN)\}\_n67(OTP).\{\{n67(PIN)\}\_(inv(sign\_p))\}\_sign\_c\}\_n3(SessionKeyCP)}}{a7}{a0}
\nextlevel
\mess{\textcolor{red}{\{n63(TICKETID).\{\{\{n63(DigMoney)\}\_(inv(sign\_b))\}\_n67(PIN)\}\_n67(OTP).\{\{n67(PIN)\}\_(inv(sign\_p))\}\_sign\_c\}\_n3(SessionKeyCP)}}{a0}{a2}
\nextlevel
\mess{\textcolor{darkgreen}{\{TOKENID(2).dummy\_nonce.dummy\_nonce.n63(TICKETID).\{\{\{n63(DigMoney)\}\_(inv(sign\_b))\}\_n67(PIN)\}\_n67(OTP).\{dummy\_sk\}\_h\}\_SessionKeyCM(2)}}{a2}{a0}
\nextlevel
\mess{\textcolor{red}{()}}{a0}{a2}
\nextlevel
\mess{\textcolor{darkgreen}{\{\{n67(PIN)\}\_(inv(sign\_c))\}\_SessionKeyCM(2)}}{a2}{a0}
\nextlevel
\mess{\textcolor{red}{\{n11(TICKETID).\{n11(DigMoney)\}\_(inv(sign\_b))\}\_n54(SessionKeyCB)}}{a0}{a5}
\nextlevel
\mess{\textcolor{darkcyan}{\{n11(TICKETID).\{n11(DigMoney)\}\_(inv(sign\_b)).n55(SessionKeyCP)\}\_sign\_p}}{a5}{a0}
\nextlevel
\mess{\textcolor{red}{\{TransID(15).ServID(15).ItemID(15).N1(15).SessionKeyCM(15)\}\_sign\_m}}{a0}{a8}
\nextlevel
\mess{\textcolor{}{\{TransID(15).n15(TOKENID).dummy\_nonce.\{dummy\_nonce\}\_sign\_b.\{\{TransID(15).dummy\_nonce.dummy\_nonce\}\_h\}\_(inv(sign\_m))\}\_SessionKeyCM(15)}}{a8}{a0}
\nextlevel
\mess{\textcolor{red}{\{n63(TICKETID).\{\{\{n63(DigMoney)\}\_(inv(sign\_b))\}\_n67(PIN)\}\_n67(OTP).\{\{n67(PIN)\}\_(inv(sign\_p))\}\_sign\_c\}\_n3(SessionKeyCP)}}{a0}{a5}
\nextlevel
\mess{\textcolor{darkcyan}{\{TOKENID(54).dummy\_nonce.dummy\_nonce.n63(TICKETID).\{\{\{n63(DigMoney)\}\_(inv(sign\_b))\}\_n67(PIN)\}\_n67(OTP).\{dummy\_sk\}\_h\}\_SessionKeyCM(54)}}{a5}{a0}
\nextlevel
\mess{\textcolor{red}{()}}{a0}{a5}
\nextlevel
\mess{\textcolor{darkcyan}{\{\{n67(PIN)\}\_(inv(sign\_c))\}\_SessionKeyCM(54)}}{a5}{a0}
\nextlevel
\mess{\textcolor{red}{\{n15(TOKENID).dummy\_nonce.dummy\_nonce.n63(TICKETID).\{\{\{n63(DigMoney)\}\_(inv(sign\_b))\}\_n67(PIN)\}\_n67(OTP).\{dummy\_sk\}\_h\}\_SessionKeyCM(15)}}{a0}{a8}
\nextlevel
\mess{\textcolor{}{\{dummy\_nat.n16(SessionKeyMP)\}\_sign\_p}}{a8}{a0}
\nextlevel
\mess{\textcolor{red}{\{dummy\_nat.n16(SessionKeyMP)\}\_sign\_p}}{a0}{a7}
\nextlevel
\mess{\textcolor{}{\{n63(TICKETID).\{n67(OTP)\}\_(inv(sign\_p))\}\_n16(SessionKeyMP)}}{a7}{a0}
\nextlevel
\mess{\textcolor{red}{\{n63(TICKETID).\{n67(OTP)\}\_(inv(sign\_p))\}\_n16(SessionKeyMP)}}{a0}{a8}
\nextlevel
\mess{\textcolor{}{()}}{a8}{a0}
\nextlevel
\mess{\textcolor{red}{\{TICKETID(18).\{n67(PIN)\}\_(inv(sign\_c))\}\_SessionKeyCM(15)}}{a0}{a8}
\nextlevel
\mess{\textcolor{}{\{n63(TICKETID).\{n63(DigMoney)\}\_(inv(sign\_b))\}\_masterkeymb}}{a8}{a0}
\nextlevel
\mess{\textcolor{red}{\{dummy\_nat.n16(SessionKeyMP)\}\_sign\_p}}{a0}{a1}
\nextlevel
\mess{\textcolor{blue}{\{TICKETID(49).\{n49(OTP)\}\_(inv(sign\_p))\}\_n16(SessionKeyMP)}}{a1}{a0}
\nextlevel
\mess{\textcolor{red}{\{n11(TICKETID).\{n11(DigMoney)\}\_(inv(sign\_b)).n55(SessionKeyCP)\}\_sign\_p}}{a0}{a9}
\nextlevel
\mess{\textcolor{}{\{n11(TICKETID).\{\{\{n11(DigMoney)\}\_(inv(sign\_b))\}\_n25(PIN)\}\_n25(OTP).\{\{n25(PIN)\}\_(inv(sign\_p))\}\_sign\_c\}\_n55(SessionKeyCP)}}{a9}{a0}
\nextlevel
\mess{\textcolor{red}{\{n39(TOKENID).dummy\_nonce.dummy\_nonce.TICKETID(40).\{\{\{DigMoney(32)\}\_(inv(sign\_i))\}\_n49(PIN)\}\_n49(OTP).\{dummy\_sk\}\_h\}\_SessionKeyCM(39)}}{a0}{a3}
\nextlevel
\mess{\textcolor{darkgray}{\{dummy\_nat.n40(SessionKeyMP)\}\_sign\_p}}{a3}{a0}
\nextlevel
\mess{\textcolor{red}{\{dummy\_nat.n40(SessionKeyMP)\}\_sign\_p}}{a0}{a9}
\nextlevel
\mess{\textcolor{}{\{n11(TICKETID).\{n25(OTP)\}\_(inv(sign\_p))\}\_n40(SessionKeyMP)}}{a9}{a0}
\nextlevel
\mess{\textcolor{red}{start}}{a0}{a10}
\nextlevel
\mess{\textcolor{}{\{n29(TransID).n29(ServID).n29(ItemID).n29(N1).n29(SessionKeyCM)\}\_sign\_m}}{a10}{a0}
\nextlevel
\mess{\textcolor{red}{\{TransID(30).TOKENID(30).dummy\_nonce.\{dummy\_nonce\}\_sign\_i.\{\{TransID(30).dummy\_nonce.dummy\_nonce\}\_h\}\_(inv(sign\_m))\}\_SessionKeyCM(30)}}{a0}{a10}
\nextlevel
\mess{\textcolor{}{\{dummy\_nonce.dummy\_nonce.\{dummy\_nonce\}\_sign\_i.n30(SessionKeyCB)\}\_masterkeycb}}{a10}{a0}
\nextlevel
\mess{\textcolor{red}{\{TICKETID(31).\{DigMoney(31)\}\_(inv(sign\_i))\}\_SessionKeyCB(31)}}{a0}{a10}
\nextlevel
\mess{\textcolor{}{\{TICKETID(31).\{DigMoney(31)\}\_(inv(sign\_i)).n31(SessionKeyCP)\}\_sign\_p}}{a10}{a0}
\nextlevel
\mess{\textcolor{red}{\{TICKETID(32).\{\{\{DigMoney(32)\}\_(inv(sign\_i))\}\_n49(PIN)\}\_n49(OTP).\{\{n49(PIN)\}\_(inv(sign\_p))\}\_sign\_c\}\_SessionKeyCP(32)}}{a0}{a10}
\nextlevel
\mess{\textcolor{}{\{TOKENID(30).dummy\_nonce.dummy\_nonce.TICKETID(32).\{\{\{DigMoney(32)\}\_(inv(sign\_i))\}\_n49(PIN)\}\_n49(OTP).\{dummy\_sk\}\_h\}\_SessionKeyCM(30)}}{a10}{a0}
\nextlevel
\mess{\textcolor{red}{()}}{a0}{a10}
\nextlevel
\mess{\textcolor{}{\{\{n49(PIN)\}\_(inv(sign\_c))\}\_SessionKeyCM(30)}}{a10}{a0}
\nextlevel
\end{msc}
\end{document}
