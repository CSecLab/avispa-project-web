%% IF specification of /home/avispa/web-interface-computation/./tempdir/workfileJTffC8KA4P

section signature:

state_regis: agent * agent * agent * agent * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * message * message * message * message * message * message * message * message * message * message * hash_func * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * nat -> fact
state_snode: agent * agent * agent * agent * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * message * message * message * message * message * message * message * message * message * message * hash_func * set(text) * set(agent) * nat -> fact
state_gateway: agent * agent * agent * agent * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * message * message * message * message * message * message * message * message * message * message * hash_func * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * nat -> fact
state_user: agent * agent * agent * agent * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * message * message * message * message * message * message * message * message * message * message * hash_func * set(text) * set(text) * set(agent) * nat -> fact


section types:

Dummy_Set_132, Dummy_Set_130, Dummy_Set_128, Dummy_Set_126, Dummy_Set_124, Dummy_Set_122, Dummy_Set_120, Dummy_Set_234, Dummy_Set_185, Dummy_Set_182, Dummy_Set_180, Dummy_Set_70, ASGoal, Set_234, Set_185, Set_182, Set_180, Set_132, Set_130, Set_128, Set_126, Set_124, Set_122, Set_120, Set_70: set(agent)
Dummy_Set_131, Dummy_Set_129, Dummy_Set_127, Dummy_Set_125, Dummy_Set_123, Dummy_Set_121, Dummy_Set_119, Dummy_Set_233, Dummy_Set_184, Dummy_Set_181, Dummy_Set_179, Dummy_Set_69, Dummy_Set_65, Set_233, Set_184, Set_181, Set_179, Set_131, Set_129, Set_127, Set_125, Set_123, Set_121, Set_119, Set_69, Set_65: set(text)
user_gateway, gateway_snode, snode_user, reg_center, subs1, subs2, subs3, subs4, subs5, subs6, subs7, subs8: protocol_id
Dummy_Verkj, Dummy_Authkj, Dummy_Verjk, Dummy_M4, Dummy_Verji, Dummy_Authji, Dummy_Authjk, Dummy_Verij, Dummy_Authij, Dummy_CIDi, dummy_msg, MGoal, CIDi, Authij, Verij, Authjk, Authkj, Authji, Verjk, Verkj, Verji, M4, start: message
Dummy_IDi, Dummy_SIXk, Dummy_XSk, Dummy_Gj, Dummy_XGj, Dummy_Xc, Dummy_SIDk, Dummy_TS3, Dummy_TS2, Dummy_K, Dummy_TS4, Dummy_Rs, Dummy_Rg, Dummy_TS1, Dummy_Ru, Dummy_M3, Dummy_M2, Dummy_M1, Dummy_SINDijk, Dummy_NIDij, Dummy_GIDj, Dummy_HPWi, Dummy_HBi, Dummy_Bi, dummy_nonce, gidj, sidk, xc, xgj, gj, xsk, sixk, idi, pwi, bi, nidij, sindijk, hbi, m1, m2, m3, hpwi, cidi, authij, verij, authjk, authkj, authji, verjk, verkj, verji, m4, ru, rg, tS1, tS2, tS3, tS4, k, rs, GIDj, SIDk, Xc, XGj, Gj, XSk, SIXk, IDi, PWi, Bi, NIDij, SINDijk, HBi, M1, M2, M3, HPWi, Ru, Rg, Rs, TS1, TS2, TS3, TS4, K: text
dummy_hash, h, Inc, H: hash_func
sk1, SK1: symmetric_key
A2Goal, A1Goal, ui, snk, gwj, rc, Ui, SNk, GWj, RC, i: agent
8, 6, SID, 5, 4, Dummy_State, 3, SID2, SID1, State, 21, 2, 1, 0, 20, 19, 18, 16, 15, 14, 13, 11, 10, 9: nat
set_406, set_405, set_404, set_403, set_402, set_400, set_399, set_398, set_374, set_373, set_372, set_371, set_370, set_369, set_368, set_367, set_366, set_365, set_364, set_363, set_362, set_361, set_355, set_354, set_341, set_340, set_339, set_338, set_337, set_336, set_304, set_303, set_302, set_483, set_482, set_481, set_480, set_479, set_478, set_477, set_476, set_475, set_474, set_473, set_472, set_471, set_470, set_468, set_467, set_465, set_464, set_463, set_462, set_461, set_460, set_458, set_457, set_456, set_454, set_453, set_452, set_451, set_450, set_449, set_448, set_447, set_446, set_445, set_444, set_443, set_442, set_441, set_439, set_438, set_436, set_435, set_434, set_433, set_432, set_431, set_429, set_428, set_427, set_425, set_424, set_423, set_422, set_421, set_420, set_419, set_418, set_417, set_416, set_415, set_414, set_413, set_412, set_410, set_409, set_407: set


section inits:

initial_state init1 := 
 iknows(start).
 iknows(gidj).
 iknows(cidi).
 iknows(sidk).
 iknows(nidij).
 iknows(hbi).
 iknows(m1).
 iknows(m2).
 iknows(m3).
 iknows(m4).
 iknows(authij).
 iknows(authjk).
 iknows(authkj).
 iknows(authji).
 iknows(verij).
 iknows(verjk).
 iknows(verkj).
 iknows(verji).
 iknows(i).
 state_user(gwj,ui,snk,rc,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_302,set_303,set_304,3).
 state_gateway(snk,ui,gwj,rc,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_336,set_337,set_338,set_339,set_340,set_341,4).
 state_snode(ui,snk,gwj,rc,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_354,set_355,5).
 state_regis(rc,snk,ui,gwj,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_361,set_362,set_363,set_364,set_365,set_366,set_367,set_368,set_369,set_370,set_371,set_372,set_373,set_374,6).
 state_user(gwj,ui,snk,rc,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_398,set_399,set_400,8).
 state_gateway(snk,ui,gwj,rc,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_402,set_403,set_404,set_405,set_406,set_407,9).
 state_snode(ui,snk,gwj,rc,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_409,set_410,10).
 state_regis(rc,snk,ui,gwj,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_412,set_413,set_414,set_415,set_416,set_417,set_418,set_419,set_420,set_421,set_422,set_423,set_424,set_425,11).
 state_user(gwj,ui,snk,rc,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_427,set_428,set_429,13).
 state_gateway(snk,ui,gwj,rc,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_431,set_432,set_433,set_434,set_435,set_436,14).
 state_snode(ui,snk,gwj,rc,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_438,set_439,15).
 state_regis(rc,snk,ui,gwj,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_441,set_442,set_443,set_444,set_445,set_446,set_447,set_448,set_449,set_450,set_451,set_452,set_453,set_454,16).
 state_user(gwj,ui,snk,rc,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_456,set_457,set_458,18).
 state_gateway(snk,ui,gwj,rc,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_460,set_461,set_462,set_463,set_464,set_465,19).
 state_snode(ui,snk,gwj,rc,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_467,set_468,20).
 state_regis(rc,snk,ui,gwj,sk1,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_hash,set_470,set_471,set_472,set_473,set_474,set_475,set_476,set_477,set_478,set_479,set_480,set_481,set_482,set_483,21)


section rules:

step step_0 (Ui,SNk,GWj,RC,SK1,H,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Dummy_Bi,NIDij,SINDijk,Dummy_HBi,M1,M2,M3,Dummy_HPWi,Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,CIDi,Authij,Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Dummy_Set_65,Set_69,Set_70,SID,Bi) :=
 state_user(Ui,SNk,GWj,RC,SK1,H,0,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Dummy_Bi,NIDij,SINDijk,Dummy_HBi,M1,M2,M3,Dummy_HPWi,Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,CIDi,Authij,Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Dummy_Set_65,Set_69,Set_70,SID).
 iknows(start)
=[exists Bi]=>
 state_user(Ui,SNk,GWj,RC,SK1,H,1,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,xor(apply(H,pair(PWi,IDi)),Bi),M1,M2,M3,apply(H,pair(PWi,Bi)),Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,CIDi,Authij,Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Dummy_Set_65,Set_69,Set_70,SID).
 iknows(scrypt(SK1,pair(IDi,apply(H,pair(PWi,Bi))))).
 secret(Dummy_Set_65,subs1,Ui).
 contains(IDi,Dummy_Set_65).
 contains(PWi,Dummy_Set_65).
 contains(Bi,Dummy_Set_65)

step step_1 (Ui,SNk,GWj,RC,SK1,H,Dummy_GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Dummy_Bi,Dummy_NIDij,Dummy_SINDijk,Dummy_HBi,Dummy_M1,Dummy_M2,Dummy_M3,Dummy_HPWi,Dummy_Ru,Rg,Rs,Dummy_TS1,TS2,TS3,TS4,K,Dummy_CIDi,Dummy_Authij,Dummy_Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Set_65,Dummy_Set_69,Dummy_Set_70,SID,GIDj,NIDij,HBi,M1,M2,M3,Ru,TS1) :=
 state_user(Ui,SNk,GWj,RC,SK1,H,1,Dummy_GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Dummy_Bi,Dummy_NIDij,Dummy_SINDijk,Dummy_HBi,Dummy_M1,Dummy_M2,Dummy_M3,Dummy_HPWi,Dummy_Ru,Rg,Rs,Dummy_TS1,TS2,TS3,TS4,K,Dummy_CIDi,Dummy_Authij,Dummy_Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Set_65,Dummy_Set_69,Dummy_Set_70,SID).
 iknows(scrypt(SK1,pair(NIDij,pair(GIDj,pair(M1,pair(M2,pair(M3,HBi)))))))
=[exists TS1,Ru]=>
 state_user(Ui,SNk,GWj,RC,SK1,H,2,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,xor(HBi,apply(H,pair(PWi,IDi))),NIDij,xor(Dummy_M3,apply(H,pair(Dummy_GIDj,apply(H,pair(PWi,xor(HBi,apply(H,pair(PWi,IDi)))))))),HBi,M1,M2,M3,apply(H,pair(PWi,xor(HBi,apply(H,pair(PWi,IDi))))),Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,xor(apply(H,pair(apply(H,pair(PWi,xor(HBi,apply(H,pair(PWi,IDi))))),xor(Dummy_M3,apply(H,pair(Dummy_GIDj,apply(H,pair(PWi,xor(HBi,apply(H,pair(PWi,IDi)))))))))),apply(H,pair(xor(Dummy_M3,apply(H,pair(Dummy_GIDj,apply(H,pair(PWi,xor(HBi,apply(H,pair(PWi,IDi)))))))),pair(Ru,TS1)))),apply(H,pair(Dummy_M1,pair(xor(Dummy_M3,apply(H,pair(Dummy_GIDj,apply(H,pair(PWi,xor(HBi,apply(H,pair(PWi,IDi)))))))),pair(Ru,TS1)))),xor(pair(Ru,TS1),xor(Dummy_M3,apply(H,pair(Dummy_GIDj,apply(H,pair(PWi,xor(HBi,apply(H,pair(PWi,IDi))))))))),Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Set_65,Dummy_Set_69,Dummy_Set_70,SID).
 iknows(Dummy_GIDj).
 secret(Dummy_Set_69,subs2,Dummy_Set_70).
 contains(Ru,Dummy_Set_69).
 contains(Ui,Dummy_Set_70).
 contains(GWj,Dummy_Set_70).
 contains(SNk,Dummy_Set_70)

step step_2 (Ui,SNk,GWj,RC,SK1,H,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Ru,Dummy_Rg,Dummy_Rs,TS1,TS2,TS3,Dummy_TS4,Dummy_K,CIDi,Authij,Verij,Dummy_Authjk,Authkj,Dummy_Authji,Verjk,Verkj,Dummy_Verji,Dummy_M4,Inc,Set_65,Set_69,Set_70,SID,Verji,M4) :=
 state_user(Ui,SNk,GWj,RC,SK1,H,2,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Ru,Dummy_Rg,Dummy_Rs,TS1,TS2,TS3,Dummy_TS4,Dummy_K,CIDi,Authij,Verij,Dummy_Authjk,Authkj,Dummy_Authji,Verjk,Verkj,Dummy_Verji,Dummy_M4,Inc,Set_65,Set_69,Set_70,SID).
 iknows(pair(Authji,pair(Verji,M4)))
 =>
 state_user(Ui,SNk,GWj,RC,SK1,H,3,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Ru,xor(M4,SINDijk),xor(M4,SINDijk),TS1,TS2,TS3,xor(M4,SINDijk),apply(H,pair(CIDi,pair(Ru,pair(xor(M4,SINDijk),xor(M4,SINDijk))))),CIDi,Authij,Verij,xor(Verji,xor(M4,SINDijk),SINDijk),Authkj,apply(H,pair(CIDi,pair(Ru,pair(Authij,pair(xor(Verji,xor(M4,SINDijk),SINDijk),pair(SINDijk,pair(xor(M4,SINDijk),apply(H,pair(CIDi,pair(Ru,pair(xor(M4,SINDijk),xor(M4,SINDijk)))))))))))),Verjk,Verkj,Verji,M4,Inc,Set_65,Set_69,Set_70,SID)

step step_3 (GWj,Ui,SNk,RC,SK1,H,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,CIDi,Authij,Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Dummy_Set_179,Dummy_Set_180,Dummy_Set_181,Dummy_Set_182,Set_184,Set_185,SID) :=
 state_gateway(GWj,Ui,SNk,RC,SK1,H,0,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,CIDi,Authij,Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Dummy_Set_179,Dummy_Set_180,Dummy_Set_181,Dummy_Set_182,Set_184,Set_185,SID).
 iknows(scrypt(SK1,pair(GIDj,pair(SIDk,pair(Gj,pair(XGj,SIXk))))))
 =>
 state_gateway(GWj,Ui,SNk,RC,SK1,H,1,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,CIDi,Authij,Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Dummy_Set_179,Dummy_Set_180,Dummy_Set_181,Dummy_Set_182,Set_184,Set_185,SID).
 secret(Dummy_Set_179,subs5,Dummy_Set_180).
 secret(Dummy_Set_181,subs3,Dummy_Set_182).
 contains(SIXk,Dummy_Set_179).
 contains(RC,Dummy_Set_180).
 contains(GWj,Dummy_Set_180).
 contains(SNk,Dummy_Set_180).
 contains(XGj,Dummy_Set_181).
 contains(Gj,Dummy_Set_181).
 contains(GWj,Dummy_Set_182).
 contains(RC,Dummy_Set_182)

step step_4 (GWj,Ui,SNk,RC,SK1,H,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,Dummy_SINDijk,HBi,M1,M2,M3,HPWi,Dummy_Ru,Dummy_Rg,Rs,Dummy_TS1,Dummy_TS2,TS3,TS4,K,CIDi,Dummy_Authij,Verij,Dummy_Authjk,Authkj,Authji,Dummy_Verjk,Verkj,Verji,M4,Inc,Set_179,Set_180,Set_181,Set_182,Dummy_Set_184,Dummy_Set_185,SID,Rg,TS2) :=
 state_gateway(GWj,Ui,SNk,RC,SK1,H,0,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,Dummy_SINDijk,HBi,M1,M2,M3,HPWi,Dummy_Ru,Dummy_Rg,Rs,Dummy_TS1,Dummy_TS2,TS3,TS4,K,CIDi,Dummy_Authij,Verij,Dummy_Authjk,Authkj,Authji,Dummy_Verjk,Verkj,Verji,M4,Inc,Set_179,Set_180,Set_181,Set_182,Dummy_Set_184,Dummy_Set_185,SID).
 iknows(pair(GIDj,pair(SIDk,pair(CIDi,pair(NIDij,pair(Dummy_Authij,Verij))))))
=[exists TS2,Rg]=>
 state_gateway(GWj,Ui,SNk,RC,SK1,H,2,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,apply(H,pair(NIDij,pair(Gj,SIXk))),HBi,M1,M2,M3,HPWi,xor(Verij,apply(H,pair(NIDij,pair(Gj,SIXk)))),Rg,Rs,xor(Verij,apply(H,pair(NIDij,pair(Gj,SIXk)))),TS2,TS3,TS4,K,CIDi,apply(H,pair(xor(CIDi,apply(H,pair(apply(H,pair(NIDij,pair(Gj,SIXk))),pair(xor(Verij,apply(H,pair(NIDij,pair(Gj,SIXk)))),xor(Verij,apply(H,pair(NIDij,pair(Gj,SIXk))))))),apply(H,pair(NIDij,XGj))),pair(apply(H,pair(NIDij,pair(Gj,SIXk))),pair(xor(Verij,apply(H,pair(NIDij,pair(Gj,SIXk)))),xor(Verij,apply(H,pair(NIDij,pair(Gj,SIXk)))))))),Verij,apply(H,pair(CIDi,pair(SIDk,pair(SIXk,Rg)))),Authkj,Authji,xor(pair(xor(Verij,apply(H,pair(NIDij,pair(Gj,SIXk)))),pair(Rg,TS2)),SIXk),Verkj,Verji,M4,Inc,Set_179,Set_180,Set_181,Set_182,Dummy_Set_184,Dummy_Set_185,SID).
 snd(SIDk,CIDi,Dummy_Authjk,Dummy_Verjk).
 secret(Dummy_Set_184,subs7,Dummy_Set_185).
 contains(Rg,Dummy_Set_184).
 contains(Ui,Dummy_Set_185).
 contains(GWj,Dummy_Set_185).
 contains(SNk,Dummy_Set_185)

step step_5 (GWj,Ui,SNk,RC,SK1,H,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Ru,Rg,Dummy_Rs,TS1,TS2,Dummy_TS3,Dummy_TS4,Dummy_K,CIDi,Authij,Verij,Authjk,Dummy_Authkj,Dummy_Authji,Verjk,Verkj,Dummy_Verji,Dummy_M4,Inc,Set_179,Set_180,Set_181,Set_182,Set_184,Set_185,SID,TS4) :=
 state_gateway(GWj,Ui,SNk,RC,SK1,H,2,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Ru,Rg,Dummy_Rs,TS1,TS2,Dummy_TS3,Dummy_TS4,Dummy_K,CIDi,Authij,Verij,Authjk,Dummy_Authkj,Dummy_Authji,Verjk,Verkj,Dummy_Verji,Dummy_M4,Inc,Set_179,Set_180,Set_181,Set_182,Set_184,Set_185,SID).
 iknows(Verkj)
=[exists TS4]=>
 state_gateway(GWj,Ui,SNk,RC,SK1,H,3,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Ru,Rg,xor(Verjk,SIXk),TS1,TS2,xor(Verjk,SIXk),TS4,apply(H,pair(CIDi,pair(Ru,pair(Rg,xor(Verjk,SIXk))))),CIDi,Authij,Verij,Authjk,apply(H,pair(xor(Authjk,xor(Verjk,SIXk)),pair(xor(Verjk,SIXk),pair(Rg,pair(SIXk,Dummy_K))))),apply(H,pair(CIDi,pair(Ru,pair(Authij,pair(Authjk,pair(SINDijk,pair(Dummy_TS4,Dummy_K))))))),Verjk,Verkj,xor(Authjk,xor(Verjk,SIXk),SINDijk),xor(pair(xor(Verjk,SIXk),pair(Rg,Dummy_TS4)),SINDijk),Inc,Set_179,Set_180,Set_181,Set_182,Set_184,Set_185,SID).
 iknows(apply(H,pair(CIDi,pair(Ru,pair(Authij,pair(Authjk,pair(SINDijk,pair(Dummy_TS4,Dummy_K))))))))

step step_6 (SNk,Ui,GWj,RC,SK1,H,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Dummy_Ru,Dummy_Rg,Dummy_Rs,TS1,Dummy_TS2,Dummy_TS3,TS4,Dummy_K,Dummy_CIDi,Authij,Verij,Dummy_Authjk,Dummy_Authkj,Authji,Dummy_Verjk,Dummy_Verkj,Verji,M4,Inc,Dummy_Set_233,Dummy_Set_234,SID,Rs,TS3) :=
 state_snode(SNk,Ui,GWj,RC,SK1,H,0,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Dummy_Ru,Dummy_Rg,Dummy_Rs,TS1,Dummy_TS2,Dummy_TS3,TS4,Dummy_K,Dummy_CIDi,Authij,Verij,Dummy_Authjk,Dummy_Authkj,Authji,Dummy_Verjk,Dummy_Verkj,Verji,M4,Inc,Dummy_Set_233,Dummy_Set_234,SID).
 iknows(SIDk)
=[exists Rs,TS3]=>
 state_snode(SNk,Ui,GWj,RC,SK1,H,1,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,xor(Dummy_Verjk,apply(H,pair(SIDk,XSk))),xor(Dummy_Verjk,apply(H,pair(SIDk,XSk))),Rs,TS1,xor(Dummy_Verjk,apply(H,pair(SIDk,XSk))),TS3,TS4,apply(H,pair(Dummy_CIDi,pair(xor(Dummy_Verjk,apply(H,pair(SIDk,XSk))),pair(xor(Dummy_Verjk,apply(H,pair(SIDk,XSk))),Rs)))),Dummy_CIDi,Authij,Verij,apply(H,pair(CIDi,pair(SIDk,pair(SIXk,xor(Dummy_Verjk,apply(H,pair(SIDk,XSk))))))),apply(H,pair(xor(apply(H,pair(CIDi,pair(SIDk,pair(SIXk,xor(Dummy_Verjk,apply(H,pair(SIDk,XSk))))))),Dummy_Rs),pair(Dummy_Rs,pair(xor(Dummy_Verjk,apply(H,pair(SIDk,XSk))),pair(SIXk,apply(H,pair(Dummy_CIDi,pair(xor(Dummy_Verjk,apply(H,pair(SIDk,XSk))),pair(xor(Dummy_Verjk,apply(H,pair(SIDk,XSk))),Rs))))))))),Authji,Dummy_Verjk,xor(pair(rs,Dummy_TS3),SIXk),Verji,M4,Inc,Dummy_Set_233,Dummy_Set_234,SID).
 iknows(Dummy_Verkj).
 secret(Dummy_Set_233,subs8,Dummy_Set_234).
 contains(Dummy_Rs,Dummy_Set_233).
 contains(Ui,Dummy_Set_234).
 contains(GWj,Dummy_Set_234).
 contains(SNk,Dummy_Set_234)

step step_7 (RC,Ui,SNk,GWj,SK1,H,Dummy_GIDj,Dummy_SIDk,Dummy_Xc,Dummy_XGj,Dummy_Gj,Dummy_XSk,Dummy_SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,CIDi,Authij,Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Dummy_Set_119,Dummy_Set_120,Dummy_Set_121,Dummy_Set_122,Dummy_Set_123,Dummy_Set_124,Dummy_Set_125,Dummy_Set_126,Set_127,Set_128,Set_129,Set_130,Set_131,Set_132,SID,GIDj,SIDk,Xc,Gj,XSk) :=
 state_regis(RC,Ui,SNk,GWj,SK1,H,0,Dummy_GIDj,Dummy_SIDk,Dummy_Xc,Dummy_XGj,Dummy_Gj,Dummy_XSk,Dummy_SIXk,IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,CIDi,Authij,Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Dummy_Set_119,Dummy_Set_120,Dummy_Set_121,Dummy_Set_122,Dummy_Set_123,Dummy_Set_124,Dummy_Set_125,Dummy_Set_126,Set_127,Set_128,Set_129,Set_130,Set_131,Set_132,SID).
 iknows(start)
=[exists XSk,SIDk,Gj,GIDj,Xc]=>
 state_regis(RC,Ui,SNk,GWj,SK1,H,1,GIDj,SIDk,Xc,apply(H,pair(Xc,Gj)),Gj,XSk,apply(H,pair(SIDk,pair(Xc,pair(apply(H,pair(Xc,Gj)),XSk)))),IDi,PWi,Bi,NIDij,SINDijk,HBi,M1,M2,M3,HPWi,Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,CIDi,Authij,Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Dummy_Set_119,Dummy_Set_120,Dummy_Set_121,Dummy_Set_122,Dummy_Set_123,Dummy_Set_124,Dummy_Set_125,Dummy_Set_126,Set_127,Set_128,Set_129,Set_130,Set_131,Set_132,SID).
 secret(Dummy_Set_119,subs3,Dummy_Set_120).
 iknows(scrypt(SK1,pair(GIDj,pair(Gj,pair(apply(H,pair(Xc,Gj)),pair(SIDk,apply(H,pair(SIDk,pair(Xc,pair(apply(H,pair(Xc,Gj)),XSk)))))))))).
 iknows(scrypt(SK1,pair(SIDk,apply(H,pair(SIDk,pair(Xc,pair(apply(H,pair(Xc,Gj)),XSk))))))).
 secret(Dummy_Set_121,subs4,Dummy_Set_122).
 secret(Dummy_Set_123,subs5,Dummy_Set_124).
 secret(Dummy_Set_125,subs6,Dummy_Set_126).
 contains(apply(H,pair(Xc,Gj)),Dummy_Set_119).
 contains(Gj,Dummy_Set_119).
 contains(GWj,Dummy_Set_120).
 contains(RC,Dummy_Set_120).
 contains(Xc,Dummy_Set_121).
 contains(RC,Dummy_Set_122).
 contains(apply(H,pair(SIDk,pair(Xc,pair(apply(H,pair(Xc,Gj)),XSk)))),Dummy_Set_123).
 contains(RC,Dummy_Set_124).
 contains(GWj,Dummy_Set_124).
 contains(SNk,Dummy_Set_124).
 contains(XSk,Dummy_Set_125).
 contains(RC,Dummy_Set_126)

step step_8 (RC,Ui,SNk,GWj,SK1,H,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,Dummy_IDi,PWi,Bi,Dummy_NIDij,Dummy_SINDijk,HBi,Dummy_M1,Dummy_M2,Dummy_M3,Dummy_HPWi,Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,CIDi,Authij,Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Set_119,Set_120,Set_121,Set_122,Set_123,Set_124,Set_125,Set_126,Dummy_Set_127,Dummy_Set_128,Dummy_Set_129,Dummy_Set_130,Dummy_Set_131,Dummy_Set_132,SID,IDi,HPWi) :=
 state_regis(RC,Ui,SNk,GWj,SK1,H,1,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,Dummy_IDi,PWi,Bi,Dummy_NIDij,Dummy_SINDijk,HBi,Dummy_M1,Dummy_M2,Dummy_M3,Dummy_HPWi,Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,CIDi,Authij,Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Set_119,Set_120,Set_121,Set_122,Set_123,Set_124,Set_125,Set_126,Dummy_Set_127,Dummy_Set_128,Dummy_Set_129,Dummy_Set_130,Dummy_Set_131,Dummy_Set_132,SID).
 iknows(scrypt(SK1,pair(IDi,HPWi)))
 =>
 state_regis(RC,Ui,SNk,GWj,SK1,H,2,GIDj,SIDk,Xc,XGj,Gj,XSk,SIXk,IDi,PWi,Bi,apply(H,pair(IDi,XGj)),apply(H,pair(apply(H,pair(IDi,XGj)),pair(Gj,SIXk))),HBi,xor(apply(H,pair(HPWi,apply(H,pair(apply(H,pair(IDi,XGj)),pair(Gj,SIXk))))),apply(H,pair(apply(H,pair(IDi,XGj)),XGj))),apply(H,pair(HPWi,apply(H,pair(apply(H,pair(IDi,XGj)),pair(Gj,SIXk))))),xor(apply(H,pair(apply(H,pair(IDi,XGj)),pair(Gj,SIXk))),apply(H,pair(GIDj,HPWi))),HPWi,Ru,Rg,Rs,TS1,TS2,TS3,TS4,K,CIDi,Authij,Verij,Authjk,Authkj,Authji,Verjk,Verkj,Verji,M4,Inc,Set_119,Set_120,Set_121,Set_122,Set_123,Set_124,Set_125,Set_126,Dummy_Set_127,Dummy_Set_128,Dummy_Set_129,Dummy_Set_130,Dummy_Set_131,Dummy_Set_132,SID).
 secret(Dummy_Set_127,subs4,Dummy_Set_128).
 secret(Dummy_Set_129,subs5,Dummy_Set_130).
 secret(Dummy_Set_131,subs6,Dummy_Set_132).
 iknows(scrypt(SK1,pair(apply(H,pair(IDi,XGj)),pair(GIDj,pair(xor(apply(H,pair(HPWi,apply(H,pair(apply(H,pair(IDi,XGj)),pair(Gj,SIXk))))),apply(H,pair(apply(H,pair(IDi,XGj)),XGj))),pair(apply(H,pair(HPWi,apply(H,pair(apply(H,pair(IDi,XGj)),pair(Gj,SIXk))))),xor(apply(H,pair(apply(H,pair(IDi,XGj)),pair(Gj,SIXk))),apply(H,pair(GIDj,HPWi))))))))).
 contains(apply(H,pair(apply(H,pair(IDi,XGj)),pair(Gj,SIXk))),Dummy_Set_127).
 contains(RC,Dummy_Set_128).
 contains(GWj,Dummy_Set_128).
 contains(Ui,Dummy_Set_128).
 contains(SIXk,Dummy_Set_129).
 contains(RC,Dummy_Set_130).
 contains(GWj,Dummy_Set_130).
 contains(SNk,Dummy_Set_130).
 contains(IDi,Dummy_Set_131).
 contains(RC,Dummy_Set_132).
 contains(Ui,Dummy_Set_132)


section properties:

property secrecy_of_subs1 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs1,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs2 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs2,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs3 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs3,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs4 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs4,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs5 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs5,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs6 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs6,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs7 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs7,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs8 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs8,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property authentication_on_user_gateway_ru (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,user_gateway_ru,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,user_gateway_ru,MGoal))
     /\ ((request(A1Goal,A2Goal,user_gateway_ru,MGoal,SID1)
           /\ request(A1Goal,A2Goal,user_gateway_ru,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_gateway_snode_rg (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,gateway_snode_rg,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,gateway_snode_rg,MGoal))
     /\ ((request(A1Goal,A2Goal,gateway_snode_rg,MGoal,SID1)
           /\ request(A1Goal,A2Goal,gateway_snode_rg,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_snode_user_rs (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,snode_user_rs,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,snode_user_rs,MGoal))
     /\ ((request(A1Goal,A2Goal,snode_user_rs,MGoal,SID1)
           /\ request(A1Goal,A2Goal,snode_user_rs,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))


section attack_states:

attack_state secrecy_of_subs1 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs1,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs2 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs2,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs3 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs3,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs4 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs4,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs5 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs5,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs6 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs6,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs7 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs7,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs8 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs8,ASGoal) &
 not(contains(i,ASGoal))

attack_state authentication_on_user_gateway_ru (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,user_gateway_ru,MGoal,SID) &
 not(witness(A2Goal,A1Goal,user_gateway_ru,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_user_gateway_ru (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,user_gateway_ru,MGoal,SID1).
 request(A1Goal,A2Goal,user_gateway_ru,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_gateway_snode_rg (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,gateway_snode_rg,MGoal,SID) &
 not(witness(A2Goal,A1Goal,gateway_snode_rg,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_gateway_snode_rg (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,gateway_snode_rg,MGoal,SID1).
 request(A1Goal,A2Goal,gateway_snode_rg,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_snode_user_rs (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,snode_user_rs,MGoal,SID) &
 not(witness(A2Goal,A1Goal,snode_user_rs,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_snode_user_rs (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,snode_user_rs,MGoal,SID1).
 request(A1Goal,A2Goal,snode_user_rs,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

