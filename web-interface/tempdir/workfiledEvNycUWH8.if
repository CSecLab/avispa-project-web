%% IF specification of /home/avispa/web-interface-computation/./tempdir/workfiledEvNycUWH8

section signature:

state_controlserver: agent * agent * agent * message * message * hash_func * nat * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * set(agent) * set(agent) * nat -> fact
state_serverj: agent * agent * agent * message * message * message * hash_func * nat * message * message * message * message * message * message * message * message * message * message * message * message * message * message * set(agent) * set(agent) * nat -> fact
state_useri: agent * agent * agent * message * message * message * message * message * message * message * message * hash_func * nat * message * message * message * message * message * message * message * message * message * message * message * set(agent) * set(agent) * nat -> fact


section types:

sec_ni1, sec_ni3, sec_ni2, cs_s_ni2, sec_sk, cs_u_ni1, sec_idi: protocol_id
ha, Ha: hash_func
4, SID, Dummy_State, 3, SID2, SID1, State, 20, 19, 2, 17, 1, 15, 0, 13, 12, 9, 8, 7, 5: nat
set_198, set_197, set_180, set_179, set_251, set_250, set_248, set_247, set_245, set_244, set_242, set_241, set_240, set_239, set_237, set_236, set_234, set_233, set_231, set_230, set_229, set_228, set_226, set_225, set_223, set_222, set_220, set_219, set_212, set_211: set
A2Goal, A1Goal, u, s, u1, u2, s1, s2, cs, U, S, CS, i: agent
Dummy_Set_42, Dummy_Set_38, ASGoal, Set_104, Set_102, Set_72, Set_70, Set_42, Set_38, Dummy_Set_104, Dummy_Set_102, Dummy_Set_72, Dummy_Set_70: set(agent)
Dummy_Ki, Dummy_Ni2, Dummy_SharedKey, Dummy_Ni2xNi3, Dummy_Ti, Dummy_Pij, Dummy_CIDi, Dummy_Bi, Dummy_Gi, Dummy_Fi, Dummy_Ni1, Dummy_Ai, dummy_msg, MGoal, xi, yi, sidi, hxyi, hsidjyi, idi, pwi, ci, di, ei, hyi, bi, sid2, hxy2, hsidjy2, id2, pw2, c2, d2, e2, hy2, b2, x, y, sid1, hxy1, hsidjy1, id1, pw1, c1, d1, e1, hy1, b1, Ai, Fi, Gi, CIDi, Ki, Mi, Bi, SIDj, Ni1, Ni2, Ni3, Pij, Ri, Vi, Qi, Ti, SharedKey, X, Y, Haibi, Ni1xNi3, Hxy, Hsidjy, start, Ni2xNi3, IDi, PWi, Dummy_Ni3, Ci, Dummy_SIDj, Di, Ei, Hy, B, Dummy_Ni1xNi3, Dummy_Haibi, Dummy_Vi, Dummy_Ri, Dummy_Qi, Dummy_Mi: message


section inits:

initial_state init1 := 
 iknows(start).
 iknows(u1).
 iknows(u2).
 iknows(s1).
 iknows(s2).
 iknows(cs).
 iknows(xi).
 iknows(yi).
 iknows(sidi).
 iknows(hxyi).
 iknows(hsidjyi).
 iknows(idi).
 iknows(pwi).
 iknows(ci).
 iknows(di).
 iknows(ei).
 iknows(hyi).
 iknows(bi).
 iknows(ha).
 iknows(i).
 state_useri(u1,s1,cs,sid1,id1,pw1,c1,d1,e1,hy1,b1,ha,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,set_179,set_180,3).
 state_serverj(s1,u1,cs,sid1,hxy1,hsidjy1,ha,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,set_197,set_198,4).
 state_controlserver(cs,u1,s1,x,y,ha,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,set_211,set_212,5).
 state_useri(u2,s2,cs,sid1,id2,pw2,c2,d2,e2,hy2,b2,ha,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,set_219,set_220,7).
 state_serverj(s2,u2,cs,sid1,hxy1,hsidjy1,ha,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,set_222,set_223,8).
 state_controlserver(cs,u2,s2,x,y,ha,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,set_225,set_226,9).
 state_serverj(s,i,cs,sid1,hxy1,hsidjy1,ha,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,set_230,set_231,12).
 state_controlserver(cs,i,s,x,y,ha,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,set_233,set_234,13).
 state_useri(u,i,cs,sidi,id1,pw1,c1,d1,e1,hyi,b1,ha,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,set_236,set_237,15).
 state_controlserver(cs,u,i,x,y,ha,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,set_241,set_242,17).
 state_useri(u,s,i,sid1,id1,pw1,c1,d1,e1,hy1,b1,ha,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,set_244,set_245,19).
 state_serverj(s,u,i,sid1,hxy1,hsidjy1,ha,0,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,set_247,set_248,20)


section rules:

step step_0 (U,S,CS,SIDj,IDi,PWi,Ci,Di,Ei,Hy,B,Ha,Dummy_Ai,Dummy_Ni1,Dummy_Fi,Dummy_Gi,Vi,Ti,Dummy_Bi,Dummy_CIDi,Dummy_Pij,Ni2xNi3,SharedKey,Dummy_Set_38,Set_42,SID,Ni1) :=
 state_useri(U,S,CS,SIDj,IDi,PWi,Ci,Di,Ei,Hy,B,Ha,0,Dummy_Ai,Dummy_Ni1,Dummy_Fi,Dummy_Gi,Vi,Ti,Dummy_Bi,Dummy_CIDi,Dummy_Pij,Ni2xNi3,SharedKey,Dummy_Set_38,Set_42,SID).
 iknows(start)
=[exists Ni1]=>
 state_useri(U,S,CS,SIDj,IDi,PWi,Ci,Di,Ei,Hy,B,Ha,1,apply(Ha,pair(B,PWi)),Ni1,xor(Hy,Ni1),apply(Ha,pair(xor(Di,apply(Ha,pair(IDi,apply(Ha,pair(B,PWi))))),pair(apply(Ha,pair(B,PWi)),Ni1))),Vi,Ti,xor(Di,apply(Ha,pair(IDi,apply(Ha,pair(B,PWi))))),xor(apply(Ha,pair(B,PWi)),apply(Ha,pair(xor(Di,apply(Ha,pair(IDi,apply(Ha,pair(B,PWi))))),pair(xor(Hy,Ni1),Ni1)))),xor(Ei,apply(Ha,pair(Hy,pair(Ni1,SIDj)))),Ni2xNi3,SharedKey,Dummy_Set_38,Set_42,SID).
 iknows(pair(xor(Hy,Ni1),pair(apply(Ha,pair(xor(Di,apply(Ha,pair(IDi,apply(Ha,pair(B,PWi))))),pair(apply(Ha,pair(B,PWi)),Ni1))),pair(xor(Ei,apply(Ha,pair(Hy,pair(Ni1,SIDj)))),xor(apply(Ha,pair(B,PWi)),apply(Ha,pair(xor(Di,apply(Ha,pair(IDi,apply(Ha,pair(B,PWi))))),pair(xor(Hy,Ni1),Ni1)))))))).
 witness(U,CS,cs_u_ni1,Ni1).
 secret(IDi,sec_idi,Dummy_Set_38).
 contains(U,Dummy_Set_38).
 contains(CS,Dummy_Set_38)

step step_1 (U,S,CS,SIDj,IDi,PWi,Ci,Di,Ei,Hy,B,Ha,Ai,Ni1,Fi,Gi,Vi,Dummy_Ti,Bi,CIDi,Pij,Dummy_Ni2xNi3,Dummy_SharedKey,Set_38,Dummy_Set_42,SID,Ti) :=
 state_useri(U,S,CS,SIDj,IDi,PWi,Ci,Di,Ei,Hy,B,Ha,1,Ai,Ni1,Fi,Gi,Vi,Dummy_Ti,Bi,CIDi,Pij,Dummy_Ni2xNi3,Dummy_SharedKey,Set_38,Dummy_Set_42,SID).
 iknows(pair(apply(Ha,pair(apply(Ha,pair(Ai,Bi)),apply(Ha,xor(Ni1,xor(Ti,apply(Ha,pair(Ai,pair(Bi,Ni1)))))))),Ti))
 =>
 state_useri(U,S,CS,SIDj,IDi,PWi,Ci,Di,Ei,Hy,B,Ha,2,Ai,Ni1,Fi,Gi,Vi,Ti,Bi,CIDi,Pij,xor(Ti,apply(Ha,pair(Ai,pair(Bi,Ni1)))),apply(Ha,pair(apply(Ha,pair(Ai,Bi)),xor(Ni1,xor(Ti,apply(Ha,pair(Ai,pair(Bi,Ni1))))))),Set_38,Dummy_Set_42,SID).
 secret(apply(Ha,pair(apply(Ha,pair(Ai,Bi)),xor(Ni1,xor(Ti,apply(Ha,pair(Ai,pair(Bi,Ni1))))))),sec_sk,Dummy_Set_42).
 contains(U,Dummy_Set_42).
 contains(S,Dummy_Set_42).
 contains(CS,Dummy_Set_42)

step step_2 (S,U,CS,SIDj,Hxy,Hsidjy,Ha,Dummy_Fi,Dummy_Gi,Dummy_Pij,Dummy_CIDi,Dummy_Ni2,Dummy_Ki,Dummy_Mi,Qi,Ri,Vi,Ti,Haibi,Ni1xNi3,SharedKey,Dummy_Set_70,Set_72,SID,Fi,Gi,Pij,CIDi,Ni2) :=
 state_serverj(S,U,CS,SIDj,Hxy,Hsidjy,Ha,0,Dummy_Fi,Dummy_Gi,Dummy_Pij,Dummy_CIDi,Dummy_Ni2,Dummy_Ki,Dummy_Mi,Qi,Ri,Vi,Ti,Haibi,Ni1xNi3,SharedKey,Dummy_Set_70,Set_72,SID).
 iknows(pair(Fi,pair(Gi,pair(Pij,CIDi))))
=[exists Ni2]=>
 state_serverj(S,U,CS,SIDj,Hxy,Hsidjy,Ha,1,Fi,Gi,Pij,CIDi,Ni2,xor(Hsidjy,Ni2),apply(Ha,pair(Hxy,Ni2)),Qi,Ri,Vi,Ti,Haibi,Ni1xNi3,SharedKey,Dummy_Set_70,Set_72,SID).
 iknows(pair(Fi,pair(Gi,pair(Pij,pair(CIDi,pair(SIDj,pair(xor(Hsidjy,Ni2),apply(Ha,pair(Hxy,Ni2))))))))).
 witness(S,CS,cs_s_ni2,Ni2).
 secret(Ni2,sec_ni2,Dummy_Set_70).
 contains(S,Dummy_Set_70).
 contains(CS,Dummy_Set_70)

step step_3 (S,U,CS,SIDj,Hxy,Hsidjy,Ha,Fi,Gi,Pij,CIDi,Ni2,Ki,Mi,Dummy_Qi,Dummy_Ri,Dummy_Vi,Dummy_Ti,Dummy_Haibi,Dummy_Ni1xNi3,Dummy_SharedKey,Set_70,Dummy_Set_72,SID,Qi,Ri,Ti) :=
 state_serverj(S,U,CS,SIDj,Hxy,Hsidjy,Ha,1,Fi,Gi,Pij,CIDi,Ni2,Ki,Mi,Dummy_Qi,Dummy_Ri,Dummy_Vi,Dummy_Ti,Dummy_Haibi,Dummy_Ni1xNi3,Dummy_SharedKey,Set_70,Dummy_Set_72,SID).
 iknows(pair(Qi,pair(Ri,pair(apply(Ha,pair(xor(Ri,apply(Ha,xor(xor(Qi,apply(Ha,pair(SIDj,Ni2))),Ni2))),apply(Ha,xor(xor(Qi,apply(Ha,pair(SIDj,Ni2))),Ni2)))),Ti))))
 =>
 state_serverj(S,U,CS,SIDj,Hxy,Hsidjy,Ha,2,Fi,Gi,Pij,CIDi,Ni2,Ki,Mi,Qi,Ri,apply(Ha,pair(xor(Ri,apply(Ha,xor(xor(Qi,apply(Ha,pair(SIDj,Ni2))),Ni2))),apply(Ha,xor(xor(Qi,apply(Ha,pair(SIDj,Ni2))),Ni2)))),Ti,xor(Ri,apply(Ha,pair(xor(Qi,apply(Ha,pair(SIDj,Ni2))),Ni2))),xor(Qi,apply(Ha,pair(SIDj,Ni2))),apply(Ha,pair(xor(Ri,apply(Ha,pair(xor(Qi,apply(Ha,pair(SIDj,Ni2))),Ni2))),xor(xor(Qi,apply(Ha,pair(SIDj,Ni2))),Ni2))),Set_70,Dummy_Set_72,SID).
 iknows(pair(apply(Ha,pair(xor(Ri,apply(Ha,xor(xor(Qi,apply(Ha,pair(SIDj,Ni2))),Ni2))),apply(Ha,xor(xor(Qi,apply(Ha,pair(SIDj,Ni2))),Ni2)))),Ti)).
 secret(apply(Ha,pair(xor(Ri,apply(Ha,pair(xor(Qi,apply(Ha,pair(SIDj,Ni2))),Ni2))),xor(xor(Qi,apply(Ha,pair(SIDj,Ni2))),Ni2))),sec_sk,Dummy_Set_72).
 contains(U,Dummy_Set_72).
 contains(S,Dummy_Set_72).
 contains(CS,Dummy_Set_72)

step step_4 (CS,U,S,X,Y,Ha,Dummy_Ai,Dummy_Fi,Gi,Dummy_CIDi,Dummy_Ki,Mi,Dummy_Bi,Dummy_SIDj,Dummy_Ni1,Dummy_Ni2,Dummy_Ni3,Dummy_Pij,Dummy_Ri,Dummy_Vi,Dummy_Qi,Dummy_Ti,Dummy_SharedKey,Dummy_Set_102,Dummy_Set_104,SID,Fi,CIDi,Ki,SIDj,Ni3,Pij) :=
 state_controlserver(CS,U,S,X,Y,Ha,0,Dummy_Ai,Dummy_Fi,Gi,Dummy_CIDi,Dummy_Ki,Mi,Dummy_Bi,Dummy_SIDj,Dummy_Ni1,Dummy_Ni2,Dummy_Ni3,Dummy_Pij,Dummy_Ri,Dummy_Vi,Dummy_Qi,Dummy_Ti,Dummy_SharedKey,Dummy_Set_102,Dummy_Set_104,SID).
 iknows(pair(Fi,pair(apply(Ha,pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),pair(xor(CIDi,apply(Ha,pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),pair(Fi,Ni1)))),xor(Fi,apply(Ha,Y))))),pair(Pij,pair(CIDi,pair(SIDj,pair(Ki,apply(Ha,pair(apply(Ha,pair(X,Y)),xor(Ki,apply(Ha,pair(SIDj,Y))))))))))))
=[exists Ni3]=>
 state_controlserver(CS,U,S,X,Y,Ha,1,xor(CIDi,apply(Ha,pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),pair(Fi,xor(Fi,apply(Ha,Y)))))),Fi,Gi,CIDi,Ki,Mi,xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),SIDj,xor(Fi,apply(Ha,Y)),xor(Ki,apply(Ha,pair(SIDj,Y))),Ni3,Pij,xor(apply(Ha,pair(xor(CIDi,apply(Ha,pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),pair(Fi,xor(Fi,apply(Ha,Y)))))),xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))))),apply(Ha,xor(xor(Fi,apply(Ha,Y)),xor(xor(Ki,apply(Ha,pair(SIDj,Y))),Ni3)))),apply(Ha,pair(apply(Ha,pair(xor(CIDi,apply(Ha,pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),pair(Fi,xor(Fi,apply(Ha,Y)))))),xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))))),apply(Ha,xor(xor(Fi,apply(Ha,Y)),xor(xor(Ki,apply(Ha,pair(SIDj,Y))),Ni3))))),xor(xor(Fi,apply(Ha,Y)),xor(Ni3,apply(Ha,pair(SIDj,xor(Ki,apply(Ha,pair(SIDj,Y))))))),xor(xor(Ki,apply(Ha,pair(SIDj,Y))),xor(Ni3,apply(Ha,pair(xor(CIDi,apply(Ha,pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),pair(Fi,xor(Fi,apply(Ha,Y)))))),pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),xor(Fi,apply(Ha,Y))))))),apply(Ha,pair(apply(Ha,pair(xor(CIDi,apply(Ha,pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),pair(Fi,xor(Fi,apply(Ha,Y)))))),xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))))),xor(xor(Fi,apply(Ha,Y)),xor(xor(Ki,apply(Ha,pair(SIDj,Y))),Ni3)))),Dummy_Set_102,Dummy_Set_104,SID).
 iknows(pair(xor(xor(Fi,apply(Ha,Y)),xor(Ni3,apply(Ha,pair(SIDj,xor(Ki,apply(Ha,pair(SIDj,Y))))))),pair(xor(apply(Ha,pair(xor(CIDi,apply(Ha,pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),pair(Fi,xor(Fi,apply(Ha,Y)))))),xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))))),apply(Ha,xor(xor(Fi,apply(Ha,Y)),xor(xor(Ki,apply(Ha,pair(SIDj,Y))),Ni3)))),pair(apply(Ha,pair(apply(Ha,pair(xor(CIDi,apply(Ha,pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),pair(Fi,xor(Fi,apply(Ha,Y)))))),xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))))),apply(Ha,xor(xor(Fi,apply(Ha,Y)),xor(xor(Ki,apply(Ha,pair(SIDj,Y))),Ni3))))),xor(xor(Ki,apply(Ha,pair(SIDj,Y))),xor(Ni3,apply(Ha,pair(xor(CIDi,apply(Ha,pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),pair(Fi,xor(Fi,apply(Ha,Y)))))),pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),xor(Fi,apply(Ha,Y))))))))))).
 request(U,CS,cs_u_ni1,xor(Fi,apply(Ha,Y)),SID).
 request(S,CS,cs_s_ni2,xor(Ki,apply(Ha,pair(SIDj,Y))),SID).
 secret(apply(Ha,pair(apply(Ha,pair(xor(CIDi,apply(Ha,pair(xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))),pair(Fi,xor(Fi,apply(Ha,Y)))))),xor(Pij,xor(apply(Ha,pair(apply(Ha,Y),pair(xor(Fi,apply(Ha,Y)),SIDj))),apply(Ha,pair(X,Y)))))),xor(xor(Fi,apply(Ha,Y)),xor(xor(Ki,apply(Ha,pair(SIDj,Y))),Ni3)))),sec_sk,Dummy_Set_102).
 secret(Ni3,sec_ni3,Dummy_Set_104).
 contains(U,Dummy_Set_102).
 contains(S,Dummy_Set_102).
 contains(CS,Dummy_Set_102).
 contains(CS,Dummy_Set_104)


section properties:

property secrecy_of_sec_idi (MGoal,ASGoal) :=
 [] ((secret(MGoal,sec_idi,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_sec_ni3 (MGoal,ASGoal) :=
 [] ((secret(MGoal,sec_ni3,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_sec_ni1 (MGoal,ASGoal) :=
 [] ((secret(MGoal,sec_ni1,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_sec_ni2 (MGoal,ASGoal) :=
 [] ((secret(MGoal,sec_ni2,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_sec_sk (MGoal,ASGoal) :=
 [] ((secret(MGoal,sec_sk,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property authentication_on_cs_s_ni2 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,cs_s_ni2,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,cs_s_ni2,MGoal))
     /\ ((request(A1Goal,A2Goal,cs_s_ni2,MGoal,SID1)
           /\ request(A1Goal,A2Goal,cs_s_ni2,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_cs_u_ni1 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,cs_u_ni1,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,cs_u_ni1,MGoal))
     /\ ((request(A1Goal,A2Goal,cs_u_ni1,MGoal,SID1)
           /\ request(A1Goal,A2Goal,cs_u_ni1,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))


section attack_states:

attack_state secrecy_of_sec_idi (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,sec_idi,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_sec_ni3 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,sec_ni3,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_sec_ni1 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,sec_ni1,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_sec_ni2 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,sec_ni2,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_sec_sk (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,sec_sk,ASGoal) &
 not(contains(i,ASGoal))

attack_state authentication_on_cs_s_ni2 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,cs_s_ni2,MGoal,SID) &
 not(witness(A2Goal,A1Goal,cs_s_ni2,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_cs_s_ni2 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,cs_s_ni2,MGoal,SID1).
 request(A1Goal,A2Goal,cs_s_ni2,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_cs_u_ni1 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,cs_u_ni1,MGoal,SID) &
 not(witness(A2Goal,A1Goal,cs_u_ni1,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_cs_u_ni1 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,cs_u_ni1,MGoal,SID1).
 request(A1Goal,A2Goal,cs_u_ni1,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

