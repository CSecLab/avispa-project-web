<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Avispa-users] AVISPA question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:avispa-users%40avispa-project.org?Subject=%5BAvispa-users%5D%20AVISPA%20question&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000306.html">
   <LINK REL="Next"  HREF="000309.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avispa-users] AVISPA question</H1>
    <B>ALINE SAID</B> 
    <A HREF="mailto:avispa-users%40avispa-project.org?Subject=%5BAvispa-users%5D%20AVISPA%20question&In-Reply-To="
       TITLE="[Avispa-users] AVISPA question">aline_said3 at hotmail.com
       </A><BR>
    <I>Thu Jul 20 16:12:19 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000306.html">[Avispa-users] AVISPA Question
</A></li>
        <LI>Next message: <A HREF="000309.html">[Avispa-users] Unified Terms in Attacks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#308">[ date ]</a>
              <a href="thread.html#308">[ thread ]</a>
              <a href="subject.html#308">[ subject ]</a>
              <a href="author.html#308">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi.
In my scenario when user register at a server this server give him a card 
which contains an id, key shared with this server and method of 
authentication; user send this id encoded with the shared key which is in 
his card.  Server has a database containing each user with his ID, his 
address of records and his keys so server can decode this id with the shared 
key and he most verify if the address from in the header of the message 
corresponds to this id sent; if yes and because no one can know this id then 
the server continue the signalization otherwise he must stop it.

The message sent by the user to the server is:
SndAT ({Hash (A. {Hash (Na'.Tstart'.IDa)} _Ka)} _Ka)

A is the user, I sent this value for identifying the &#147;From&#148; value from where 
is sent this message, T is the server, Hash is the function responsible of 
hashing, Na&#146; is a random number created by the server and sent to the user 
in a response of an authentication demand, Ka is the shared key between user 
and server, Ida is the identifier of the user; this identifier is stored in 
the card given to the user upon registration. So we have hashed the id with 
random received from the server with the time of sending this message and 
encoded this hash with the shared key (Ka) and finally all the message is 
signed with the shared key.
All messages sent between users and servers are signed with the shared key.

The random number sent by the server is also encoded with the shared key.
RcvAT ({Hash (K1T. {Na'.Treceive'}_Ka)} _Ka)

K1T is the public key of the server.
With all this encryption we have an attack on the IDa.

When server receive message from user he must validate if this IDa and the 
&#147;From&#148; value (A) corresponds to each other or not. Is there any method in 
AVISPA I can use for the server to find in his database if this IDa sent 
correspond to the &#147;From&#148; value which is the address of record?

A is sent without encoding but all the message is signed so attacker can 
change this address or only he can see it? Attacker cannot know the shared 
key Ka because it is saved on the card of the user and not exchanged in the 
network.

Thanks a lot

_________________________________________________________________
Express yourself instantly with MSN Messenger! Download today - it's FREE! 
<A HREF="http://messenger.msn.click-url.com/go/onm00200471ave/direct/01/">http://messenger.msn.click-url.com/go/onm00200471ave/direct/01/</A>

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000306.html">[Avispa-users] AVISPA Question
</A></li>
	<LI>Next message: <A HREF="000309.html">[Avispa-users] Unified Terms in Attacks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#308">[ date ]</a>
              <a href="thread.html#308">[ thread ]</a>
              <a href="subject.html#308">[ subject ]</a>
              <a href="author.html#308">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.avispa-project.org/mailman/listinfo/avispa-users">More information about the Avispa-users
mailing list</a><br>
</body></html>
