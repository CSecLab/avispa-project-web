%% IF specification of /home/avispa/web-interface-computation/./tempdir/workfile57GiDz

section signature:

state_application: agent * agent * agent * symmetric_key * symmetric_key * hash_func * hash_func * hash_func * text * text * text * nat * text * text * public_key * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * set(agent) * set(agent) * set(agent) * set(agent) * nat -> fact
state_authentication: agent * agent * agent * symmetric_key * symmetric_key * hash_func * hash_func * hash_func * text * text * text * nat * text * text * public_key * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * set(agent) * set(agent) * set(agent) * set(agent) * nat -> fact
state_client: agent * agent * agent * symmetric_key * symmetric_key * hash_func * hash_func * hash_func * text * text * text * nat * text * text * public_key * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * message * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * symmetric_key * set(agent) * set(agent) * set(agent) * set(agent) * nat -> fact


section types:

set_356, set_355, set_354, set_353, set_351, set_350, set_349, set_348, set_347, set_346, set_345, set_344, set_343, set_342, set_341, set_340, set_338, set_337, set_336, set_335, set_333, set_332, set_331, set_330, set_321, set_320, set_319, set_318, set_302, set_301, set_300, set_299, set_269, set_268, set_267, set_266: set
s_b_ksb, b_s_didb2, s_b_dids, b_a_kba, a_b_kab, s_a_ksa, a_s_dida2, dida1, dida2, didb1, didb2, dids, ksa, ksb, kab, kba, skab: protocol_id
Ida, Qida1, Qida2, Ua1, Ua2, Wa, Va, Authab, Ids, Us, Usa1, Usa2, Usb1, Usb2, Hsb, Vsb, Authsa, Authsb, Idb, Qidb1, Qidb2, Ub1, Ub2, Wb, Vb, Authba, Dummy_Wb, Dummy_Vb, Dummy_Ub2, Dummy_Ub1, Dummy_Vsb, Dummy_Hsb, Dummy_Usb2, Dummy_Usb1, Dummy_Authba, Dummy_Authsb, Dummy_Authsa, Dummy_Usa2, Dummy_Usa1, Dummy_Us, Dummy_Authab, Dummy_Va, Dummy_Wa, Dummy_Ua2, Dummy_Ua1, start, dummy_msg, MGoal: message
Ss, dummy_pk: public_key
Na, Nb, Ra, Rs, Rb, Dummy_Rb, Dummy_Rs, Dummy_Nb, Dummy_Na, Dummy_Ra, dummy_nonce, ra, rs, rb, ri: text
Set_155, Set_154, Set_153, Set_148, Dummy_Set_221, Dummy_Set_220, Dummy_Set_216, Dummy_Set_215, Dummy_Set_155, Dummy_Set_154, Dummy_Set_153, Dummy_Set_148, Dummy_Set_90, Dummy_Set_84, Set_90, Set_84, Dummy_Set_75, Dummy_Set_73, Set_75, Set_73, ASGoal, Set_221, Set_220, Set_216, Set_215: set(agent)
Union, Pred, Ebilinear, union, pred, ebilinear: hash_func
State, 13, 7, 6, 12, 8, 5, SID, 4, 3, 9, 2, Dummy_State, 1, 0, SID2, SID1, 11, 10: nat
A, S, B, A2Goal, A1Goal, a, s, b, i: agent
P, Ppub, Dida1, Dida2, Kab, Ksa, Ksb, Kba, Didb1, Didb2, Dids, Skab, Dummy_Ksb, Dummy_Skab, Dummy_Kba, Dummy_Ksa, Dummy_Kab, dummy_sk, p, ppub: symmetric_key


section inits:

initial_state init1 := 
 iknows(start).
 iknows(a).
 iknows(s).
 iknows(b).
 iknows(p).
 iknows(ppub).
 iknows(union).
 iknows(pred).
 iknows(ebilinear).
 iknows(ri).
 iknows(i).
 state_client(a,s,b,p,ppub,union,pred,ebilinear,ra,rs,rb,0,dummy_nonce,dummy_nonce,dummy_pk,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,set_266,set_267,set_268,set_269,3).
 state_authentication(s,a,b,p,ppub,union,pred,ebilinear,ra,rs,rb,2,dummy_nonce,dummy_nonce,dummy_pk,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,set_299,set_300,set_301,set_302,4).
 state_application(b,a,s,p,ppub,union,pred,ebilinear,ra,rs,rb,4,dummy_nonce,dummy_nonce,dummy_pk,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,set_318,set_319,set_320,set_321,5).
 state_client(a,s,i,p,ppub,union,pred,ebilinear,ra,rs,ri,0,dummy_nonce,dummy_nonce,dummy_pk,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,set_330,set_331,set_332,set_333,7).
 state_authentication(s,a,i,p,ppub,union,pred,ebilinear,ra,rs,ri,2,dummy_nonce,dummy_nonce,dummy_pk,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,set_335,set_336,set_337,set_338,8).
 state_authentication(s,i,b,p,ppub,union,pred,ebilinear,ri,rs,rb,2,dummy_nonce,dummy_nonce,dummy_pk,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,set_348,set_349,set_350,set_351,12).
 state_application(b,i,s,p,ppub,union,pred,ebilinear,ri,rs,rb,4,dummy_nonce,dummy_nonce,dummy_pk,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_msg,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,dummy_sk,set_353,set_354,set_355,set_356,13)


section rules:

step step_0 (A,S,B,P,Ppub,Union,Pred,Ebilinear,Dummy_Ra,Rs,Rb,Na,Nb,Ss,Ida,Qida1,Qida2,Dummy_Ua1,Dummy_Ua2,Dummy_Wa,Dummy_Va,Authab,Ids,Us,Usa1,Usa2,Usb1,Usb2,Hsb,Vsb,Authsa,Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Authba,Dida1,Dida2,Kab,Ksa,Ksb,Kba,Didb1,Didb2,Dids,Skab,Dummy_Set_73,Dummy_Set_75,Set_84,Set_90,SID,Ra) :=
 state_client(A,S,B,P,Ppub,Union,Pred,Ebilinear,Dummy_Ra,Rs,Rb,0,Na,Nb,Ss,Ida,Qida1,Qida2,Dummy_Ua1,Dummy_Ua2,Dummy_Wa,Dummy_Va,Authab,Ids,Us,Usa1,Usa2,Usb1,Usb2,Hsb,Vsb,Authsa,Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Authba,Dida1,Dida2,Kab,Ksa,Ksb,Kba,Didb1,Didb2,Dids,Skab,Dummy_Set_73,Dummy_Set_75,Set_84,Set_90,SID).
 iknows(start)
=[exists Ra]=>
 state_client(A,S,B,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,1,Na,Nb,Ss,Ida,Qida1,Qida2,apply(Pred,pair(Dummy_Ra,P)),apply(Pred,pair(Dummy_Ra,Qida2)),apply(Pred,pair(Dummy_Ua1,Dummy_Ua2)),apply(Union,pair(apply(Pred,pair(apply(Pred,pair(Dummy_Ra,Dida1)),Dummy_Wa)),Dida2)),Authab,Ids,Us,Usa1,Usa2,Usb1,Usb2,Hsb,Vsb,Authsa,Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Authba,Dida1,Dida2,Kab,Ksa,Ksb,Kba,Didb1,Didb2,Dids,Skab,Dummy_Set_73,Dummy_Set_75,Set_84,Set_90,SID).
 iknows(pair(A,pair(S,pair(Ida,pair(Idb,pair(Dummy_Ua1,pair(Dummy_Ua2,pair(Dummy_Va,Qida1)))))))).
 secret(Dida1,dida1,Dummy_Set_73).
 secret(Dida2,dida2,Dummy_Set_75).
 witness(A,S,a_s_dida1,Dida1).
 witness(A,S,a_s_dida2,Dida2).
 contains(A,Dummy_Set_73).
 contains(S,Dummy_Set_73).
 contains(A,Dummy_Set_75).
 contains(S,Dummy_Set_75)

step step_1 (A,S,B,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,Dummy_Na,Dummy_Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Dummy_Authab,Ids,Dummy_Us,Dummy_Usa1,Dummy_Usa2,Usb1,Usb2,Hsb,Vsb,Dummy_Authsa,Dummy_Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Authba,Dida1,Dida2,Dummy_Kab,Dummy_Ksa,Ksb,Kba,Didb1,Didb2,Dids,Skab,Set_73,Set_75,Dummy_Set_84,Set_90,SID,Na,Nb,Us,Usa1,Usa2,Authsb) :=
 state_client(A,S,B,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,8,Dummy_Na,Dummy_Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Dummy_Authab,Ids,Dummy_Us,Dummy_Usa1,Dummy_Usa2,Usb1,Usb2,Hsb,Vsb,Dummy_Authsa,Dummy_Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Authba,Dida1,Dida2,Dummy_Kab,Dummy_Ksa,Ksb,Kba,Didb1,Didb2,Dids,Skab,Set_73,Set_75,Dummy_Set_84,Set_90,SID).
 iknows(pair(S,pair(A,pair(Na,pair(apply(Union,pair(Ida,pair(Idb,pair(Ua1,pair(Ua2,pair(Va,pair(Dummy_Na,pair(Dummy_Ksa,pair(Dummy_Us,pair(Dummy_Usa1,Dummy_Usa2)))))))))),pair(Idb,pair(Us,pair(Usa1,pair(Usa2,pair(Nb,Authsb))))))))))
 =>
 state_client(A,S,B,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,9,Na,Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,apply(Union,pair(Ida,pair(Idb,pair(Dummy_Us,Dummy_Kab)))),Ids,Us,Usa1,Usa2,Usb1,Usb2,Hsb,Vsb,apply(Union,pair(Ida,pair(Idb,pair(Ua1,pair(Ua2,pair(Va,pair(Dummy_Na,pair(Dummy_Ksa,pair(Dummy_Us,pair(Dummy_Usa1,Dummy_Usa2)))))))))),Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Authba,Dida1,Dida2,apply(Ebilinear,pair(apply(Pred,pair(Ra,Ppub)),pair(apply(Pred,pair(Ra,Dida2)),apply(Pred,pair(Dummy_Usa1,Dummy_Usa2))))),apply(Pred,pair(Ss,Ua2)),Ksb,Kba,Didb1,Didb2,Dids,Skab,Set_73,Set_75,Dummy_Set_84,Set_90,SID).
 iknows(pair(A,pair(B,pair(Dummy_Nb,pair(Dummy_Authsb,Dummy_Authab))))).
 request(S,A,s_a_ksa,Dummy_Ksa,SID).
 secret(Dummy_Kab,kab,Dummy_Set_84).
 witness(A,B,a_b_kab,Dummy_Kab).
 contains(A,Dummy_Set_84).
 contains(B,Dummy_Set_84)

step step_2 (A,S,B,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,Na,Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Authab,Ids,Us,Usa1,Usa2,Usb1,Usb2,Hsb,Vsb,Authsa,Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Dummy_Authba,Dida1,Dida2,Kab,Ksa,Ksb,Dummy_Kba,Didb1,Didb2,Dids,Dummy_Skab,Set_73,Set_75,Set_84,Dummy_Set_90,SID) :=
 state_client(A,S,B,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,12,Na,Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Authab,Ids,Us,Usa1,Usa2,Usb1,Usb2,Hsb,Vsb,Authsa,Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Dummy_Authba,Dida1,Dida2,Kab,Ksa,Ksb,Dummy_Kba,Didb1,Didb2,Dids,Dummy_Skab,Set_73,Set_75,Set_84,Dummy_Set_90,SID).
 iknows(pair(B,pair(A,apply(Union,pair(Ida,pair(Idb,pair(Us,pair(Dummy_Kba,Authab))))))))
 =>
 state_client(A,S,B,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,13,Na,Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Authab,Ids,Us,Usa1,Usa2,Usb1,Usb2,Hsb,Vsb,Authsa,Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,apply(Union,pair(Ida,pair(Idb,pair(Us,pair(Dummy_Kba,Authab))))),Dida1,Dida2,Kab,Ksa,Ksb,apply(Ebilinear,pair(apply(Pred,pair(Usb1,Usb2)),pair(apply(Pred,pair(Rb,Ppub)),apply(Pred,pair(Rb,Didb2))))),Didb1,Didb2,Dids,apply(Union,pair(Ida,pair(Idb,pair(Kab,pair(Authab,Dummy_Authba))))),Set_73,Set_75,Set_84,Dummy_Set_90,SID).
 request(B,A,b_a_kba,Dummy_Kba,SID).
 contains(A,Dummy_Set_90).
 contains(S,Dummy_Set_90).
 contains(B,Dummy_Set_90)

step step_3 (S,A,B,P,Ppub,Union,Pred,Ebilinear,Ra,Dummy_Rs,Rb,Na,Nb,Ss,Ida,Qida1,Qida2,Dummy_Ua1,Dummy_Ua2,Wa,Dummy_Va,Authab,Ids,Dummy_Us,Usa1,Usa2,Dummy_Usb1,Dummy_Usb2,Dummy_Hsb,Dummy_Vsb,Authsa,Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Authba,Dida1,Dida2,Kab,Ksa,Ksb,Kba,Didb1,Didb2,Dids,Skab,Dummy_Set_148,Set_153,Set_154,Set_155,SID,Rs,Ua1,Ua2,Va) :=
 state_authentication(S,A,B,P,Ppub,Union,Pred,Ebilinear,Ra,Dummy_Rs,Rb,2,Na,Nb,Ss,Ida,Qida1,Qida2,Dummy_Ua1,Dummy_Ua2,Wa,Dummy_Va,Authab,Ids,Dummy_Us,Usa1,Usa2,Dummy_Usb1,Dummy_Usb2,Dummy_Hsb,Dummy_Vsb,Authsa,Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Authba,Dida1,Dida2,Kab,Ksa,Ksb,Kba,Didb1,Didb2,Dids,Skab,Dummy_Set_148,Set_153,Set_154,Set_155,SID).
 iknows(pair(A,pair(S,pair(Ida,pair(Idb,pair(Ua1,pair(Ua2,pair(Va,Qida1))))))))
=[exists Rs]=>
 state_authentication(S,A,B,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,3,Na,Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Authab,Ids,apply(Pred,pair(Dummy_Rs,P)),Usa1,Usa2,apply(Pred,pair(Dummy_Rs,Dummy_Ua1)),apply(Pred,pair(Dummy_Rs,Dummy_Ua2)),apply(Union,pair(Ida,pair(Idb,pair(Dummy_Us,pair(Dummy_Usb1,Dummy_Usb2))))),apply(Union,pair(apply(Pred,pair(Dummy_Rs,Ppub)),apply(Pred,pair(Dummy_Hsb,Dids)))),Authsa,Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Authba,Dida1,Dida2,Kab,Ksa,Ksb,Kba,Didb1,Didb2,Dids,Skab,Dummy_Set_148,Set_153,Set_154,Set_155,SID).
 iknows(pair(S,pair(B,pair(Ida,pair(Dummy_Us,pair(Dummy_Usb1,pair(Dummy_Usb2,Dummy_Vsb))))))).
 secret(Dids,dids,Dummy_Set_148).
 witness(S,B,s_b_dids,Dids).
 contains(S,Dummy_Set_148).
 contains(B,Dummy_Set_148)

step step_4 (S,A,B,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,Dummy_Na,Dummy_Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Authab,Ids,Us,Dummy_Usa1,Dummy_Usa2,Usb1,Usb2,Hsb,Vsb,Dummy_Authsa,Dummy_Authsb,Idb,Qidb1,Qidb2,Dummy_Ub1,Dummy_Ub2,Wb,Dummy_Vb,Authba,Dida1,Dida2,Kab,Dummy_Ksa,Dummy_Ksb,Kba,Didb1,Didb2,Dids,Dummy_Skab,Set_148,Dummy_Set_153,Dummy_Set_154,Dummy_Set_155,SID,Na,Nb,Ub1,Ub2,Vb) :=
 state_authentication(S,A,B,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,6,Dummy_Na,Dummy_Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Authab,Ids,Us,Dummy_Usa1,Dummy_Usa2,Usb1,Usb2,Hsb,Vsb,Dummy_Authsa,Dummy_Authsb,Idb,Qidb1,Qidb2,Dummy_Ub1,Dummy_Ub2,Wb,Dummy_Vb,Authba,Dida1,Dida2,Kab,Dummy_Ksa,Dummy_Ksb,Kba,Didb1,Didb2,Dids,Dummy_Skab,Set_148,Dummy_Set_153,Dummy_Set_154,Dummy_Set_155,SID).
 iknows(pair(B,pair(S,pair(Idb,pair(Ub1,pair(Ub2,pair(Vb,Qidb1)))))))
=[exists Nb,Na]=>
 state_authentication(S,A,B,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,7,Na,Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Authab,Ids,Us,apply(Pred,pair(Rs,Dummy_Ub1)),apply(Pred,pair(Rs,Dummy_Ub2)),Usb1,Usb2,Hsb,Vsb,apply(Union,pair(Ida,pair(Idb,pair(Ua1,pair(Ua2,pair(Va,pair(Dummy_Na,pair(Dummy_Ksa,pair(Us,pair(Dummy_Usa1,Dummy_Usa2)))))))))),apply(Union,pair(Ida,pair(Idb,pair(Dummy_Ub1,pair(Dummy_Ub2,pair(Dummy_Vb,pair(Dummy_Nb,pair(Dummy_Ksb,pair(Us,pair(Usb1,Usb2)))))))))),Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Authba,Dida1,Dida2,Kab,apply(Pred,pair(Ss,Ua2)),apply(Pred,pair(Ss,Dummy_Ub2)),Kba,Didb1,Didb2,Dids,apply(Union,pair(Ida,pair(Idb,pair(Kab,pair(Authab,Authba))))),Set_148,Dummy_Set_153,Dummy_Set_154,Dummy_Set_155,SID).
 iknows(pair(S,pair(A,pair(Dummy_Na,pair(Dummy_Authsa,pair(Idb,pair(Us,pair(Dummy_Usa1,pair(Dummy_Usa2,pair(Dummy_Nb,Dummy_Authsb)))))))))).
 secret(Dummy_Ksa,ksa,Dummy_Set_153).
 secret(Dummy_Ksb,ksb,Dummy_Set_154).
 witness(S,A,s_a_ksa,Dummy_Ksa).
 witness(S,B,s_b_ksb,Dummy_Ksb).
 contains(A,Dummy_Set_153).
 contains(S,Dummy_Set_153).
 contains(B,Dummy_Set_154).
 contains(S,Dummy_Set_154).
 contains(A,Dummy_Set_155).
 contains(S,Dummy_Set_155).
 contains(B,Dummy_Set_155)

step step_5 (B,A,S,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Dummy_Rb,Na,Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Authab,Ids,Dummy_Us,Usa1,Usa2,Dummy_Usb1,Dummy_Usb2,Dummy_Hsb,Dummy_Vsb,Authsa,Authsb,Idb,Qidb1,Qidb2,Dummy_Ub1,Dummy_Ub2,Dummy_Wb,Dummy_Vb,Authba,Dida1,Dida2,Kab,Ksa,Ksb,Kba,Didb1,Didb2,Dids,Skab,Dummy_Set_215,Dummy_Set_216,Set_220,Set_221,SID,Rb,Us,Usb1,Usb2) :=
 state_application(B,A,S,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Dummy_Rb,4,Na,Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Authab,Ids,Dummy_Us,Usa1,Usa2,Dummy_Usb1,Dummy_Usb2,Dummy_Hsb,Dummy_Vsb,Authsa,Authsb,Idb,Qidb1,Qidb2,Dummy_Ub1,Dummy_Ub2,Dummy_Wb,Dummy_Vb,Authba,Dida1,Dida2,Kab,Ksa,Ksb,Kba,Didb1,Didb2,Dids,Skab,Dummy_Set_215,Dummy_Set_216,Set_220,Set_221,SID).
 iknows(pair(S,pair(B,pair(Ida,pair(Us,pair(Usb1,pair(Usb2,apply(Union,pair(apply(Pred,pair(Rs,Ppub)),apply(Pred,pair(Dummy_Hsb,Dids)))))))))))
=[exists Rb]=>
 state_application(B,A,S,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,5,Na,Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Authab,Ids,Us,Usa1,Usa2,Usb1,Usb2,apply(Union,pair(Ida,pair(Idb,pair(Dummy_Us,pair(Dummy_Usb1,Dummy_Usb2))))),apply(Union,pair(apply(Pred,pair(Rs,Ppub)),apply(Pred,pair(Dummy_Hsb,Dids)))),Authsa,Authsb,Idb,Qidb1,Qidb2,apply(Pred,pair(Dummy_Rb,P)),apply(Pred,pair(Dummy_Rb,Qidb2)),apply(Pred,pair(Dummy_Ub1,Dummy_Ub2)),apply(Union,pair(apply(Pred,pair(apply(Pred,pair(Dummy_Rb,Didb1)),Dummy_Wb)),Didb2)),Authba,Dida1,Dida2,Kab,Ksa,Ksb,Kba,Didb1,Didb2,Dids,Skab,Dummy_Set_215,Dummy_Set_216,Set_220,Set_221,SID).
 iknows(pair(B,pair(S,pair(Idb,pair(Dummy_Ub1,pair(Dummy_Ub2,pair(Dummy_Vb,Qidb1))))))).
 secret(Didb1,didb1,Dummy_Set_215).
 secret(Didb2,didb2,Dummy_Set_216).
 witness(B,S,b_s_didb1,Didb1).
 witness(B,S,b_s_didb2,Didb2).
 contains(S,Dummy_Set_215).
 contains(B,Dummy_Set_215).
 contains(S,Dummy_Set_216).
 contains(B,Dummy_Set_216)

step step_6 (B,A,S,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,Na,Dummy_Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Dummy_Authab,Ids,Us,Usa1,Usa2,Usb1,Usb2,Hsb,Vsb,Authsa,Dummy_Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Dummy_Authba,Dida1,Dida2,Dummy_Kab,Ksa,Dummy_Ksb,Dummy_Kba,Didb1,Didb2,Dids,Dummy_Skab,Set_215,Set_216,Dummy_Set_220,Dummy_Set_221,SID,Nb) :=
 state_application(B,A,S,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,10,Na,Dummy_Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,Dummy_Authab,Ids,Us,Usa1,Usa2,Usb1,Usb2,Hsb,Vsb,Authsa,Dummy_Authsb,Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,Dummy_Authba,Dida1,Dida2,Dummy_Kab,Ksa,Dummy_Ksb,Dummy_Kba,Didb1,Didb2,Dids,Dummy_Skab,Set_215,Set_216,Dummy_Set_220,Dummy_Set_221,SID).
 iknows(pair(A,pair(B,pair(Nb,pair(apply(Union,pair(Ida,pair(Idb,pair(Ub1,pair(Ub2,pair(Vb,pair(Dummy_Nb,pair(Dummy_Ksb,pair(Us,pair(Usb1,Usb2)))))))))),apply(Union,pair(Ida,pair(Idb,pair(Us,Dummy_Kab)))))))))
 =>
 state_application(B,A,S,P,Ppub,Union,Pred,Ebilinear,Ra,Rs,Rb,11,Na,Nb,Ss,Ida,Qida1,Qida2,Ua1,Ua2,Wa,Va,apply(Union,pair(Ida,pair(Idb,pair(Us,Dummy_Kab)))),Ids,Us,Usa1,Usa2,Usb1,Usb2,Hsb,Vsb,Authsa,apply(Union,pair(Ida,pair(Idb,pair(Ub1,pair(Ub2,pair(Vb,pair(Dummy_Nb,pair(Dummy_Ksb,pair(Us,pair(Usb1,Usb2)))))))))),Idb,Qidb1,Qidb2,Ub1,Ub2,Wb,Vb,apply(Union,pair(Ida,pair(Idb,pair(Us,pair(Dummy_Kba,Dummy_Authab))))),Dida1,Dida2,apply(Ebilinear,pair(apply(Pred,pair(Ra,Ppub)),pair(apply(Pred,pair(Ra,Dida2)),apply(Pred,pair(Usa1,Usa2))))),Ksa,apply(Pred,pair(Ss,Ub2)),apply(Ebilinear,pair(apply(Pred,pair(Usb1,Usb2)),pair(apply(Pred,pair(Rb,Ppub)),apply(Pred,pair(Rb,Didb2))))),Didb1,Didb2,Dids,apply(Union,pair(Ida,pair(Idb,pair(Dummy_Kab,pair(Dummy_Authab,Dummy_Authba))))),Set_215,Set_216,Dummy_Set_220,Dummy_Set_221,SID).
 iknows(pair(B,pair(A,Dummy_Authba))).
 request(A,B,a_b_kab,Dummy_Kab,SID).
 secret(Dummy_Kba,kba,Dummy_Set_220).
 witness(B,A,b_a_kba,Dummy_Kba).
 contains(A,Dummy_Set_220).
 contains(B,Dummy_Set_220).
 contains(A,Dummy_Set_221).
 contains(S,Dummy_Set_221).
 contains(B,Dummy_Set_221)


section properties:

property secrecy_of_dida1 (MGoal,ASGoal) :=
 [] ((secret(MGoal,dida1,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_dida2 (MGoal,ASGoal) :=
 [] ((secret(MGoal,dida2,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_didb1 (MGoal,ASGoal) :=
 [] ((secret(MGoal,didb1,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_didb2 (MGoal,ASGoal) :=
 [] ((secret(MGoal,didb2,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_dids (MGoal,ASGoal) :=
 [] ((secret(MGoal,dids,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_ksa (MGoal,ASGoal) :=
 [] ((secret(MGoal,ksa,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_ksb (MGoal,ASGoal) :=
 [] ((secret(MGoal,ksb,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_kab (MGoal,ASGoal) :=
 [] ((secret(MGoal,kab,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_kba (MGoal,ASGoal) :=
 [] ((secret(MGoal,kba,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property authentication_on_a_s_dida1 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,a_s_dida1,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,a_s_dida1,MGoal))
     /\ ((request(A1Goal,A2Goal,a_s_dida1,MGoal,SID1)
           /\ request(A1Goal,A2Goal,a_s_dida1,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_a_s_dida2 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,a_s_dida2,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,a_s_dida2,MGoal))
     /\ ((request(A1Goal,A2Goal,a_s_dida2,MGoal,SID1)
           /\ request(A1Goal,A2Goal,a_s_dida2,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_s_b_dids (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,s_b_dids,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,s_b_dids,MGoal))
     /\ ((request(A1Goal,A2Goal,s_b_dids,MGoal,SID1)
           /\ request(A1Goal,A2Goal,s_b_dids,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_b_s_didb1 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,b_s_didb1,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,b_s_didb1,MGoal))
     /\ ((request(A1Goal,A2Goal,b_s_didb1,MGoal,SID1)
           /\ request(A1Goal,A2Goal,b_s_didb1,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_b_s_didb2 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,b_s_didb2,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,b_s_didb2,MGoal))
     /\ ((request(A1Goal,A2Goal,b_s_didb2,MGoal,SID1)
           /\ request(A1Goal,A2Goal,b_s_didb2,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_s_a_ksa (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,s_a_ksa,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,s_a_ksa,MGoal))
     /\ ((request(A1Goal,A2Goal,s_a_ksa,MGoal,SID1)
           /\ request(A1Goal,A2Goal,s_a_ksa,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_s_b_ksb (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,s_b_ksb,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,s_b_ksb,MGoal))
     /\ ((request(A1Goal,A2Goal,s_b_ksb,MGoal,SID1)
           /\ request(A1Goal,A2Goal,s_b_ksb,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_a_b_kab (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,a_b_kab,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,a_b_kab,MGoal))
     /\ ((request(A1Goal,A2Goal,a_b_kab,MGoal,SID1)
           /\ request(A1Goal,A2Goal,a_b_kab,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_b_a_kba (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,b_a_kba,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,b_a_kba,MGoal))
     /\ ((request(A1Goal,A2Goal,b_a_kba,MGoal,SID1)
           /\ request(A1Goal,A2Goal,b_a_kba,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))


section attack_states:

attack_state secrecy_of_dida1 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,dida1,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_dida2 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,dida2,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_didb1 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,didb1,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_didb2 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,didb2,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_dids (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,dids,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_ksa (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,ksa,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_ksb (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,ksb,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_kab (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,kab,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_kba (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,kba,ASGoal) &
 not(contains(i,ASGoal))

attack_state authentication_on_a_s_dida1 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,a_s_dida1,MGoal,SID) &
 not(witness(A2Goal,A1Goal,a_s_dida1,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_a_s_dida1 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,a_s_dida1,MGoal,SID1).
 request(A1Goal,A2Goal,a_s_dida1,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_a_s_dida2 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,a_s_dida2,MGoal,SID) &
 not(witness(A2Goal,A1Goal,a_s_dida2,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_a_s_dida2 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,a_s_dida2,MGoal,SID1).
 request(A1Goal,A2Goal,a_s_dida2,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_s_b_dids (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,s_b_dids,MGoal,SID) &
 not(witness(A2Goal,A1Goal,s_b_dids,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_s_b_dids (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,s_b_dids,MGoal,SID1).
 request(A1Goal,A2Goal,s_b_dids,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_b_s_didb1 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,b_s_didb1,MGoal,SID) &
 not(witness(A2Goal,A1Goal,b_s_didb1,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_b_s_didb1 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,b_s_didb1,MGoal,SID1).
 request(A1Goal,A2Goal,b_s_didb1,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_b_s_didb2 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,b_s_didb2,MGoal,SID) &
 not(witness(A2Goal,A1Goal,b_s_didb2,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_b_s_didb2 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,b_s_didb2,MGoal,SID1).
 request(A1Goal,A2Goal,b_s_didb2,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_s_a_ksa (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,s_a_ksa,MGoal,SID) &
 not(witness(A2Goal,A1Goal,s_a_ksa,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_s_a_ksa (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,s_a_ksa,MGoal,SID1).
 request(A1Goal,A2Goal,s_a_ksa,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_s_b_ksb (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,s_b_ksb,MGoal,SID) &
 not(witness(A2Goal,A1Goal,s_b_ksb,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_s_b_ksb (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,s_b_ksb,MGoal,SID1).
 request(A1Goal,A2Goal,s_b_ksb,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_a_b_kab (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,a_b_kab,MGoal,SID) &
 not(witness(A2Goal,A1Goal,a_b_kab,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_a_b_kab (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,a_b_kab,MGoal,SID1).
 request(A1Goal,A2Goal,a_b_kab,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_b_a_kba (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,b_a_kba,MGoal,SID) &
 not(witness(A2Goal,A1Goal,b_a_kba,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_b_a_kba (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,b_a_kba,MGoal,SID1).
 request(A1Goal,A2Goal,b_a_kba,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

