roleuser(Ui,SNj,HGWN:agent,SK1:symmetric_key,%HishashfunctionH:hash_func,Snd,Rcv:channel(dy))played_byUidef=localState:nat,IDi,PWi,DIDi,PWRi,Ai,TIDi,IDgwnh,IDsnj,Regi,R,Ri,Rj,Rk,T1,T2,T3,T4,Xk,Pj,Sran:text,Bi,Ci,Di,Lii,SKi,Li,Ei,Qi,Kj,Fi,Yk,Gi,Hj:message,Inc:hash_funcconstuser_gateway,gateway_snode,snode_user,subs1,subs2,subs3,subs4,subs5,subs6,subs7:protocol_idinitState:=0transition%Startregistrationphaseoftheuser1.State=0/Rcv(start)=|>State':=1/R':=new()/DIDi':=H(IDi.R')/PWRi':=H(PWi.R')/Snd({DIDi'.PWRi'}_SK1)%SendregistrationrequesttotheHGWN/secret({IDi,PWi},subs1,Ui)2.State=1/Rcv({Regi.Ai.TIDi.IDgwnh}_SK1)=|>%ReeceivessmartcardinformationfromHGWNState':=2/Ri':=new()/T1':=new()/Bi':=xor(Ai,H(DIDi.PWRi))/Ci':=H(IDgwnh.Bi.Ri'.T1')/Di':=xor(Bi',Ri')/Snd(IDgwnh.TIDi.IDsnj.Ci.Di.T1)%SendloginmessagetotheHGWN/witness(Ui,HGWN,user_gateway,Ri')/secret({Ri'},subs2,{Ui,HGWN,SNj})/equest(Ui,HGWN,user_gateway,Ri')3.State=2/Rcv(Li'.Ei.Qi'.Kj.T4)=|>%ReceivesmessagesfromHGWNState':=3/Rj':=xor(Ri,Qi)/Rk':=xor(Kj,Rj)/Lii':=H(Ei.DIDi.Rj.Rk.T4)/SKi':=H(DIDi.Ri.Rj.Rk)endrole 