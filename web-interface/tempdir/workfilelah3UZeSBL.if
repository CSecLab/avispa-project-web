%% IF specification of /home/avispa/web-interface-computation/./tempdir/workfilelah3UZeSBL

section signature:

state_sensor: agent * agent * agent * agent * hash_func * nat * agent * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * hash_func * hash_func * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * nat -> fact
state_hgwn: agent * agent * agent * agent * hash_func * nat * agent * text * text * text * text * text * text * text * text * text * text * text * text * text * text * hash_func * hash_func * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * nat -> fact
state_sa: agent * agent * agent * agent * symmetric_key * hash_func * nat * agent * text * text * text * text * text * text * text * text * text * text * text * text * text * text * hash_func * hash_func * text * text * text * text * text * text * text * text * text * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * nat -> fact
state_user: agent * agent * agent * agent * symmetric_key * hash_func * nat * agent * text * text * text * text * text * text * text * text * text * text * text * text * text * text * hash_func * hash_func * text * text * text * text * text * text * text * text * text * text * text * text * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * nat -> fact


section types:

Dummy_Set_221, Dummy_Set_219, Dummy_Set_217, Dummy_Set_215, Dummy_Set_213, Dummy_Set_168, Dummy_Set_166, Dummy_Set_164, Dummy_Set_162, Dummy_Set_160, Dummy_Set_117, Dummy_Set_115, Dummy_Set_113, Dummy_Set_111, Dummy_Set_109, Dummy_Set_68, Dummy_Set_66, Dummy_Set_64, Dummy_Set_62, Dummy_Set_58, ASGoal, Set_221, Set_219, Set_217, Set_215, Set_213, Set_168, Set_166, Set_164, Set_162, Set_160, Set_117, Set_115, Set_113, Set_111, Set_109, Set_68, Set_66, Set_64, Set_62, Set_58: set(agent)
Dummy_Set_220, Dummy_Set_218, Dummy_Set_216, Dummy_Set_214, Dummy_Set_212, Dummy_Set_167, Dummy_Set_165, Dummy_Set_163, Dummy_Set_161, Dummy_Set_159, Dummy_Set_116, Dummy_Set_114, Dummy_Set_112, Dummy_Set_110, Dummy_Set_108, Dummy_Set_67, Dummy_Set_65, Dummy_Set_63, Dummy_Set_61, Dummy_Set_57, Set_220, Set_218, Set_216, Set_214, Set_212, Set_167, Set_165, Set_163, Set_161, Set_159, Set_116, Set_114, Set_112, Set_110, Set_108, Set_67, Set_65, Set_63, Set_61, Set_57: set(text)
MGoal, start: message
user_hgwn_ts1, user_hgwn_rni, hgwn_sensor_ts2, hgwn_sensor_rnk, sensor_user_ts3, sensor_user_rnj, s1, s2, s3, s4, s5: protocol_id
Dummy_Hi, Dummy_Gi, Dummy_SKuisnj, Dummy_RNk, Dummy_Fi, Dummy_Di, Dummy_Kj, Dummy_TS2, Dummy_Aif, Dummy_Aih, Dummy_RNj, Dummy_TS3, Dummy_RNi, Dummy_Ci, Dummy_Bi, Dummy_Ki, Dummy_TS1, Dummy_TIDi, Dummy_PWRi, Dummy_DIDi, dummy_nonce, ts1, ts2, ts3, MKGWNh, MKGWNf, IDSNj, MKSNj, Pj, Ki, Kj, Bi, Ci, Di, Fi, Gi, Hi, RNi, RNk, RNj, TIDi, IDGWNh, IDGWNf, TS1, TS2, TS3, SKuisnj, IDi, PWi, K, DIDi, PWRi, Aih, Aif, T: text
dummy_hash, h, gen, rep, Gen, Rep, H: hash_func
skuisa, SKuisa: symmetric_key
10, 9, 6, SID, 5, 4, Dummy_State, 3, SID2, SID1, State, 25, 24, 23, 21, 19, 2, 18, 1, 0, 16, 15, 13, 11: nat
dummy_agent, A2Goal, A1Goal, ui, gwn, snj, FGWN, Ui, SA, HGWN, SNj, sa, i: agent
set_406, set_405, set_404, set_403, set_402, set_401, set_400, set_399, set_397, set_396, set_395, set_394, set_393, set_392, set_391, set_390, set_389, set_388, set_386, set_385, set_384, set_383, set_382, set_381, set_380, set_379, set_378, set_377, set_376, set_375, set_374, set_373, set_372, set_371, set_370, set_369, set_368, set_367, set_351, set_350, set_349, set_348, set_347, set_346, set_345, set_344, set_343, set_342, set_324, set_323, set_322, set_321, set_320, set_319, set_318, set_317, set_316, set_315, set_300, set_299, set_298, set_297, set_296, set_295, set_294, set_293, set_292, set_291, set_264, set_263, set_262, set_261, set_260, set_259, set_258, set_257, set_256, set_255, set_538, set_537, set_536, set_535, set_534, set_533, set_532, set_531, set_530, set_529, set_527, set_526, set_525, set_524, set_523, set_522, set_521, set_520, set_519, set_518, set_516, set_515, set_514, set_513, set_512, set_511, set_510, set_509, set_508, set_507, set_505, set_504, set_503, set_502, set_501, set_500, set_499, set_498, set_497, set_496, set_494, set_493, set_492, set_491, set_490, set_489, set_488, set_487, set_486, set_485, set_484, set_483, set_482, set_481, set_480, set_479, set_478, set_477, set_476, set_475, set_473, set_472, set_471, set_470, set_469, set_468, set_467, set_466, set_465, set_464, set_462, set_461, set_460, set_459, set_458, set_457, set_456, set_455, set_454, set_453, set_451, set_450, set_449, set_448, set_447, set_446, set_445, set_444, set_443, set_442, set_440, set_439, set_438, set_437, set_436, set_435, set_434, set_433, set_432, set_431, set_430, set_429, set_428, set_427, set_426, set_425, set_424, set_423, set_422, set_421, set_419, set_418, set_417, set_416, set_415, set_414, set_413, set_412, set_411, set_410, set_408, set_407: set


section inits:

initial_state init1 := 
 iknows(start).
 iknows(ui).
 iknows(sa).
 iknows(gwn).
 iknows(snj).
 iknows(h).
 iknows(gen).
 iknows(rep).
 iknows(ts1).
 iknows(ts2).
 iknows(ts3).
 iknows(i).
 state_user(ui,sa,gwn,snj,skuisa,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_255,set_256,set_257,set_258,set_259,set_260,set_261,set_262,set_263,set_264,3).
 state_sa(sa,ui,gwn,snj,skuisa,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_291,set_292,set_293,set_294,set_295,set_296,set_297,set_298,set_299,set_300,4).
 state_hgwn(gwn,ui,sa,snj,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_315,set_316,set_317,set_318,set_319,set_320,set_321,set_322,set_323,set_324,5).
 state_sensor(snj,ui,sa,gwn,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_342,set_343,set_344,set_345,set_346,set_347,set_348,set_349,set_350,set_351,6).
 state_sa(sa,i,gwn,snj,skuisa,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_377,set_378,set_379,set_380,set_381,set_382,set_383,set_384,set_385,set_386,9).
 state_hgwn(gwn,i,sa,snj,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_388,set_389,set_390,set_391,set_392,set_393,set_394,set_395,set_396,set_397,10).
 state_sensor(snj,i,sa,gwn,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_399,set_400,set_401,set_402,set_403,set_404,set_405,set_406,set_407,set_408,11).
 state_user(ui,i,gwn,snj,skuisa,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_410,set_411,set_412,set_413,set_414,set_415,set_416,set_417,set_418,set_419,13).
 state_hgwn(gwn,ui,i,snj,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_431,set_432,set_433,set_434,set_435,set_436,set_437,set_438,set_439,set_440,15).
 state_sensor(snj,ui,i,gwn,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_442,set_443,set_444,set_445,set_446,set_447,set_448,set_449,set_450,set_451,16).
 state_user(ui,sa,i,snj,skuisa,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_453,set_454,set_455,set_456,set_457,set_458,set_459,set_460,set_461,set_462,18).
 state_sa(sa,ui,i,snj,skuisa,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_464,set_465,set_466,set_467,set_468,set_469,set_470,set_471,set_472,set_473,19).
 state_sensor(snj,ui,sa,i,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_485,set_486,set_487,set_488,set_489,set_490,set_491,set_492,set_493,set_494,21).
 state_user(ui,sa,gwn,i,skuisa,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_496,set_497,set_498,set_499,set_500,set_501,set_502,set_503,set_504,set_505,23).
 state_sa(sa,ui,gwn,i,skuisa,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_507,set_508,set_509,set_510,set_511,set_512,set_513,set_514,set_515,set_516,24).
 state_hgwn(gwn,ui,sa,i,h,0,dummy_agent,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_518,set_519,set_520,set_521,set_522,set_523,set_524,set_525,set_526,set_527,25)


section rules:

step step_0 (Ui,SA,HGWN,SNj,SKuisa,H,FGWN,IDi,PWi,K,Dummy_DIDi,Dummy_PWRi,Aih,Aif,T,TIDi,IDGWNh,IDGWNf,TS1,TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Kj,Bi,Ci,RNi,RNk,RNj,Dummy_Set_57,Dummy_Set_58,Set_61,Set_62,Set_63,Set_64,Set_65,Set_66,Set_67,Set_68,SID) :=
 state_user(Ui,SA,HGWN,SNj,SKuisa,H,0,FGWN,IDi,PWi,K,Dummy_DIDi,Dummy_PWRi,Aih,Aif,T,TIDi,IDGWNh,IDGWNf,TS1,TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Kj,Bi,Ci,RNi,RNk,RNj,Dummy_Set_57,Dummy_Set_58,Set_61,Set_62,Set_63,Set_64,Set_65,Set_66,Set_67,Set_68,SID).
 iknows(start)
 =>
 state_user(Ui,SA,HGWN,SNj,SKuisa,H,1,FGWN,IDi,PWi,K,apply(H,pair(IDi,K)),apply(H,pair(PWi,K)),Aih,Aif,T,TIDi,IDGWNh,IDGWNf,TS1,TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Kj,Bi,Ci,RNi,RNk,RNj,Dummy_Set_57,Dummy_Set_58,Set_61,Set_62,Set_63,Set_64,Set_65,Set_66,Set_67,Set_68,SID).
 secret(Dummy_Set_57,s1,Dummy_Set_58).
 iknows(scrypt(SKuisa,pair(apply(H,pair(IDi,K)),apply(H,pair(PWi,K))))).
 contains(IDi,Dummy_Set_57).
 contains(PWi,Dummy_Set_57).
 contains(K,Dummy_Set_57).
 contains(Ui,Dummy_Set_58)

step step_1 (Ui,SA,HGWN,SNj,SKuisa,H,FGWN,IDi,PWi,K,DIDi,PWRi,Aih,Aif,T,Dummy_TIDi,IDGWNh,IDGWNf,Dummy_TS1,TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Dummy_Ki,Kj,Dummy_Bi,Dummy_Ci,Dummy_RNi,RNk,RNj,Set_57,Set_58,Dummy_Set_61,Dummy_Set_62,Dummy_Set_63,Dummy_Set_64,Dummy_Set_65,Dummy_Set_66,Dummy_Set_67,Dummy_Set_68,SID,TIDi,TS1,RNi) :=
 state_user(Ui,SA,HGWN,SNj,SKuisa,H,1,FGWN,IDi,PWi,K,DIDi,PWRi,Aih,Aif,T,Dummy_TIDi,IDGWNh,IDGWNf,Dummy_TS1,TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Dummy_Ki,Kj,Dummy_Bi,Dummy_Ci,Dummy_RNi,RNk,RNj,Set_57,Set_58,Dummy_Set_61,Dummy_Set_62,Dummy_Set_63,Dummy_Set_64,Dummy_Set_65,Dummy_Set_66,Dummy_Set_67,Dummy_Set_68,SID).
 iknows(scrypt(SKuisa,pair(IDGWNh,pair(xor(apply(H,pair(IDGWNh,MKGWNh)),apply(H,pair(apply(H,pair(IDi,K)),pair(apply(H,pair(PWi,K)),TIDi)))),pair(IDGWNf,pair(xor(apply(H,pair(IDGWNf,MKGWNf)),apply(H,pair(apply(H,pair(IDi,K)),pair(apply(H,pair(PWi,K)),TIDi)))),pair(TIDi,pair(Gen,pair(Rep,pair(H,T))))))))))
=[exists TS1,RNi]=>
 state_user(Ui,SA,HGWN,SNj,SKuisa,H,2,FGWN,IDi,PWi,K,DIDi,PWRi,Aih,Aif,T,TIDi,IDGWNh,IDGWNf,TS1,TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,apply(H,pair(IDGWNh,MKGWNh)),Kj,apply(H,pair(apply(H,pair(IDi,K)),pair(TIDi,RNi))),scrypt(apply(H,pair(IDGWNh,MKGWNh)),pair(IDGWNh,pair(IDSNj,pair(apply(H,pair(apply(H,pair(IDi,K)),pair(TIDi,RNi))),pair(RNi,TS1))))),RNi,RNk,RNj,Set_57,Set_58,Dummy_Set_61,Dummy_Set_62,Dummy_Set_63,Dummy_Set_64,Dummy_Set_65,Dummy_Set_66,Dummy_Set_67,Dummy_Set_68,SID).
 secret(Dummy_Set_61,s2,Dummy_Set_62).
 secret(Dummy_Set_63,s3,Dummy_Set_64).
 secret(Dummy_Set_65,s4,Dummy_Set_66).
 secret(Dummy_Set_67,s5,Dummy_Set_68).
 iknows(pair(IDSNj,scrypt(apply(H,pair(IDGWNh,MKGWNh)),pair(IDGWNh,pair(IDSNj,pair(apply(H,pair(apply(H,pair(IDi,K)),pair(TIDi,RNi))),pair(RNi,TS1))))))).
 witness(Ui,HGWN,user_hgwn_ts1,TS1).
 witness(Ui,HGWN,user_hgwn_rni,RNi).
 contains(IDGWNh,Dummy_Set_61).
 contains(Ui,Dummy_Set_62).
 contains(SA,Dummy_Set_62).
 contains(HGWN,Dummy_Set_62).
 contains(MKGWNh,Dummy_Set_63).
 contains(SA,Dummy_Set_64).
 contains(HGWN,Dummy_Set_64).
 contains(IDGWNf,Dummy_Set_65).
 contains(Ui,Dummy_Set_66).
 contains(SA,Dummy_Set_66).
 contains(FGWN,Dummy_Set_66).
 contains(MKGWNf,Dummy_Set_67).
 contains(SA,Dummy_Set_68).
 contains(FGWN,Dummy_Set_68)

step step_2 (Ui,SA,HGWN,SNj,SKuisa,H,FGWN,IDi,PWi,K,DIDi,PWRi,Aih,Aif,T,TIDi,IDGWNh,IDGWNf,TS1,TS2,Dummy_TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Kj,Bi,Ci,Dummy_RNi,RNk,Dummy_RNj,Set_57,Set_58,Set_61,Set_62,Set_63,Set_64,Set_65,Set_66,Set_67,Set_68,SID,TS3,RNi,RNj) :=
 state_user(Ui,SA,HGWN,SNj,SKuisa,H,2,FGWN,IDi,PWi,K,DIDi,PWRi,Aih,Aif,T,TIDi,IDGWNh,IDGWNf,TS1,TS2,Dummy_TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Kj,Bi,Ci,Dummy_RNi,RNk,Dummy_RNj,Set_57,Set_58,Set_61,Set_62,Set_63,Set_64,Set_65,Set_66,Set_67,Set_68,SID).
 iknows(pair(IDSNj,pair(xor(apply(H,xor(apply(H,pair(IDi,K)),RNi)),RNj),apply(H,pair(apply(H,pair(IDGWNh,pair(IDSNj,pair(apply(H,xor(apply(H,pair(IDi,K)),RNi)),RNj)))),TS3)))))
 =>
 state_user(Ui,SA,HGWN,SNj,SKuisa,H,3,FGWN,IDi,PWi,K,DIDi,PWRi,Aih,Aif,T,TIDi,IDGWNh,IDGWNf,TS1,TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Kj,Bi,Ci,RNi,RNk,RNj,Set_57,Set_58,Set_61,Set_62,Set_63,Set_64,Set_65,Set_66,Set_67,Set_68,SID).
 request(SNj,Ui,sensor_user_ts3,TS3,SID).
 request(SNj,Ui,sensor_user_rnj,RNj,SID)

step step_3 (SA,Ui,HGWN,SNj,SKuisa,H,FGWN,IDi,PWi,K,DIDi,PWRi,Dummy_Aih,Dummy_Aif,T,Dummy_TIDi,IDGWNh,IDGWNf,TS1,TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Kj,Bi,Ci,Dummy_Set_108,Dummy_Set_109,Dummy_Set_110,Dummy_Set_111,Dummy_Set_112,Dummy_Set_113,Dummy_Set_114,Dummy_Set_115,Dummy_Set_116,Dummy_Set_117,SID,TIDi) :=
 state_sa(SA,Ui,HGWN,SNj,SKuisa,H,0,FGWN,IDi,PWi,K,DIDi,PWRi,Dummy_Aih,Dummy_Aif,T,Dummy_TIDi,IDGWNh,IDGWNf,TS1,TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Kj,Bi,Ci,Dummy_Set_108,Dummy_Set_109,Dummy_Set_110,Dummy_Set_111,Dummy_Set_112,Dummy_Set_113,Dummy_Set_114,Dummy_Set_115,Dummy_Set_116,Dummy_Set_117,SID).
 iknows(scrypt(SKuisa,pair(apply(H,pair(IDi,K)),apply(H,pair(PWi,K)))))
=[exists TIDi]=>
 state_sa(SA,Ui,HGWN,SNj,SKuisa,H,2,FGWN,IDi,PWi,K,DIDi,PWRi,xor(apply(H,pair(IDGWNh,MKGWNh)),apply(H,pair(apply(H,pair(IDi,K)),pair(apply(H,pair(PWi,K)),TIDi)))),xor(apply(H,pair(IDGWNf,MKGWNf)),apply(H,pair(apply(H,pair(IDi,K)),pair(apply(H,pair(PWi,K)),TIDi)))),T,TIDi,IDGWNh,IDGWNf,TS1,TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Kj,Bi,Ci,Dummy_Set_108,Dummy_Set_109,Dummy_Set_110,Dummy_Set_111,Dummy_Set_112,Dummy_Set_113,Dummy_Set_114,Dummy_Set_115,Dummy_Set_116,Dummy_Set_117,SID).
 secret(Dummy_Set_108,s1,Dummy_Set_109).
 iknows(scrypt(SKuisa,pair(IDGWNh,pair(xor(apply(H,pair(IDGWNh,MKGWNh)),apply(H,pair(apply(H,pair(IDi,K)),pair(apply(H,pair(PWi,K)),TIDi)))),pair(IDGWNf,pair(xor(apply(H,pair(IDGWNf,MKGWNf)),apply(H,pair(apply(H,pair(IDi,K)),pair(apply(H,pair(PWi,K)),TIDi)))),pair(TIDi,pair(Gen,pair(Rep,pair(H,T)))))))))).
 secret(Dummy_Set_110,s2,Dummy_Set_111).
 secret(Dummy_Set_112,s3,Dummy_Set_113).
 secret(Dummy_Set_114,s4,Dummy_Set_115).
 secret(Dummy_Set_116,s5,Dummy_Set_117).
 contains(IDi,Dummy_Set_108).
 contains(PWi,Dummy_Set_108).
 contains(K,Dummy_Set_108).
 contains(Ui,Dummy_Set_109).
 contains(IDGWNh,Dummy_Set_110).
 contains(Ui,Dummy_Set_111).
 contains(SA,Dummy_Set_111).
 contains(HGWN,Dummy_Set_111).
 contains(MKGWNh,Dummy_Set_112).
 contains(SA,Dummy_Set_113).
 contains(HGWN,Dummy_Set_113).
 contains(IDGWNf,Dummy_Set_114).
 contains(Ui,Dummy_Set_115).
 contains(SA,Dummy_Set_115).
 contains(FGWN,Dummy_Set_115).
 contains(MKGWNf,Dummy_Set_116).
 contains(SA,Dummy_Set_117).
 contains(FGWN,Dummy_Set_117)

step step_4 (HGWN,Ui,SA,SNj,H,FGWN,IDi,PWi,K,DIDi,PWRi,Aih,Aif,T,Dummy_TIDi,IDGWNh,IDGWNf,Dummy_TS1,Dummy_TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Dummy_Kj,Bi,Ci,Dummy_Di,Dummy_Fi,Gi,Dummy_RNi,Dummy_RNk,RNj,Dummy_Set_159,Dummy_Set_160,Dummy_Set_161,Dummy_Set_162,Dummy_Set_163,Dummy_Set_164,Dummy_Set_165,Dummy_Set_166,Dummy_Set_167,Dummy_Set_168,SID,TIDi,TS1,TS2,RNi,RNk) :=
 state_hgwn(HGWN,Ui,SA,SNj,H,0,FGWN,IDi,PWi,K,DIDi,PWRi,Aih,Aif,T,Dummy_TIDi,IDGWNh,IDGWNf,Dummy_TS1,Dummy_TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Dummy_Kj,Bi,Ci,Dummy_Di,Dummy_Fi,Gi,Dummy_RNi,Dummy_RNk,RNj,Dummy_Set_159,Dummy_Set_160,Dummy_Set_161,Dummy_Set_162,Dummy_Set_163,Dummy_Set_164,Dummy_Set_165,Dummy_Set_166,Dummy_Set_167,Dummy_Set_168,SID).
 iknows(pair(IDSNj,scrypt(apply(H,pair(IDGWNh,MKGWNh)),pair(IDGWNh,pair(IDSNj,pair(apply(H,pair(apply(H,pair(IDi,K)),pair(TIDi,RNi))),pair(RNi,TS1)))))))
=[exists RNk,TS2]=>
 state_hgwn(HGWN,Ui,SA,SNj,H,3,FGWN,IDi,PWi,K,DIDi,PWRi,Aih,Aif,T,TIDi,IDGWNh,IDGWNf,TS1,TS2,TS3,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,apply(H,pair(IDSNj,MKSNj)),Bi,Ci,apply(H,pair(apply(H,xor(apply(H,pair(IDi,K)),RNi)),pair(RNi,pair(RNk,TS2)))),scrypt(apply(H,pair(IDSNj,MKSNj)),pair(IDGWNh,pair(IDSNj,pair(apply(H,xor(apply(H,pair(IDi,K)),RNi)),pair(RNi,pair(RNk,pair(apply(H,pair(apply(H,xor(apply(H,pair(IDi,K)),RNi)),pair(RNi,pair(RNk,TS2)))),TS2))))))),Gi,RNi,RNk,RNj,Dummy_Set_159,Dummy_Set_160,Dummy_Set_161,Dummy_Set_162,Dummy_Set_163,Dummy_Set_164,Dummy_Set_165,Dummy_Set_166,Dummy_Set_167,Dummy_Set_168,SID).
 secret(Dummy_Set_159,s1,Dummy_Set_160).
 secret(Dummy_Set_161,s2,Dummy_Set_162).
 secret(Dummy_Set_163,s3,Dummy_Set_164).
 secret(Dummy_Set_165,s4,Dummy_Set_166).
 secret(Dummy_Set_167,s5,Dummy_Set_168).
 iknows(pair(IDSNj,scrypt(apply(H,pair(IDSNj,MKSNj)),pair(IDGWNh,pair(IDSNj,pair(apply(H,xor(apply(H,pair(IDi,K)),RNi)),pair(RNi,pair(RNk,pair(apply(H,pair(apply(H,xor(apply(H,pair(IDi,K)),RNi)),pair(RNi,pair(RNk,TS2)))),TS2))))))))).
 witness(HGWN,SNj,hgwn_sensor_ts2,TS2).
 witness(HGWN,SNj,hgwn_sensor_rnk,RNk).
 request(Ui,HGWN,user_hgwn_ts1,TS1,SID).
 request(Ui,HGWN,user_hgwn_rni,RNi,SID).
 contains(IDi,Dummy_Set_159).
 contains(PWi,Dummy_Set_159).
 contains(K,Dummy_Set_159).
 contains(Ui,Dummy_Set_160).
 contains(IDGWNh,Dummy_Set_161).
 contains(Ui,Dummy_Set_162).
 contains(SA,Dummy_Set_162).
 contains(HGWN,Dummy_Set_162).
 contains(MKGWNh,Dummy_Set_163).
 contains(SA,Dummy_Set_164).
 contains(HGWN,Dummy_Set_164).
 contains(IDGWNf,Dummy_Set_165).
 contains(Ui,Dummy_Set_166).
 contains(SA,Dummy_Set_166).
 contains(FGWN,Dummy_Set_166).
 contains(MKGWNf,Dummy_Set_167).
 contains(SA,Dummy_Set_168).
 contains(FGWN,Dummy_Set_168)

step step_5 (SNj,Ui,SA,HGWN,H,FGWN,IDi,PWi,K,DIDi,PWRi,Aih,Aif,T,TIDi,IDGWNh,IDGWNf,TS1,Dummy_TS2,Dummy_TS3,Dummy_SKuisnj,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Kj,Bi,Ci,Di,Fi,Dummy_Gi,Dummy_Hi,Dummy_RNi,Dummy_RNk,Dummy_RNj,Dummy_Set_212,Dummy_Set_213,Dummy_Set_214,Dummy_Set_215,Dummy_Set_216,Dummy_Set_217,Dummy_Set_218,Dummy_Set_219,Dummy_Set_220,Dummy_Set_221,SID,TS2,TS3,RNi,RNk,RNj) :=
 state_sensor(SNj,Ui,SA,HGWN,H,0,FGWN,IDi,PWi,K,DIDi,PWRi,Aih,Aif,T,TIDi,IDGWNh,IDGWNf,TS1,Dummy_TS2,Dummy_TS3,Dummy_SKuisnj,Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Kj,Bi,Ci,Di,Fi,Dummy_Gi,Dummy_Hi,Dummy_RNi,Dummy_RNk,Dummy_RNj,Dummy_Set_212,Dummy_Set_213,Dummy_Set_214,Dummy_Set_215,Dummy_Set_216,Dummy_Set_217,Dummy_Set_218,Dummy_Set_219,Dummy_Set_220,Dummy_Set_221,SID).
 iknows(pair(IDSNj,scrypt(apply(H,pair(IDSNj,MKSNj)),pair(IDGWNh,pair(IDSNj,pair(apply(H,xor(apply(H,pair(IDi,K)),RNi)),pair(RNi,pair(RNk,pair(apply(H,pair(apply(H,xor(apply(H,pair(IDi,K)),RNi)),pair(RNi,pair(RNk,TS2)))),TS2)))))))))
=[exists TS3,RNj]=>
 state_sensor(SNj,Ui,SA,HGWN,H,2,FGWN,IDi,PWi,K,DIDi,PWRi,Aih,Aif,T,TIDi,IDGWNh,IDGWNf,TS1,TS2,TS3,apply(H,pair(IDGWNh,pair(IDSNj,pair(apply(H,xor(apply(H,pair(IDi,K)),RNi)),RNj)))),Gen,Rep,MKGWNh,MKGWNf,IDSNj,MKSNj,Pj,Ki,Kj,Bi,Ci,Di,Fi,xor(apply(H,xor(apply(H,pair(IDi,K)),RNi)),RNj),apply(H,pair(apply(H,pair(IDGWNh,pair(IDSNj,pair(apply(H,xor(apply(H,pair(IDi,K)),RNi)),RNj)))),TS3)),RNi,RNk,RNj,Dummy_Set_212,Dummy_Set_213,Dummy_Set_214,Dummy_Set_215,Dummy_Set_216,Dummy_Set_217,Dummy_Set_218,Dummy_Set_219,Dummy_Set_220,Dummy_Set_221,SID).
 secret(Dummy_Set_212,s1,Dummy_Set_213).
 secret(Dummy_Set_214,s2,Dummy_Set_215).
 secret(Dummy_Set_216,s3,Dummy_Set_217).
 secret(Dummy_Set_218,s4,Dummy_Set_219).
 secret(Dummy_Set_220,s5,Dummy_Set_221).
 iknows(pair(IDSNj,pair(xor(apply(H,xor(apply(H,pair(IDi,K)),RNi)),RNj),pair(apply(H,pair(apply(H,pair(IDGWNh,pair(IDSNj,pair(apply(H,xor(apply(H,pair(IDi,K)),RNi)),RNj)))),TS3)),TS3)))).
 witness(SNj,Ui,sensor_user_ts3,TS3).
 witness(SNj,Ui,sensor_user_rnj,RNj).
 request(HGWN,SNj,hgwn_sensor_ts2,TS2,SID).
 request(HGWN,SNj,hgwn_sensor_rnk,RNk,SID).
 contains(IDi,Dummy_Set_212).
 contains(PWi,Dummy_Set_212).
 contains(K,Dummy_Set_212).
 contains(Ui,Dummy_Set_213).
 contains(IDGWNh,Dummy_Set_214).
 contains(Ui,Dummy_Set_215).
 contains(SA,Dummy_Set_215).
 contains(HGWN,Dummy_Set_215).
 contains(MKGWNh,Dummy_Set_216).
 contains(SA,Dummy_Set_217).
 contains(HGWN,Dummy_Set_217).
 contains(IDGWNf,Dummy_Set_218).
 contains(Ui,Dummy_Set_219).
 contains(SA,Dummy_Set_219).
 contains(FGWN,Dummy_Set_219).
 contains(MKGWNf,Dummy_Set_220).
 contains(SA,Dummy_Set_221).
 contains(FGWN,Dummy_Set_221)


section properties:

property secrecy_of_s1 (MGoal,ASGoal) :=
 [] ((secret(MGoal,s1,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_s2 (MGoal,ASGoal) :=
 [] ((secret(MGoal,s2,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_s3 (MGoal,ASGoal) :=
 [] ((secret(MGoal,s3,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_s4 (MGoal,ASGoal) :=
 [] ((secret(MGoal,s4,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_s5 (MGoal,ASGoal) :=
 [] ((secret(MGoal,s5,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property authentication_on_user_hgwn_ts1 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,user_hgwn_ts1,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,user_hgwn_ts1,MGoal))
     /\ ((request(A1Goal,A2Goal,user_hgwn_ts1,MGoal,SID1)
           /\ request(A1Goal,A2Goal,user_hgwn_ts1,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_user_hgwn_rni (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,user_hgwn_rni,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,user_hgwn_rni,MGoal))
     /\ ((request(A1Goal,A2Goal,user_hgwn_rni,MGoal,SID1)
           /\ request(A1Goal,A2Goal,user_hgwn_rni,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_hgwn_sensor_ts2 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,hgwn_sensor_ts2,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,hgwn_sensor_ts2,MGoal))
     /\ ((request(A1Goal,A2Goal,hgwn_sensor_ts2,MGoal,SID1)
           /\ request(A1Goal,A2Goal,hgwn_sensor_ts2,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_hgwn_sensor_rnk (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,hgwn_sensor_rnk,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,hgwn_sensor_rnk,MGoal))
     /\ ((request(A1Goal,A2Goal,hgwn_sensor_rnk,MGoal,SID1)
           /\ request(A1Goal,A2Goal,hgwn_sensor_rnk,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_sensor_user_ts3 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,sensor_user_ts3,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,sensor_user_ts3,MGoal))
     /\ ((request(A1Goal,A2Goal,sensor_user_ts3,MGoal,SID1)
           /\ request(A1Goal,A2Goal,sensor_user_ts3,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_sensor_user_rnj (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,sensor_user_rnj,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,sensor_user_rnj,MGoal))
     /\ ((request(A1Goal,A2Goal,sensor_user_rnj,MGoal,SID1)
           /\ request(A1Goal,A2Goal,sensor_user_rnj,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))


section attack_states:

attack_state secrecy_of_s1 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,s1,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_s2 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,s2,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_s3 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,s3,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_s4 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,s4,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_s5 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,s5,ASGoal) &
 not(contains(i,ASGoal))

attack_state authentication_on_user_hgwn_ts1 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,user_hgwn_ts1,MGoal,SID) &
 not(witness(A2Goal,A1Goal,user_hgwn_ts1,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_user_hgwn_ts1 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,user_hgwn_ts1,MGoal,SID1).
 request(A1Goal,A2Goal,user_hgwn_ts1,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_user_hgwn_rni (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,user_hgwn_rni,MGoal,SID) &
 not(witness(A2Goal,A1Goal,user_hgwn_rni,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_user_hgwn_rni (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,user_hgwn_rni,MGoal,SID1).
 request(A1Goal,A2Goal,user_hgwn_rni,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_hgwn_sensor_ts2 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,hgwn_sensor_ts2,MGoal,SID) &
 not(witness(A2Goal,A1Goal,hgwn_sensor_ts2,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_hgwn_sensor_ts2 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,hgwn_sensor_ts2,MGoal,SID1).
 request(A1Goal,A2Goal,hgwn_sensor_ts2,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_hgwn_sensor_rnk (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,hgwn_sensor_rnk,MGoal,SID) &
 not(witness(A2Goal,A1Goal,hgwn_sensor_rnk,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_hgwn_sensor_rnk (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,hgwn_sensor_rnk,MGoal,SID1).
 request(A1Goal,A2Goal,hgwn_sensor_rnk,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_sensor_user_ts3 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,sensor_user_ts3,MGoal,SID) &
 not(witness(A2Goal,A1Goal,sensor_user_ts3,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_sensor_user_ts3 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,sensor_user_ts3,MGoal,SID1).
 request(A1Goal,A2Goal,sensor_user_ts3,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_sensor_user_rnj (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,sensor_user_rnj,MGoal,SID) &
 not(witness(A2Goal,A1Goal,sensor_user_rnj,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_sensor_user_rnj (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,sensor_user_rnj,MGoal,SID1).
 request(A1Goal,A2Goal,sensor_user_rnj,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

