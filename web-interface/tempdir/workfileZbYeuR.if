%% IF specification of /home/avispa/web-interface-computation/./tempdir/workfileZbYeuR

section signature:

state_user: agent * agent * agent * symmetric_key * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * hash_func * hash_func * hash_func * set(text) * nat -> fact
state_rc: agent * agent * agent * symmetric_key * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * hash_func * hash_func * hash_func * set(text) * set(text) * nat -> fact
state_server: agent * agent * agent * symmetric_key * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * hash_func * hash_func * hash_func * set(text) * set(agent) * set(text) * nat -> fact


section types:

set_185, set_183, set_182, set_180, set_179, set_178, set_176, set_174, set_173, set_171, set_170, set_169, set_165, set_159, set_158, set_144, set_143, set_142: set
Dummy_Set_47, Set_47, ASGoal: set(agent)
start, MGoal: message
user_server_n1, server_rc_n2, user_rc_n1, s1, s2, s3, s4, s5, s6: protocol_id
State, 13, 12, 11, 9, 8, 7, 5, SID, 4, 3, Dummy_State, 2, 1, 0, SID2, SID1: nat
Set_83, Set_82, Dummy_Set_112, Dummy_Set_83, Dummy_Set_82, Dummy_Set_49, Set_49, Dummy_Set_44, Set_44, Set_112: set(text)
SKuirc, SKsjrc, skuirc, sksjrc: symmetric_key
H, F, Gen, Rep, dummy_hash, f, gen, rep, h: hash_func
Sj, RC, Ui, rc, A2Goal, A1Goal, sj, ui, i: agent
SIDj, IDi, Ri, Rj, PWi, Bi, Y, Ki, Kj, Xi, SSj, N1, N2, K, P, Dummy_Ri, Dummy_Y, Dummy_N2, Dummy_N1, Dummy_Xi, Dummy_Rj, dummy_nonce: text


section inits:

initial_state init1 := 
 iknows(start).
 iknows(sj).
 iknows(rc).
 iknows(ui).
 iknows(h).
 iknows(f).
 iknows(gen).
 iknows(rep).
 iknows(i).
 state_server(sj,rc,ui,sksjrc,skuirc,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_hash,set_142,set_143,set_144,3).
 state_rc(rc,sj,ui,sksjrc,skuirc,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_hash,set_158,set_159,4).
 state_user(ui,sj,rc,sksjrc,skuirc,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_hash,set_165,5).
 state_server(sj,rc,ui,sksjrc,skuirc,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_hash,set_169,set_170,set_171,7).
 state_rc(rc,sj,ui,sksjrc,skuirc,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_hash,set_173,set_174,8).
 state_user(ui,sj,rc,sksjrc,skuirc,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_hash,set_176,9).
 state_server(sj,rc,ui,sksjrc,skuirc,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_hash,set_178,set_179,set_180,11).
 state_rc(rc,sj,ui,sksjrc,skuirc,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_hash,set_182,set_183,12).
 state_user(ui,sj,rc,sksjrc,skuirc,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_hash,dummy_hash,dummy_hash,set_185,13)


section rules:

step step_0 (Sj,RC,Ui,SKsjrc,SKuirc,H,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Dummy_Set_44,Set_47,Set_49,SID) :=
 state_server(Sj,RC,Ui,SKsjrc,SKuirc,H,0,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Dummy_Set_44,Set_47,Set_49,SID).
 iknows(start)
 =>
 state_server(Sj,RC,Ui,SKsjrc,SKuirc,H,1,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Dummy_Set_44,Set_47,Set_49,SID).
 iknows(scrypt(SKsjrc,SIDj)).
 secret(Dummy_Set_44,s1,Ui).
 secret(K,s2,RC).
 contains(PWi,Dummy_Set_44).
 contains(Bi,Dummy_Set_44)

step step_1 (Sj,RC,Ui,SKsjrc,SKuirc,H,SIDj,IDi,Ri,Dummy_Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Set_44,Dummy_Set_47,Set_49,SID,Rj) :=
 state_server(Sj,RC,Ui,SKsjrc,SKuirc,H,1,SIDj,IDi,Ri,Dummy_Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Set_44,Dummy_Set_47,Set_49,SID).
 iknows(scrypt(SKsjrc,pair(apply(H,pair(SIDj,pair(K,Rj))),apply(H,pair(K,pair(Rj,pair(apply(H,pair(SIDj,pair(K,Rj))),SIDj)))))))
 =>
 state_server(Sj,RC,Ui,SKsjrc,SKuirc,H,2,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Set_44,Dummy_Set_47,Set_49,SID).
 secret(Ki,s4,Dummy_Set_47).
 contains(Ui,Dummy_Set_47).
 contains(RC,Dummy_Set_47)

step step_2 (Sj,RC,Ui,SKsjrc,SKuirc,H,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Dummy_Xi,SSj,Dummy_N1,Dummy_N2,K,P,Gen,Rep,F,Set_44,Set_47,Dummy_Set_49,SID,Xi,N1,N2) :=
 state_server(Sj,RC,Ui,SKsjrc,SKuirc,H,2,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Dummy_Xi,SSj,Dummy_N1,Dummy_N2,K,P,Gen,Rep,F,Set_44,Set_47,Dummy_Set_49,SID).
 iknows(pair(scrypt(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P)))),pair(IDi,pair(SIDj,pair(SSj,N1)))),pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))))))
=[exists N2]=>
 state_server(Sj,RC,Ui,SKsjrc,SKuirc,H,3,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Set_44,Set_47,Dummy_Set_49,SID).
 secret(Xi,s3,Ui).
 iknows(pair(scrypt(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P)))),pair(IDi,pair(SIDj,pair(SSj,N1)))),pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),pair(apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))),pair(scrypt(apply(H,pair(Kj,apply(H,pair(IDi,pair(SIDj,pair(Sj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))))),Dummy_N2),apply(H,pair(scrypt(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P)))),pair(IDi,pair(SIDj,pair(SSj,N1)))),pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),pair(apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))),pair(SIDj,pair(Kj,pair(SSj,N2)))))))))))).
 secret(Dummy_Set_49,s5,Sj).
 contains(Kj,Dummy_Set_49)

step step_3 (Sj,RC,Ui,SKsjrc,SKuirc,H,SIDj,IDi,Ri,Rj,PWi,Bi,Dummy_Y,Ki,Kj,Dummy_Xi,SSj,Dummy_N1,Dummy_N2,K,P,Gen,Rep,F,Set_44,Set_47,Set_49,SID,Y,Xi,N1,N2) :=
 state_server(Sj,RC,Ui,SKsjrc,SKuirc,H,3,SIDj,IDi,Ri,Rj,PWi,Bi,Dummy_Y,Ki,Kj,Dummy_Xi,SSj,Dummy_N1,Dummy_N2,K,P,Gen,Rep,F,Set_44,Set_47,Set_49,SID).
 iknows(pair(scrypt(apply(H,pair(Kj,pair(apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))),N2))),pair(SIDj,apply(H,pair(Ki,pair(apply(F,pair(K,apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)))),N1))))),apply(H,pair(Kj,pair(apply(H,pair(scrypt(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P)))),pair(IDi,pair(SIDj,pair(Sj,N1)))),pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),pair(apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))),pair(SIDj,pair(Kj,pair(SSj,N2))))))),pair(scrypt(apply(H,pair(Kj,pair(apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))),N2))),pair(SIDj,apply(H,pair(Ki,pair(apply(F,pair(K,apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)))),N1))))),pair(SIDj,pair(apply(H,pair(Ki,pair(apply(F,pair(K,apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)))),N1))),pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),N2)))))))))
=[exists Y]=>
 state_server(Sj,RC,Ui,SKsjrc,SKuirc,H,4,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Set_44,Set_47,Set_49,SID).
 secret(Y,s6,Sj).
 iknows(pair(apply(F,pair(Y,P)),apply(H,pair(SIDj,pair(SSj,pair(apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))),pair(apply(H,pair(Ki,pair(apply(F,pair(K,apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)))),N1))),pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),pair(apply(F,pair(Y,P)),apply(H,pair(apply(F,pair(Y,apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)))),pair(apply(H,pair(Ki,pair(apply(F,pair(K,apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)))),N1))),SSj)))))))))))).
 witness(Sj,RC,server_rc_n2,N2)

step step_4 (Sj,RC,Ui,SKsjrc,SKuirc,H,SIDj,IDi,Ri,Rj,PWi,Bi,Dummy_Y,Ki,Kj,Dummy_Xi,SSj,Dummy_N1,N2,K,P,Gen,Rep,F,Set_44,Set_47,Set_49,SID,Y,Xi,N1) :=
 state_server(Sj,RC,Ui,SKsjrc,SKuirc,H,4,SIDj,IDi,Ri,Rj,PWi,Bi,Dummy_Y,Ki,Kj,Dummy_Xi,SSj,Dummy_N1,N2,K,P,Gen,Rep,F,Set_44,Set_47,Set_49,SID).
 iknows(apply(H,pair(SIDj,pair(apply(H,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P)))),N1))),pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),pair(apply(F,pair(Y,P)),apply(H,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(Y,P)))),pair(apply(H,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P)))),N1))),SSj)))))))))
 =>
 state_server(Sj,RC,Ui,SKsjrc,SKuirc,H,5,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Set_44,Set_47,Set_49,SID).
 request(Ui,Sj,user_server_n1,N1,SID)

step step_5 (RC,Sj,Ui,SKsjrc,SKuirc,H,SIDj,IDi,Ri,Dummy_Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Dummy_Set_82,Set_83,SID,Rj) :=
 state_rc(RC,Sj,Ui,SKsjrc,SKuirc,H,0,SIDj,IDi,Ri,Dummy_Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Dummy_Set_82,Set_83,SID).
 iknows(scrypt(SKsjrc,SIDj))
=[exists Rj]=>
 state_rc(RC,Sj,Ui,SKsjrc,SKuirc,H,1,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Dummy_Set_82,Set_83,SID).
 secret(Dummy_Set_82,s1,Ui).
 secret(K,s2,RC).
 iknows(scrypt(SKsjrc,pair(apply(H,pair(SIDj,pair(K,Rj))),apply(H,pair(K,pair(Rj,pair(apply(H,pair(SIDj,pair(K,Rj))),SIDj))))))).
 contains(PWi,Dummy_Set_82).
 contains(Bi,Dummy_Set_82)

step step_6 (RC,Sj,Ui,SKsjrc,SKuirc,H,SIDj,IDi,Dummy_Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Set_82,Set_83,SID,Ri) :=
 state_rc(RC,Sj,Ui,SKsjrc,SKuirc,H,1,SIDj,IDi,Dummy_Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Set_82,Set_83,SID).
 iknows(scrypt(SKuirc,pair(IDi,apply(H,pair(PWi,apply(Gen,Bi))))))
=[exists Ri]=>
 state_rc(RC,Sj,Ui,SKsjrc,SKuirc,H,2,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Set_82,Set_83,SID).
 iknows(scrypt(SKuirc,pair(xor(apply(H,pair(IDi,pair(K,pair(Ri,apply(H,pair(IDi,K)))))),apply(H,pair(PWi,apply(Gen,Bi)))),apply(H,pair(apply(H,pair(IDi,pair(K,pair(Ri,apply(H,pair(IDi,K)))))),pair(IDi,apply(H,pair(PWi,apply(Gen,Bi)))))))))

step step_7 (RC,Sj,Ui,SKsjrc,SKuirc,H,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Dummy_Xi,SSj,Dummy_N1,Dummy_N2,K,P,Gen,Rep,F,Set_82,Dummy_Set_83,SID,Xi,N1,N2) :=
 state_rc(RC,Sj,Ui,SKsjrc,SKuirc,H,2,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Dummy_Xi,SSj,Dummy_N1,Dummy_N2,K,P,Gen,Rep,F,Set_82,Dummy_Set_83,SID).
 iknows(pair(scrypt(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P)))),pair(IDi,pair(SIDj,pair(SSj,N1)))),pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),pair(apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))),pair(scrypt(apply(H,pair(Kj,apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))))),Dummy_N2),apply(H,pair(scrypt(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P)))),pair(IDi,pair(SIDj,pair(SSj,N1)))),pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),pair(apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))),pair(SIDj,pair(Kj,pair(SSj,N2))))))))))))
 =>
 state_rc(RC,Sj,Ui,SKsjrc,SKuirc,H,3,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Set_82,Dummy_Set_83,SID).
 secret(Dummy_Set_83,s5,Sj).
 iknows(pair(scrypt(apply(H,pair(Kj,pair(apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Dummy_Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Dummy_Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))),N2))),pair(SIDj,apply(H,pair(Ki,pair(apply(F,pair(K,apply(F,pair(apply(H,pair(Dummy_Xi,pair(Ki,N1))),P)))),N1))))),apply(H,pair(Kj,pair(apply(H,pair(scrypt(apply(F,pair(apply(H,pair(Dummy_Xi,pair(Ki,N1))),apply(F,pair(K,P)))),pair(IDi,pair(SIDj,pair(SSj,N1)))),pair(apply(F,pair(apply(H,pair(Dummy_Xi,pair(Ki,N1))),P)),pair(apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Dummy_Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Dummy_Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))),pair(SIDj,pair(Kj,pair(SSj,N2))))))),pair(scrypt(apply(H,pair(Kj,pair(apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Dummy_Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Dummy_Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))),N2))),pair(SIDj,apply(H,pair(Ki,pair(apply(F,pair(K,apply(F,pair(apply(H,pair(Dummy_Xi,pair(Ki,N1))),P)))),N1))))),pair(SIDj,pair(apply(H,pair(Ki,pair(apply(F,pair(K,apply(F,pair(apply(H,pair(Dummy_Xi,pair(Ki,N1))),P)))),N1))),pair(apply(F,pair(apply(H,pair(Dummy_Xi,pair(Ki,N1))),P)),N2))))))))).
 request(Ui,RC,user_rc_n1,N1,SID).
 request(Sj,RC,server_rc_n2,N2,SID).
 contains(Kj,Dummy_Set_83)

step step_8 (Ui,Sj,RC,SKsjrc,SKuirc,H,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Dummy_Set_112,SID) :=
 state_user(Ui,Sj,RC,SKsjrc,SKuirc,H,0,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Dummy_Set_112,SID).
 iknows(start)
 =>
 state_user(Ui,Sj,RC,SKsjrc,SKuirc,H,1,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Dummy_Set_112,SID).
 iknows(scrypt(SKuirc,pair(IDi,apply(H,pair(PWi,apply(Gen,Bi)))))).
 secret(Dummy_Set_112,s1,Ui).
 secret(K,s2,RC).
 contains(PWi,Dummy_Set_112).
 contains(Bi,Dummy_Set_112)

step step_9 (Ui,Sj,RC,SKsjrc,SKuirc,H,SIDj,IDi,Dummy_Ri,Rj,PWi,Bi,Y,Ki,Kj,Dummy_Xi,SSj,Dummy_N1,N2,K,P,Gen,Rep,F,Set_112,SID,Ri,Xi,N1) :=
 state_user(Ui,Sj,RC,SKsjrc,SKuirc,H,1,SIDj,IDi,Dummy_Ri,Rj,PWi,Bi,Y,Ki,Kj,Dummy_Xi,SSj,Dummy_N1,N2,K,P,Gen,Rep,F,Set_112,SID).
 iknows(scrypt(SKuirc,pair(xor(apply(H,pair(IDi,pair(K,pair(Ri,apply(H,pair(IDi,K)))))),apply(H,pair(PWi,apply(Gen,Bi)))),apply(H,pair(apply(H,pair(IDi,pair(K,pair(Ri,apply(H,pair(IDi,K)))))),pair(IDi,apply(H,pair(PWi,apply(Gen,Bi)))))))))
=[exists N1,Xi]=>
 state_user(Ui,Sj,RC,SKsjrc,SKuirc,H,2,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Set_112,SID).
 iknows(pair(scrypt(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P)))),pair(IDi,pair(SIDj,pair(SSj,N1)))),pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P)))))))))))))).
 witness(Ui,Sj,user_server_n1,N1).
 witness(Ui,RC,user_rc_n1,N1)

step step_10 (Ui,Sj,RC,SKsjrc,SKuirc,H,SIDj,IDi,Ri,Rj,PWi,Bi,Dummy_Y,Ki,Kj,Dummy_Xi,SSj,Dummy_N1,N2,K,P,Gen,Rep,F,Set_112,SID,Y,Xi,N1) :=
 state_user(Ui,Sj,RC,SKsjrc,SKuirc,H,2,SIDj,IDi,Ri,Rj,PWi,Bi,Dummy_Y,Ki,Kj,Dummy_Xi,SSj,Dummy_N1,N2,K,P,Gen,Rep,F,Set_112,SID).
 iknows(pair(apply(F,pair(Y,P)),apply(H,pair(SIDj,pair(SSj,pair(apply(H,pair(IDi,pair(SIDj,pair(SSj,pair(N1,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P))))))))))),pair(apply(H,pair(Ki,pair(apply(F,pair(K,apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)))),N1))),pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),pair(apply(F,pair(Y,P)),apply(H,pair(apply(F,pair(Y,apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)))),pair(apply(H,pair(Ki,pair(apply(F,pair(K,apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)))),N1))),SSj))))))))))))
 =>
 state_user(Ui,Sj,RC,SKsjrc,SKuirc,H,3,SIDj,IDi,Ri,Rj,PWi,Bi,Y,Ki,Kj,Xi,SSj,N1,N2,K,P,Gen,Rep,F,Set_112,SID).
 iknows(apply(H,pair(SIDj,pair(apply(H,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P)))),N1))),pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),P)),pair(apply(F,pair(Y,P)),apply(H,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(Y,P)))),pair(apply(H,pair(Ki,pair(apply(F,pair(apply(H,pair(Xi,pair(Ki,N1))),apply(F,pair(K,P)))),N1))),SSj)))))))))


section properties:

property secrecy_of_s1 (MGoal,ASGoal) :=
 [] ((secret(MGoal,s1,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_s2 (MGoal,ASGoal) :=
 [] ((secret(MGoal,s2,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_s3 (MGoal,ASGoal) :=
 [] ((secret(MGoal,s3,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_s4 (MGoal,ASGoal) :=
 [] ((secret(MGoal,s4,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_s5 (MGoal,ASGoal) :=
 [] ((secret(MGoal,s5,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_s6 (MGoal,ASGoal) :=
 [] ((secret(MGoal,s6,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property authentication_on_server_rc_n2 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,server_rc_n2,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,server_rc_n2,MGoal))
     /\ ((request(A1Goal,A2Goal,server_rc_n2,MGoal,SID1)
           /\ request(A1Goal,A2Goal,server_rc_n2,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_user_server_n1 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,user_server_n1,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,user_server_n1,MGoal))
     /\ ((request(A1Goal,A2Goal,user_server_n1,MGoal,SID1)
           /\ request(A1Goal,A2Goal,user_server_n1,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_user_rc_n1 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,user_rc_n1,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,user_rc_n1,MGoal))
     /\ ((request(A1Goal,A2Goal,user_rc_n1,MGoal,SID1)
           /\ request(A1Goal,A2Goal,user_rc_n1,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))


section attack_states:

attack_state secrecy_of_s1 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,s1,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_s2 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,s2,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_s3 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,s3,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_s4 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,s4,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_s5 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,s5,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_s6 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,s6,ASGoal) &
 not(contains(i,ASGoal))

attack_state authentication_on_server_rc_n2 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,server_rc_n2,MGoal,SID) &
 not(witness(A2Goal,A1Goal,server_rc_n2,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_server_rc_n2 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,server_rc_n2,MGoal,SID1).
 request(A1Goal,A2Goal,server_rc_n2,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_user_server_n1 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,user_server_n1,MGoal,SID) &
 not(witness(A2Goal,A1Goal,user_server_n1,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_user_server_n1 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,user_server_n1,MGoal,SID1).
 request(A1Goal,A2Goal,user_server_n1,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_user_rc_n1 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,user_rc_n1,MGoal,SID) &
 not(witness(A2Goal,A1Goal,user_rc_n1,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_user_rc_n1 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,user_rc_n1,MGoal,SID1).
 request(A1Goal,A2Goal,user_rc_n1,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

