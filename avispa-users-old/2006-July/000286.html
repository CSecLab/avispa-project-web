<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Avispa-users] How to verify encrypted hashes - signatures
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:avispa-users%40avispa-project.org?Subject=%5BAvispa-users%5D%20How%20to%20verify%20encrypted%20hashes%20-%20signatures&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000285.html">
   <LINK REL="Next"  HREF="000288.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avispa-users] How to verify encrypted hashes - signatures</H1>
    <B>Laurent Vigneron</B> 
    <A HREF="mailto:avispa-users%40avispa-project.org?Subject=%5BAvispa-users%5D%20How%20to%20verify%20encrypted%20hashes%20-%20signatures&In-Reply-To="
       TITLE="[Avispa-users] How to verify encrypted hashes - signatures">Laurent.Vigneron at loria.fr
       </A><BR>
    <I>Tue Jul  4 10:12:14 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000285.html">[Avispa-users] How to verify encrypted hashes - signatures
</A></li>
        <LI>Next message: <A HREF="000288.html">Subject: [Avispa-users] HLPSL Question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#286">[ date ]</a>
              <a href="thread.html#286">[ thread ]</a>
              <a href="subject.html#286">[ subject ]</a>
              <a href="author.html#286">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Johnny,

In your example you consider that {{X}_inv(K)}_K is equal to X.
Some people do not agree with this property, simply because in the
real world signing, encrypting and decrypting messages are done by
different algorithms.
This is why in HLPSL specificiations, we recommend to write
		      Sig' = {Hash(A.C)}_inv(Ka)
instead of
			{Sig'}_Ka = Hash(A.C)

The semantical difference is that with the first notation, you explain
that you are able to recognize that Sig' is a message signed by
inv(Ka), and as you know Ka you are able to recover Hash(A.C).  This
equation is in fact a shortcut for:
		Sig' = {H'}_inv(Ka) /\ H' = Hash(A.C)
With the notation that you have used, this is not clear if you encrypt
or decrypt Sig'.

So, all this may again look as a philosophical statement, but we have
chosen to consider the non-ambigous notation in AVISPA.

Best regards,
Laurent.


 &gt; I just need some clarification on this issue. Ka is a public key,
 &gt; which means that I should write something similar to this to first
 &gt; decrypt the encrypted Sig hash and then compare it to the new hash:
 &gt; 
 &gt; {Sig'}_Ka = Hash(A.C)
 &gt; 
 &gt; When running this, I get the following error:
 &gt; 
 &gt; ofmc: Positive equality in condition.
 &gt; 
 &gt; I assume that you thought that I used a symmetric key as Ka, but I
 &gt; failed to mention that this is in fact a public key. How can I make
 &gt; this comparison to verify that A and C are in fact the correct agents
 &gt; as signed by A?
 &gt; 
 &gt; Regards,
 &gt; Johnny
 &gt; 
 &gt; On 6/29/06, Laurent Vigneron &lt;<A HREF="http://www.avispa-project.org/mailman/listinfo/avispa-users">Laurent.Vigneron at loria.fr</A>&gt; wrote:
 &gt; &gt;
 &gt; &gt; Hi Johnny,
 &gt; &gt;
 &gt; &gt; According to the semantics of the language, you simply have to write:
 &gt; &gt;
 &gt; &gt;         3. State = 10 /\ BC(A.C.Sig') /\ Sig' = {{A.C}_Hash}_inv(Ka) =|&gt;
 &gt; &gt;            State':=11
 &gt; &gt;
 &gt; &gt; This is correct if C knows both Ka and Hash.
 &gt; &gt;
 &gt; &gt; By the way, why didn't you use a hash function Hash(A.C) instead of en
 &gt; &gt; encryption?
 &gt; &gt;
 &gt; &gt; Laurent.
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000285.html">[Avispa-users] How to verify encrypted hashes - signatures
</A></li>
	<LI>Next message: <A HREF="000288.html">Subject: [Avispa-users] HLPSL Question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#286">[ date ]</a>
              <a href="thread.html#286">[ thread ]</a>
              <a href="subject.html#286">[ subject ]</a>
              <a href="author.html#286">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.avispa-project.org/mailman/listinfo/avispa-users">More information about the Avispa-users
mailing list</a><br>
</body></html>
