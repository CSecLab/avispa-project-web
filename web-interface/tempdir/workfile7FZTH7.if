%% IF specification of /home/avispa/web-interface-computation/./tempdir/workfile7FZTH7

section signature:

state_bob: agent * agent * agent * symmetric_key * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * set(text) * set(text) * set(symmetric_key) * set(agent) * set(symmetric_key) * set(agent) * set(text) * set(agent) * nat -> fact
state_bs: agent * agent * agent * symmetric_key * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * set(text) * set(text) * set(symmetric_key) * set(agent) * set(symmetric_key) * set(agent) * set(text) * set(agent) * nat -> fact
state_alice: agent * agent * agent * symmetric_key * symmetric_key * hash_func * nat * text * text * text * text * text * text * text * text * text * text * set(text) * set(text) * set(symmetric_key) * set(agent) * set(symmetric_key) * set(agent) * set(text) * set(agent) * nat -> fact


section types:

Dummy_Set_100, Dummy_Set_98, Dummy_Set_96, Dummy_Set_72, Dummy_Set_70, Dummy_Set_68, Dummy_Set_42, Dummy_Set_40, Dummy_Set_38, ASGoal, Set_100, Set_98, Set_96, Set_72, Set_70, Set_68, Set_42, Set_40, Set_38: set(agent)
Dummy_Set_97, Dummy_Set_95, Dummy_Set_69, Dummy_Set_67, Dummy_Set_39, Dummy_Set_37, Set_97, Set_95, Set_69, Set_67, Set_39, Set_37: set(symmetric_key)
Dummy_Set_99, Dummy_Set_94, Dummy_Set_93, Dummy_Set_71, Dummy_Set_66, Dummy_Set_65, Dummy_Set_41, Dummy_Set_36, Dummy_Set_34, Set_99, Set_94, Set_93, Set_71, Set_66, Set_65, Set_41, Set_36, Set_34: set(text)
MGoal, start: message
alice_server, server_bob, subs1, subs2, subs3, subs4, subs5: protocol_id
Dummy_T2, Dummy_T1, Dummy_RPWi, dummy_nonce, ack, pwi, xs, xa, yy, t1, t2, idi, idchj, PWi, Xs, Xa, Yy, ACK, T1, T2, IDi, IDchj, RPWi: text
h, H: hash_func
skubs, mkchj, SKubs, MKchj: symmetric_key
A2Goal, A1Goal, ui, chj, Ui, CHj, BS, bs, i: agent
set_202, set_201, set_200, set_199, set_198, set_197, set_196, set_195, set_184, set_183, set_182, set_181, set_180, set_179, set_178, set_177, set_165, set_164, set_163, set_162, set_161, set_160, set_159, set_158, set_143, set_142, set_141, set_140, set_139, set_138, set_137, set_136, set_247, set_246, set_245, set_244, set_243, set_242, set_241, set_240, set_238, set_237, set_236, set_235, set_234, set_233, set_232, set_231, set_229, set_228, set_227, set_226, set_225, set_224, set_223, set_222, set_220, set_219, set_218, set_217, set_216, set_215, set_214, set_213, set_211, set_210, set_209, set_208, set_207, set_206, set_205, set_204: set
5, SID, 4, Dummy_State, 3, SID2, SID1, State, 13, 2, 12, 1, 0, 11, 9, 8, 7: nat


section inits:

initial_state init1 := 
 iknows(start).
 iknows(ui).
 iknows(chj).
 iknows(bs).
 iknows(idi).
 iknows(idchj).
 iknows(h).
 iknows(i).
 state_alice(ui,chj,bs,mkchj,skubs,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_136,set_137,set_138,set_139,set_140,set_141,set_142,set_143,3).
 state_bs(bs,ui,chj,mkchj,skubs,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_158,set_159,set_160,set_161,set_162,set_163,set_164,set_165,4).
 state_bob(chj,ui,bs,mkchj,skubs,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_177,set_178,set_179,set_180,set_181,set_182,set_183,set_184,5).
 state_alice(ui,chj,bs,mkchj,skubs,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_195,set_196,set_197,set_198,set_199,set_200,set_201,set_202,7).
 state_bs(bs,ui,chj,mkchj,skubs,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_204,set_205,set_206,set_207,set_208,set_209,set_210,set_211,8).
 state_bob(chj,ui,bs,mkchj,skubs,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_213,set_214,set_215,set_216,set_217,set_218,set_219,set_220,9).
 state_alice(ui,chj,bs,mkchj,skubs,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_222,set_223,set_224,set_225,set_226,set_227,set_228,set_229,11).
 state_bs(bs,ui,chj,mkchj,skubs,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_231,set_232,set_233,set_234,set_235,set_236,set_237,set_238,12).
 state_bob(chj,ui,bs,mkchj,skubs,h,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_240,set_241,set_242,set_243,set_244,set_245,set_246,set_247,13)


section rules:

step step_0 (Ui,CHj,BS,MKchj,SKubs,H,Dummy_RPWi,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Dummy_Set_34,Dummy_Set_36,Dummy_Set_37,Dummy_Set_38,Dummy_Set_39,Dummy_Set_40,Dummy_Set_41,Dummy_Set_42,SID) :=
 state_alice(Ui,CHj,BS,MKchj,SKubs,H,0,Dummy_RPWi,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Dummy_Set_34,Dummy_Set_36,Dummy_Set_37,Dummy_Set_38,Dummy_Set_39,Dummy_Set_40,Dummy_Set_41,Dummy_Set_42,SID).
 iknows(start)
 =>
 state_alice(Ui,CHj,BS,MKchj,SKubs,H,1,apply(H,pair(Yy,PWi)),PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Dummy_Set_34,Dummy_Set_36,Dummy_Set_37,Dummy_Set_38,Dummy_Set_39,Dummy_Set_40,Dummy_Set_41,Dummy_Set_42,SID).
 iknows(pair(Ui,pair(BS,scrypt(SKubs,pair(IDi,apply(H,pair(Yy,PWi))))))).
 secret(Dummy_Set_34,subs1,BS).
 secret(Dummy_Set_36,subs2,Ui).
 secret(Dummy_Set_37,subs3,Dummy_Set_38).
 secret(Dummy_Set_39,subs4,Dummy_Set_40).
 secret(Dummy_Set_41,subs5,Dummy_Set_42).
 contains(Xs,Dummy_Set_34).
 contains(PWi,Dummy_Set_36).
 contains(MKchj,Dummy_Set_37).
 contains(BS,Dummy_Set_38).
 contains(CHj,Dummy_Set_38).
 contains(SKubs,Dummy_Set_39).
 contains(Ui,Dummy_Set_40).
 contains(BS,Dummy_Set_40).
 contains(Xa,Dummy_Set_41).
 contains(Yy,Dummy_Set_41).
 contains(Ui,Dummy_Set_42).
 contains(BS,Dummy_Set_42)

step step_1 (Ui,CHj,BS,MKchj,SKubs,H,RPWi,PWi,Xs,Xa,Yy,ACK,Dummy_T1,T2,IDi,IDchj,Set_34,Set_36,Set_37,Set_38,Set_39,Set_40,Set_41,Set_42,SID,T1) :=
 state_alice(Ui,CHj,BS,MKchj,SKubs,H,1,RPWi,PWi,Xs,Xa,Yy,ACK,Dummy_T1,T2,IDi,IDchj,Set_34,Set_36,Set_37,Set_38,Set_39,Set_40,Set_41,Set_42,SID).
 iknows(pair(BS,pair(Ui,scrypt(SKubs,pair(IDi,pair(Yy,pair(Xa,pair(apply(H,pair(Yy,apply(H,pair(apply(H,pair(Yy,PWi)),Xa)))),pair(xor(apply(H,pair(IDi,Xs)),apply(H,pair(apply(H,pair(Yy,PWi)),Xa))),pair(H,pair(scrypt(MKchj,pair(IDi,pair(IDchj,Xs))),IDchj)))))))))))
=[exists T1]=>
 state_alice(Ui,CHj,BS,MKchj,SKubs,H,2,RPWi,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Set_34,Set_36,Set_37,Set_38,Set_39,Set_40,Set_41,Set_42,SID).
 iknows(pair(Ui,pair(BS,pair(IDi,pair(IDchj,scrypt(scrypt(MKchj,pair(IDi,pair(IDchj,Xs))),pair(IDi,pair(IDchj,pair(apply(H,pair(apply(H,pair(apply(H,pair(Yy,PWi)),Xa)),T1)),pair(xor(apply(H,pair(IDi,Xs)),apply(H,pair(apply(H,pair(Yy,PWi)),Xa))),T1)))))))))).
 witness(Ui,BS,alice_server,T1)

step step_2 (Ui,CHj,BS,MKchj,SKubs,H,RPWi,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Set_34,Set_36,Set_37,Set_38,Set_39,Set_40,Set_41,Set_42,SID) :=
 state_alice(Ui,CHj,BS,MKchj,SKubs,H,2,RPWi,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Set_34,Set_36,Set_37,Set_38,Set_39,Set_40,Set_41,Set_42,SID).
 iknows(pair(BS,pair(Ui,ACK)))
 =>
 state_alice(Ui,CHj,BS,MKchj,SKubs,H,3,RPWi,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Set_34,Set_36,Set_37,Set_38,Set_39,Set_40,Set_41,Set_42,SID)

step step_3 (BS,Ui,CHj,MKchj,SKubs,H,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Dummy_Set_65,Dummy_Set_66,Dummy_Set_67,Dummy_Set_68,Dummy_Set_69,Dummy_Set_70,Dummy_Set_71,Dummy_Set_72,SID) :=
 state_bs(BS,Ui,CHj,MKchj,SKubs,H,0,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Dummy_Set_65,Dummy_Set_66,Dummy_Set_67,Dummy_Set_68,Dummy_Set_69,Dummy_Set_70,Dummy_Set_71,Dummy_Set_72,SID).
 iknows(pair(Ui,pair(BS,scrypt(SKubs,pair(IDi,apply(H,pair(Yy,PWi)))))))
 =>
 state_bs(BS,Ui,CHj,MKchj,SKubs,H,1,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Dummy_Set_65,Dummy_Set_66,Dummy_Set_67,Dummy_Set_68,Dummy_Set_69,Dummy_Set_70,Dummy_Set_71,Dummy_Set_72,SID).
 secret(Dummy_Set_65,subs1,BS).
 secret(Dummy_Set_66,subs2,Ui).
 secret(Dummy_Set_67,subs3,Dummy_Set_68).
 secret(Dummy_Set_69,subs4,Dummy_Set_70).
 secret(Dummy_Set_71,subs5,Dummy_Set_72).
 iknows(pair(BS,pair(Ui,scrypt(SKubs,pair(IDi,pair(Yy,pair(Xa,pair(apply(H,pair(Yy,apply(H,pair(apply(H,pair(Yy,PWi)),Xa)))),pair(xor(apply(H,pair(IDi,Xs)),apply(H,pair(apply(H,pair(Yy,PWi)),Xa))),pair(H,pair(scrypt(MKchj,pair(IDi,pair(IDchj,Xs))),IDchj))))))))))).
 contains(Xs,Dummy_Set_65).
 contains(PWi,Dummy_Set_66).
 contains(MKchj,Dummy_Set_67).
 contains(BS,Dummy_Set_68).
 contains(CHj,Dummy_Set_68).
 contains(SKubs,Dummy_Set_69).
 contains(Ui,Dummy_Set_70).
 contains(BS,Dummy_Set_70).
 contains(Xa,Dummy_Set_71).
 contains(Yy,Dummy_Set_71).
 contains(Ui,Dummy_Set_72).
 contains(BS,Dummy_Set_72)

step step_4 (BS,Ui,CHj,MKchj,SKubs,H,PWi,Xs,Xa,Yy,ACK,Dummy_T1,Dummy_T2,IDi,IDchj,Set_65,Set_66,Set_67,Set_68,Set_69,Set_70,Set_71,Set_72,SID,T1,T2) :=
 state_bs(BS,Ui,CHj,MKchj,SKubs,H,1,PWi,Xs,Xa,Yy,ACK,Dummy_T1,Dummy_T2,IDi,IDchj,Set_65,Set_66,Set_67,Set_68,Set_69,Set_70,Set_71,Set_72,SID).
 iknows(pair(Ui,pair(BS,pair(IDi,pair(IDchj,scrypt(scrypt(MKchj,pair(IDi,pair(IDchj,Xs))),pair(IDi,pair(IDchj,pair(apply(H,pair(apply(H,pair(apply(H,pair(Yy,PWi)),Xa)),T1)),pair(xor(apply(H,pair(IDi,Xs)),apply(H,pair(apply(H,pair(Yy,PWi)),Xa))),T1))))))))))
=[exists T2]=>
 state_bs(BS,Ui,CHj,MKchj,SKubs,H,2,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Set_65,Set_66,Set_67,Set_68,Set_69,Set_70,Set_71,Set_72,SID).
 iknows(pair(BS,pair(CHj,pair(IDi,pair(IDchj,scrypt(MKchj,pair(IDi,pair(IDchj,pair(apply(H,pair(xor(xor(apply(H,pair(IDi,Xs)),apply(H,pair(apply(H,pair(Yy,PWi)),Xa))),apply(H,pair(IDi,Xs))),T2)),pair(Dummy_T1,pair(T2,pair(apply(H,pair(IDi,Xs)),xor(apply(H,pair(IDi,Xs)),apply(H,pair(apply(H,pair(Yy,PWi)),Xa))))))))))))))).
 witness(BS,CHj,server_bob,T2)

step step_5 (BS,Ui,CHj,MKchj,SKubs,H,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Set_65,Set_66,Set_67,Set_68,Set_69,Set_70,Set_71,Set_72,SID) :=
 state_bs(BS,Ui,CHj,MKchj,SKubs,H,2,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Set_65,Set_66,Set_67,Set_68,Set_69,Set_70,Set_71,Set_72,SID).
 iknows(pair(CHj,pair(BS,ACK)))
 =>
 state_bs(BS,Ui,CHj,MKchj,SKubs,H,3,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Set_65,Set_66,Set_67,Set_68,Set_69,Set_70,Set_71,Set_72,SID).
 iknows(pair(BS,pair(Ui,ACK))).
 request(Ui,BS,alice_server,T1,SID)

step step_6 (CHj,Ui,BS,MKchj,SKubs,H,PWi,Xs,Xa,Yy,ACK,Dummy_T1,Dummy_T2,IDi,IDchj,Dummy_Set_93,Dummy_Set_94,Dummy_Set_95,Dummy_Set_96,Dummy_Set_97,Dummy_Set_98,Dummy_Set_99,Dummy_Set_100,SID,T1,T2) :=
 state_bob(CHj,Ui,BS,MKchj,SKubs,H,0,PWi,Xs,Xa,Yy,ACK,Dummy_T1,Dummy_T2,IDi,IDchj,Dummy_Set_93,Dummy_Set_94,Dummy_Set_95,Dummy_Set_96,Dummy_Set_97,Dummy_Set_98,Dummy_Set_99,Dummy_Set_100,SID).
 iknows(pair(BS,pair(CHj,pair(IDi,pair(IDchj,scrypt(MKchj,pair(IDi,pair(IDchj,pair(apply(H,pair(xor(xor(apply(H,pair(IDi,Xs)),apply(H,pair(apply(H,pair(Yy,PWi)),Xa))),apply(H,pair(IDi,Xs))),T2)),pair(T1,pair(T2,pair(apply(H,pair(IDi,Xs)),xor(apply(H,pair(IDi,Xs)),apply(H,pair(apply(H,pair(Yy,PWi)),Xa)))))))))))))))
 =>
 state_bob(CHj,Ui,BS,MKchj,SKubs,H,1,PWi,Xs,Xa,Yy,ACK,T1,T2,IDi,IDchj,Dummy_Set_93,Dummy_Set_94,Dummy_Set_95,Dummy_Set_96,Dummy_Set_97,Dummy_Set_98,Dummy_Set_99,Dummy_Set_100,SID).
 secret(Dummy_Set_93,subs1,BS).
 secret(Dummy_Set_94,subs2,Ui).
 secret(Dummy_Set_95,subs3,Dummy_Set_96).
 secret(Dummy_Set_97,subs4,Dummy_Set_98).
 secret(Dummy_Set_99,subs5,Dummy_Set_100).
 iknows(pair(CHj,pair(BS,ACK))).
 request(BS,CHj,server_bob,T2,SID).
 contains(Xs,Dummy_Set_93).
 contains(PWi,Dummy_Set_94).
 contains(MKchj,Dummy_Set_95).
 contains(BS,Dummy_Set_96).
 contains(CHj,Dummy_Set_96).
 contains(SKubs,Dummy_Set_97).
 contains(Ui,Dummy_Set_98).
 contains(BS,Dummy_Set_98).
 contains(Xa,Dummy_Set_99).
 contains(Yy,Dummy_Set_99).
 contains(Ui,Dummy_Set_100).
 contains(BS,Dummy_Set_100)


section properties:

property secrecy_of_subs1 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs1,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs2 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs2,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs3 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs3,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs4 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs4,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_subs5 (MGoal,ASGoal) :=
 [] ((secret(MGoal,subs5,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property authentication_on_alice_server (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,alice_server,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,alice_server,MGoal))
     /\ ((request(A1Goal,A2Goal,alice_server,MGoal,SID1)
           /\ request(A1Goal,A2Goal,alice_server,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_server_bob (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,server_bob,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,server_bob,MGoal))
     /\ ((request(A1Goal,A2Goal,server_bob,MGoal,SID1)
           /\ request(A1Goal,A2Goal,server_bob,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))


section attack_states:

attack_state secrecy_of_subs1 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs1,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs2 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs2,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs3 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs3,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs4 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs4,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_subs5 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,subs5,ASGoal) &
 not(contains(i,ASGoal))

attack_state authentication_on_alice_server (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,alice_server,MGoal,SID) &
 not(witness(A2Goal,A1Goal,alice_server,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_alice_server (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,alice_server,MGoal,SID1).
 request(A1Goal,A2Goal,alice_server,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_server_bob (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,server_bob,MGoal,SID) &
 not(witness(A2Goal,A1Goal,server_bob,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_server_bob (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,server_bob,MGoal,SID1).
 request(A1Goal,A2Goal,server_bob,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

