%% IF specification of /home/avispa/web-interface-computation/./tempdir/workfilepjn8aJBWyS

section signature:

state_sensor: agent * agent * agent * hash_func * symmetric_key * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * nat -> fact
state_bob: agent * agent * agent * hash_func * symmetric_key * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * set(text) * set(agent) * nat -> fact
state_alice: agent * agent * agent * hash_func * symmetric_key * nat * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * text * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * set(text) * set(agent) * nat -> fact


section types:

MGoal, start: message
bob_alice, alice_bob, bob_sensor, sensor_bob, scrt0, scrt1, scrt2, scrt3, scrt4, scrt5: protocol_id
set_192, set_191, set_190, set_189, set_188, set_187, set_186, set_185, set_263, set_262, set_260, set_259, set_258, set_257, set_256, set_255, set_254, set_253, set_250, set_249, set_247, set_246, set_245, set_244, set_243, set_242, set_241, set_240, set_226, set_225: set
Dummy_State, 3, SID, SID2, SID1, State, 13, 12, 11, 2, 9, 1, 8, 0, 7, 5, 4: nat
Dummy_Set_54, Dummy_Set_51, ASGoal, Set_102, Set_61, Set_57, Set_54, Set_51, Dummy_Set_102, Dummy_Set_61, Dummy_Set_57: set(agent)
Dummy_Set_53, Dummy_Set_50, Set_101, Set_60, Set_56, Set_53, Set_50, Dummy_Set_101, Dummy_Set_60, Dummy_Set_56: set(text)
skj, SKj: symmetric_key
h, H: hash_func
A2Goal, A1Goal, ui, gw, snj, Ui, GW, SNj, i: agent
Dummy_Ri, Dummy_HPWi, dummy_nonce, idi, pwi, regi, hpwi, ai, bi, ci, k, ri, r1, r2, r3, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, skgsn, idsnj, tidi, tidii, di, sk, IDi, R1, R2, R3, K, IDSNj, SK, SKGSN, M3, M4, M5, M6, M7, M8, PWi, HPWi, Ri, Regi, Ci, Di, T1, Ai, Bi, CIDi, M1, M2, TIDi, TIDii, M9, M10, M11, Dummy_M6, Dummy_M7, Dummy_M5, Dummy_M4, Dummy_M3, Dummy_SKGSN, Dummy_Di, Dummy_SK, Dummy_M11, Dummy_M10, Dummy_M9, Dummy_TIDii, Dummy_M8, Dummy_R3, Dummy_R2, Dummy_TIDi, Dummy_M2, Dummy_M1, Dummy_CIDi, Dummy_Bi, Dummy_Ai, Dummy_T1, Dummy_Ci, Dummy_Regi, Dummy_R1: text


section inits:

initial_state init1 := 
 iknows(start).
 iknows(ui).
 iknows(gw).
 iknows(snj).
 iknows(h).
 iknows(regi).
 iknows(ci).
 iknows(ai).
 iknows(tidi).
 iknows(m3).
 iknows(m4).
 iknows(m5).
 iknows(m7).
 iknows(m8).
 iknows(m9).
 iknows(m10).
 iknows(m11).
 iknows(i).
 state_alice(ui,gw,snj,h,skj,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_185,set_186,set_187,set_188,set_189,set_190,set_191,set_192,3).
 state_bob(gw,ui,snj,h,skj,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_225,set_226,4).
 state_sensor(snj,ui,gw,h,skj,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,5).
 state_alice(ui,gw,snj,h,skj,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_240,set_241,set_242,set_243,set_244,set_245,set_246,set_247,7).
 state_bob(gw,ui,snj,h,skj,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_249,set_250,8).
 state_sensor(snj,ui,gw,h,skj,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,9).
 state_alice(ui,gw,snj,h,skj,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_253,set_254,set_255,set_256,set_257,set_258,set_259,set_260,11).
 state_bob(gw,ui,snj,h,skj,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,set_262,set_263,12).
 state_sensor(snj,ui,gw,h,skj,0,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,dummy_nonce,13)


section rules:

step step_0 (Ui,GW,SNj,H,SKj,IDi,PWi,Dummy_HPWi,Ri,R1,R2,R3,Regi,Ci,K,T1,Ai,Bi,CIDi,M1,M2,M8,IDSNj,TIDi,TIDii,M9,M10,M11,SK,Dummy_Set_50,Dummy_Set_51,Dummy_Set_53,Dummy_Set_54,Set_56,Set_57,Set_60,Set_61,SID) :=
 state_alice(Ui,GW,SNj,H,SKj,0,IDi,PWi,Dummy_HPWi,Ri,R1,R2,R3,Regi,Ci,K,T1,Ai,Bi,CIDi,M1,M2,M8,IDSNj,TIDi,TIDii,M9,M10,M11,SK,Dummy_Set_50,Dummy_Set_51,Dummy_Set_53,Dummy_Set_54,Set_56,Set_57,Set_60,Set_61,SID).
 iknows(start)
 =>
 state_alice(Ui,GW,SNj,H,SKj,1,IDi,PWi,apply(H,xor(IDi,PWi)),Ri,R1,R2,R3,Regi,Ci,K,T1,Ai,Bi,CIDi,M1,M2,M8,IDSNj,TIDi,TIDii,M9,M10,M11,SK,Dummy_Set_50,Dummy_Set_51,Dummy_Set_53,Dummy_Set_54,Set_56,Set_57,Set_60,Set_61,SID).
 secret(Dummy_Set_50,scrt0,Dummy_Set_51).
 secret(Dummy_Set_53,scrt1,Dummy_Set_54).
 iknows(scrypt(SKj,pair(IDi,apply(H,xor(IDi,PWi))))).
 contains(PWi,Dummy_Set_50).
 contains(Ui,Dummy_Set_51).
 contains(IDi,Dummy_Set_53).
 contains(Ui,Dummy_Set_54).
 contains(GW,Dummy_Set_54)

step step_1 (Ui,GW,SNj,H,SKj,IDi,PWi,HPWi,Dummy_Ri,Dummy_R1,R2,R3,Dummy_Regi,Dummy_Ci,K,Dummy_T1,Dummy_Ai,Dummy_Bi,Dummy_CIDi,Dummy_M1,Dummy_M2,M8,IDSNj,Dummy_TIDi,TIDii,M9,M10,M11,SK,Set_50,Set_51,Set_53,Set_54,Dummy_Set_56,Dummy_Set_57,Set_60,Set_61,SID,R1,T1,TIDi) :=
 state_alice(Ui,GW,SNj,H,SKj,1,IDi,PWi,HPWi,Dummy_Ri,Dummy_R1,R2,R3,Dummy_Regi,Dummy_Ci,K,Dummy_T1,Dummy_Ai,Dummy_Bi,Dummy_CIDi,Dummy_M1,Dummy_M2,M8,IDSNj,Dummy_TIDi,TIDii,M9,M10,M11,SK,Set_50,Set_51,Set_53,Set_54,Dummy_Set_56,Dummy_Set_57,Set_60,Set_61,SID).
 iknows(TIDi)
=[exists T1,R1]=>
 state_alice(Ui,GW,SNj,H,SKj,2,IDi,PWi,HPWi,xor(Dummy_Ai,HPWi),R1,R2,R3,Dummy_Regi,Dummy_Ci,K,T1,Dummy_Ai,xor(Dummy_Ci,apply(H,xor(IDi,xor(Dummy_Ai,HPWi),HPWi))),xor(IDi,apply(H,pair(Dummy_TIDi,pair(xor(Dummy_Ai,HPWi),T1)))),apply(H,pair(IDi,pair(xor(Dummy_Ci,apply(H,xor(IDi,xor(Dummy_Ai,HPWi),HPWi))),pair(R1,T1)))),xor(apply(H,pair(xor(Dummy_Ai,HPWi),T1)),R1),M8,IDSNj,TIDi,TIDii,M9,M10,M11,SK,Set_50,Set_51,Set_53,Set_54,Dummy_Set_56,Dummy_Set_57,Set_60,Set_61,SID).
 iknows(Dummy_TIDi).
 secret(Dummy_Set_56,scrt3,Dummy_Set_57).
 contains(R1,Dummy_Set_56).
 contains(Dummy_Ri,Dummy_Set_56).
 contains(Ui,Dummy_Set_57).
 contains(GW,Dummy_Set_57)

step step_2 (Ui,GW,SNj,H,SKj,IDi,PWi,HPWi,Ri,R1,Dummy_R2,Dummy_R3,Regi,Ci,K,T1,Ai,Bi,CIDi,M1,M2,Dummy_M8,IDSNj,TIDi,Dummy_TIDii,Dummy_M9,Dummy_M10,Dummy_M11,Dummy_SK,Set_50,Set_51,Set_53,Set_54,Set_56,Set_57,Dummy_Set_60,Dummy_Set_61,SID,M8) :=
 state_alice(Ui,GW,SNj,H,SKj,2,IDi,PWi,HPWi,Ri,R1,Dummy_R2,Dummy_R3,Regi,Ci,K,T1,Ai,Bi,CIDi,M1,M2,Dummy_M8,IDSNj,TIDi,Dummy_TIDii,Dummy_M9,Dummy_M10,Dummy_M11,Dummy_SK,Set_50,Set_51,Set_53,Set_54,Set_56,Set_57,Dummy_Set_60,Dummy_Set_61,SID).
 iknows(M8)
 =>
 state_alice(Ui,GW,SNj,H,SKj,3,IDi,PWi,HPWi,Ri,R1,xor(Dummy_M9,apply(H,pair(IDi,R1))),xor(Dummy_M8,apply(H,xor(Dummy_M9,apply(H,pair(IDi,R1))))),Regi,Ci,K,T1,Ai,Bi,CIDi,M1,M2,M8,IDSNj,TIDi,xor(Dummy_M11,apply(H,xor(pair(xor(Dummy_M9,apply(H,pair(IDi,R1))),xor(Dummy_M8,apply(H,xor(Dummy_M9,apply(H,pair(IDi,R1))))))))),Dummy_M9,Dummy_M10,Dummy_M11,apply(H,pair(apply(H,pair(IDi,pair(R1,xor(Dummy_M9,apply(H,pair(IDi,R1)))))),pair(xor(Dummy_M9,apply(H,pair(IDi,R1))),xor(Dummy_M8,apply(H,xor(Dummy_M9,apply(H,pair(IDi,R1)))))))),Set_50,Set_51,Set_53,Set_54,Set_56,Set_57,Dummy_Set_60,Dummy_Set_61,SID).
 secret(Dummy_Set_60,scrt4,Dummy_Set_61).
 contains(apply(H,pair(apply(H,pair(IDi,pair(R1,xor(Dummy_M9,apply(H,pair(IDi,R1)))))),pair(xor(Dummy_M9,apply(H,pair(IDi,R1))),xor(Dummy_M8,apply(H,xor(Dummy_M9,apply(H,pair(IDi,R1)))))))),Dummy_Set_60).
 contains(Ui,Dummy_Set_61).
 contains(GW,Dummy_Set_61).
 contains(SNj,Dummy_Set_61)

step step_3 (GW,Ui,SNj,H,SKj,IDi,PWi,Dummy_HPWi,Dummy_Ri,R1,R2,R3,Dummy_Regi,Dummy_Ci,K,Dummy_Di,T1,Dummy_Ai,Dummy_Bi,CIDi,M1,M2,IDSNj,Dummy_TIDi,TIDii,M9,M10,M11,SK,SKGSN,M3,M4,M5,M7,M8,Set_101,Set_102,SID,HPWi,Ri,TIDi) :=
 state_bob(GW,Ui,SNj,H,SKj,0,IDi,PWi,Dummy_HPWi,Dummy_Ri,R1,R2,R3,Dummy_Regi,Dummy_Ci,K,Dummy_Di,T1,Dummy_Ai,Dummy_Bi,CIDi,M1,M2,IDSNj,Dummy_TIDi,TIDii,M9,M10,M11,SK,SKGSN,M3,M4,M5,M7,M8,Set_101,Set_102,SID).
 iknows(scrypt(SKj,pair(IDi,HPWi)))
=[exists TIDi,Ri]=>
 state_bob(GW,Ui,SNj,H,SKj,1,IDi,PWi,HPWi,Ri,R1,R2,R3,apply(H,pair(IDi,pair(Ri,Dummy_HPWi))),xor(apply(H,pair(IDi,pair(Ri,K))),apply(H,xor(IDi,Ri,Dummy_HPWi))),K,xor(Ri,apply(H,pair(TIDi,K))),T1,xor(Ri,Dummy_HPWi),apply(H,pair(IDi,pair(Ri,K))),CIDi,M1,M2,IDSNj,TIDi,TIDii,M9,M10,M11,SK,SKGSN,M3,M4,M5,M7,M8,Set_101,Set_102,SID).
 iknows(TIDi)

step step_4 (GW,Ui,SNj,H,SKj,IDi,PWi,HPWi,Dummy_Ri,Dummy_R1,Dummy_R2,R3,Regi,Ci,K,Di,Dummy_T1,Ai,Bi,Dummy_CIDi,Dummy_M1,Dummy_M2,IDSNj,TIDi,TIDii,M9,M10,M11,SK,Dummy_SKGSN,Dummy_M3,Dummy_M4,Dummy_M5,M7,M8,Dummy_Set_101,Dummy_Set_102,SID,R2) :=
 state_bob(GW,Ui,SNj,H,SKj,1,IDi,PWi,HPWi,Dummy_Ri,Dummy_R1,Dummy_R2,R3,Regi,Ci,K,Di,Dummy_T1,Ai,Bi,Dummy_CIDi,Dummy_M1,Dummy_M2,IDSNj,TIDi,TIDii,M9,M10,M11,SK,Dummy_SKGSN,Dummy_M3,Dummy_M4,Dummy_M5,M7,M8,Dummy_Set_101,Dummy_Set_102,SID).
 iknows(TIDi)
=[exists R2]=>
 state_bob(GW,Ui,SNj,H,SKj,2,IDi,PWi,HPWi,xor(Di,apply(H,pair(TIDi,K))),xor(Dummy_M2,apply(H,pair(xor(Di,apply(H,pair(TIDi,K))),Dummy_T1))),R2,R3,Regi,Ci,K,Di,Dummy_T1,Ai,Bi,Dummy_CIDi,Dummy_M1,Dummy_M2,IDSNj,TIDi,TIDii,M9,M10,M11,SK,apply(H,pair(IDSNj,K)),apply(H,pair(apply(H,pair(apply(H,pair(IDi,pair(xor(Dummy_M2,apply(H,pair(xor(Di,apply(H,pair(TIDi,K))),Dummy_T1))),R2))),1)),pair(apply(H,pair(IDSNj,K)),R2))),xor(apply(H,pair(IDi,pair(xor(Dummy_M2,apply(H,pair(xor(Di,apply(H,pair(TIDi,K))),Dummy_T1))),R2))),Dummy_SKGSN),xor(R2,apply(H,Dummy_SKGSN)),M7,M8,Dummy_Set_101,Dummy_Set_102,SID).
 iknows(apply(H,pair(apply(H,pair(apply(H,pair(IDi,pair(xor(Dummy_M2,apply(H,pair(xor(Di,apply(H,pair(TIDi,K))),Dummy_T1))),R2))),1)),pair(apply(H,pair(IDSNj,K)),R2)))).
 contains(Dummy_SKGSN,Dummy_Set_101).
 contains(GW,Dummy_Set_102).
 contains(SNj,Dummy_Set_102)

step step_5 (GW,Ui,SNj,H,SKj,IDi,PWi,HPWi,Ri,R1,R2,Dummy_R3,Regi,Ci,K,Di,T1,Ai,Bi,CIDi,M1,M2,IDSNj,TIDi,Dummy_TIDii,Dummy_M9,Dummy_M10,Dummy_M11,Dummy_SK,SKGSN,M3,M4,M5,Dummy_M7,Dummy_M8,Set_101,Set_102,SID,TIDii,M7) :=
 state_bob(GW,Ui,SNj,H,SKj,2,IDi,PWi,HPWi,Ri,R1,R2,Dummy_R3,Regi,Ci,K,Di,T1,Ai,Bi,CIDi,M1,M2,IDSNj,TIDi,Dummy_TIDii,Dummy_M9,Dummy_M10,Dummy_M11,Dummy_SK,SKGSN,M3,M4,M5,Dummy_M7,Dummy_M8,Set_101,Set_102,SID).
 iknows(M7)
=[exists TIDii]=>
 state_bob(GW,Ui,SNj,H,SKj,3,IDi,PWi,HPWi,Ri,R1,R2,xor(Dummy_M8,apply(H,R2)),Regi,Ci,K,Di,T1,Ai,Bi,CIDi,M1,M2,IDSNj,TIDi,TIDii,xor(R2,apply(H,pair(IDi,R1))),apply(H,pair(IDi,pair(apply(H,pair(apply(H,pair(IDi,pair(R1,R2))),pair(R2,xor(Dummy_M8,apply(H,R2))))),xor(Dummy_M8,apply(H,R2))))),xor(TIDii,apply(H,xor(R2,xor(Dummy_M8,apply(H,R2))))),apply(H,pair(apply(H,pair(IDi,pair(R1,R2))),pair(R2,xor(Dummy_M8,apply(H,R2))))),SKGSN,M3,M4,M5,M7,Dummy_M8,Set_101,Set_102,SID).
 iknows(M8)

step step_6 (SNj,Ui,GW,H,SKj,IDi,R1,Dummy_R2,Dummy_R3,K,IDSNj,Dummy_SK,SKGSN,Dummy_M3,Dummy_M4,Dummy_M5,Dummy_M6,Dummy_M7,Dummy_M8,SID,R3,M3) :=
 state_sensor(SNj,Ui,GW,H,SKj,0,IDi,R1,Dummy_R2,Dummy_R3,K,IDSNj,Dummy_SK,SKGSN,Dummy_M3,Dummy_M4,Dummy_M5,Dummy_M6,Dummy_M7,Dummy_M8,SID).
 iknows(M3)
=[exists R3]=>
 state_sensor(SNj,Ui,GW,H,SKj,1,IDi,R1,xor(Dummy_M5,apply(H,SKGSN)),R3,K,IDSNj,apply(H,pair(xor(Dummy_M4,SKGSN),pair(xor(Dummy_M5,apply(H,SKGSN)),R3))),SKGSN,M3,Dummy_M4,Dummy_M5,xor(Dummy_M4,SKGSN),apply(H,pair(apply(H,pair(xor(Dummy_M4,SKGSN),pair(xor(Dummy_M5,apply(H,SKGSN)),R3))),pair(R3,SKGSN))),xor(apply(H,xor(Dummy_M5,apply(H,SKGSN))),Dummy_R3),SID).
 iknows(apply(H,pair(apply(H,pair(xor(Dummy_M4,SKGSN),pair(xor(Dummy_M5,apply(H,SKGSN)),R3))),pair(R3,SKGSN))))


section properties:

property secrecy_of_scrt0 (MGoal,ASGoal) :=
 [] ((secret(MGoal,scrt0,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_scrt1 (MGoal,ASGoal) :=
 [] ((secret(MGoal,scrt1,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_scrt2 (MGoal,ASGoal) :=
 [] ((secret(MGoal,scrt2,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_scrt3 (MGoal,ASGoal) :=
 [] ((secret(MGoal,scrt3,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_scrt4 (MGoal,ASGoal) :=
 [] ((secret(MGoal,scrt4,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property secrecy_of_sucrt5 (MGoal,ASGoal) :=
 [] ((secret(MGoal,sucrt5,ASGoal) /\ iknows(MGoal))
     => contains(i,ASGoal))

property authentication_on_alice_bob_R1 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,alice_bob_R1,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,alice_bob_R1,MGoal))
     /\ ((request(A1Goal,A2Goal,alice_bob_R1,MGoal,SID1)
           /\ request(A1Goal,A2Goal,alice_bob_R1,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_bob_sensor_R2 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,bob_sensor_R2,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,bob_sensor_R2,MGoal))
     /\ ((request(A1Goal,A2Goal,bob_sensor_R2,MGoal,SID1)
           /\ request(A1Goal,A2Goal,bob_sensor_R2,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))

property authentication_on_sensor_bob_R3 (A1Goal,A2Goal,MGoal,SID,SID1,SID2) :=
 [] (((request(A1Goal,A2Goal,sensor_bob_R3,MGoal,SID)
       /\ ~ equal(A2Goal,i))
      => witness(A2Goal,A1Goal,sensor_bob_R3,MGoal))
     /\ ((request(A1Goal,A2Goal,sensor_bob_R3,MGoal,SID1)
           /\ request(A1Goal,A2Goal,sensor_bob_R3,MGoal,SID2)
           /\ ~ equal(A2Goal,i))
          => equal(SID1,SID2)))


section attack_states:

attack_state secrecy_of_scrt0 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,scrt0,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_scrt1 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,scrt1,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_scrt2 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,scrt2,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_scrt3 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,scrt3,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_scrt4 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,scrt4,ASGoal) &
 not(contains(i,ASGoal))

attack_state secrecy_of_sucrt5 (MGoal,ASGoal) :=
 iknows(MGoal).
 secret(MGoal,sucrt5,ASGoal) &
 not(contains(i,ASGoal))

attack_state authentication_on_alice_bob_R1 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,alice_bob_R1,MGoal,SID) &
 not(witness(A2Goal,A1Goal,alice_bob_R1,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_alice_bob_R1 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,alice_bob_R1,MGoal,SID1).
 request(A1Goal,A2Goal,alice_bob_R1,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_bob_sensor_R2 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,bob_sensor_R2,MGoal,SID) &
 not(witness(A2Goal,A1Goal,bob_sensor_R2,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_bob_sensor_R2 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,bob_sensor_R2,MGoal,SID1).
 request(A1Goal,A2Goal,bob_sensor_R2,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

attack_state authentication_on_sensor_bob_R3 (A1Goal,A2Goal,MGoal,SID) :=
 request(A1Goal,A2Goal,sensor_bob_R3,MGoal,SID) &
 not(witness(A2Goal,A1Goal,sensor_bob_R3,MGoal)) &
 not(equal(A2Goal,i))
attack_state replay_protection_on_sensor_bob_R3 (A2Goal,A1Goal,MGoal,SID1,SID2) :=
 request(A1Goal,A2Goal,sensor_bob_R3,MGoal,SID1).
 request(A1Goal,A2Goal,sensor_bob_R3,MGoal,SID2) &
 not(equal(SID1,SID2)) &
 not(equal(A2Goal,i))

